<<<<<<< HEAD
{"version":3,"file":"mapboard.js","sources":["../src/util/is-mobile-device.js","../src/store.js","../src/util/config-mixin.js","../src/components/TopicPanel.vue","../src/components/markers-mixin.js","../src/components/MapPanel.vue","../src/components/Mapboard.vue","../src/util/merge-deep.js","../src/util/unique-id.js","../src/main.js"],"sourcesContent":["export default function () {\r\n  const mobileOrTabletRegexA = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i;\r\n  const mobileOrTabletRegexB = /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i;\r\n\r\n  // get the user agent and test against both regex patterns\r\n  const userAgent = (navigator.userAgent || navigator.vendor || window.opera || '');\r\n  const isMobileOrTablet = (mobileOrTabletRegexA.test(userAgent) ||\r\n                            mobileOrTabletRegexB.test(userAgent.substr(0,4)));\r\n\r\n  return isMobileOrTablet;\r\n};\r\n","import Vue from 'vue';\r\nimport Vuex from 'vuex';\r\nimport isMobileDevice from './util/is-mobile-device';\r\n\r\n// when you load vuex from a script tag this seems to happen automatically\r\nVue.use(Vuex);\r\n\r\n// this grabs horizontal table ids from an array of topic components,\r\n// recursively\r\nfunction getHorizontalTableIdsFromComps(comps = []) {\r\n  // console.log('getHorizontalTableIdsFromComps is running, comps:', comps);\r\n\r\n  let tableIds = [];\r\n\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.components || options.tables;\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (innerComps) {\r\n      const innerTableIds = getHorizontalTableIdsFromComps(innerComps);\r\n      tableIds = tableIds.concat(innerTableIds);\r\n      continue;\r\n    }\r\n\r\n    // skip comps that aren't horizontal tables\r\n    if (comp.type !== 'horizontal-table') {\r\n      continue;\r\n    }\r\n\r\n    const tableId = comp._id;\r\n\r\n    tableIds.push(tableId);\r\n  }\r\n\r\n  return tableIds;\r\n}\r\n\r\n// this makes the empty filtered data object given a list of topics.\r\nfunction createFilteredData(config) {\r\n  const topics = config.topics;\r\n  let tableIds = [];\r\n\r\n  for (let topic of topics) {\r\n    const comps = topic.components;\r\n    const compTableIds = getHorizontalTableIdsFromComps(comps);\r\n    tableIds = tableIds.concat(compTableIds);\r\n  }\r\n\r\n  // console.log('createFilteredData is running, tableIds:', tableIds);\r\n\r\n  // const filteredData = tableIds.reduce((acc, tableId) => {\r\n  //   acc[tableId] = [];\r\n  //   return acc;\r\n  // }, {});\r\n\r\n  let filteredData = {}\r\n  for (let index=0; index < tableIds.length; index++) {\r\n    filteredData[tableIds[index]] = [];\r\n  }\r\n\r\n  return filteredData;\r\n}\r\n\r\n// this grabs table group ids from an array of topic components\r\nfunction getHorizontalTableGroupIdsFromComps(comps = []) {\r\n  // console.log('getHorizontalTableGroupIdsFromComps is running, comps:', comps);\r\n  let tableGroupId;\r\n\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.components || options.tables;\r\n\r\n    // console.log('getHorizontalTableGroupIdsFromComps, comp:', comp);\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (!innerComps) {\r\n      continue;\r\n    }\r\n\r\n    // console.log('getTableGroupIdsFromComps, comp.type:', comp.type);\r\n\r\n    // skip comps that aren't horizontal tables\r\n    if (comp.type !== 'horizontal-table-group') {\r\n      continue;\r\n    }\r\n\r\n    tableGroupId = comp._id;\r\n    // console.log('getHorizontalTableGroupIdsFromComps, tableGroupId:', tableGroupId);\r\n  }\r\n\r\n  return tableGroupId;\r\n}\r\n\r\n// this makes the empty horizontalTableGroups object given a list of topics.\r\nfunction createHorizontalTableGroups(config) {\r\n  const topics = config.topics;\r\n\r\n  let tableGroupIds = [];\r\n\r\n  for (let topic of topics) {\r\n    const comps = topic.components;\r\n    const compTableGroupId = getHorizontalTableGroupIdsFromComps(comps);\r\n    if (compTableGroupId) tableGroupIds.push(compTableGroupId);\r\n  }\r\n  // console.log('createHorizontalTableGroups is running, config:', config, 'tableGroupIds:', tableGroupIds);\r\n\r\n  let horizontalTableGroups = {};\r\n\r\n  for (let tableGroupId of tableGroupIds) {\r\n    horizontalTableGroups[tableGroupId] = {\r\n      activeTable: null,\r\n      activeTableId: null\r\n    };\r\n  }\r\n  return horizontalTableGroups;\r\n}\r\n\r\nfunction createStore(config) {\r\n  // create initial state for sources. data key => {}\r\n  const sourceKeys = Object.keys(config.dataSources || {});\r\n  const sources = sourceKeys.reduce((o, key) => {\r\n    let val;\r\n    // if the source has targets, just set it to be an empty object\r\n    if (config.dataSources[key].targets) {\r\n      val = {\r\n        targets: {}\r\n      };\r\n    } else {\r\n      val = {\r\n       // we have to define these here, because vue can't observe properties that\r\n       // are added later.\r\n       status: null,\r\n       secondaryStatus: null,\r\n       data: null\r\n     };\r\n    }\r\n\r\n    o[key] = val;\r\n\r\n    return o;\r\n  }, {});\r\n\r\n  const parcelKeys = Object.keys(config.parcels || {});\r\n  const parcels = parcelKeys.reduce((o, key) => {\r\n    let val;\r\n    if (config.parcels[key].multipleAllowed) {\r\n      val = {\r\n        data: [],\r\n        status: null,\r\n        activeParcel: null,\r\n        activeAddress: null,\r\n        activeMapreg: null\r\n      };\r\n    } else {\r\n      val = null;\r\n      // val = {\r\n      //   geometry: null,\r\n      //   id: null,\r\n      //   properties: null,\r\n      //   type: null\r\n      // };\r\n    }\r\n\r\n    o[key] = val;\r\n\r\n    return o;\r\n  }, {});\r\n\r\n  const initialState = {\r\n    isMobileOrTablet: isMobileDevice(),\r\n    fullScreenMapEnabled: false,\r\n\r\n    // this gets set to the parcel layer for the default (aka first) topic in\r\n    // DataManager.resetGeocode, which is called by Router.hashChanged on app\r\n    // load.\r\n    activeTopic: '',\r\n    activeParcelLayer: '',\r\n\r\n    // the ais feature\r\n    clickCoords: null,\r\n    geocode: {\r\n      status: null,\r\n      data: null,\r\n      input: null,\r\n      related: null,\r\n    },\r\n    lastSearchMethod: 'geocode',\r\n    // the leaflet map object\r\n    map: {\r\n      location: {\r\n        lat: null,\r\n        lng: null\r\n      },\r\n      center: config.map.center,\r\n      bounds: {\r\n        northEast: null,\r\n        southWest: null,\r\n      },\r\n      zoom: config.map.zoom,\r\n      boundsBasedOnShape: null,\r\n      map: null,\r\n      // this gets set to the parcel layer for the default topic by\r\n      // DataManager.resetGeocode; see note above for activeTopic and\r\n      // activeParcelLayer.\r\n      basemap: '',\r\n      imagery: 'imagery2017',\r\n      shouldShowImagery: false,\r\n      // this is the key for the active overlay image (eg regmap)\r\n      imageOverlay: null,\r\n      imageOverlayOpacity: null,\r\n      filters: [],\r\n      watchPositionOn: false,\r\n    },\r\n    shouldShowAddressCandidateList: false,\r\n    candidates: [],\r\n    addressEntered: null,\r\n    parcels,\r\n    sources,\r\n    cyclomedia: {\r\n      initialized: false,\r\n      navBarOpen: false,\r\n      // surfaceCursorOn: true,\r\n      latLngFromMap: null,\r\n      orientation: {\r\n        yaw: null,\r\n        hFov: null,\r\n        xyz: null,\r\n      },\r\n      active: false,\r\n      recordings: [],\r\n    },\r\n    // we need this to know whether or not to force an update on the first show\r\n    pictometry: {\r\n      ipa: null,\r\n      active: false,\r\n      shapeIds: [],\r\n      pngMarkerIds: [],\r\n      zoom: null,\r\n      // this is the state of the main leaflet map. when these values change\r\n      // the pictometry widget should react. the reason these are duplicated\r\n      // here is to avoid an infinite loop in the Map component when the\r\n      // viewport changes.\r\n      map: {\r\n        center: config.map.center,\r\n        zoom: config.map.zoom\r\n      }\r\n    },\r\n    horizontalTables: {\r\n      // table id => filtered rows\r\n      filteredData: createFilteredData(config),\r\n    },\r\n    horizontalTableGroups: createHorizontalTableGroups(config),\r\n    activeFeature: {\r\n      featureId: null,\r\n      tableId: null\r\n    }\r\n  };\r\n\r\n  // TODO standardize how payloads are passed around/handled\r\n  return new Vuex.Store({\r\n    state: initialState,\r\n    getters: {\r\n      visibleTableIds(state) {\r\n        // get active topic\r\n        const activeTopic = state.activeTopic;\r\n\r\n        if (!activeTopic) {\r\n          return [];\r\n        }\r\n\r\n        // get horizontal table ids for that topic\r\n        const activeTopicConfig = (config.topics.filter(topic => topic.key === activeTopic) || [])[0];\r\n        const comps = activeTopicConfig.components;\r\n\r\n        const compTableGroup = getHorizontalTableGroupIdsFromComps(comps);\r\n        if (compTableGroup) {\r\n          // even though there is only 1 value, it has to be in array form in the state\r\n          const array = [];\r\n          array.push(state.horizontalTableGroups[compTableGroup].activeTableId);\r\n          return array;\r\n        } else {\r\n          const compTables = getHorizontalTableIdsFromComps(comps);\r\n          return compTables;\r\n        }\r\n      }\r\n    },\r\n    mutations: {\r\n      setCyclomediaInitialized(state, payload) {\r\n        state.cyclomedia.initialized = payload;\r\n      },\r\n      setIsMobileOrTablet(state, payload) {\r\n        state.isMobileOrTablet = payload;\r\n      },\r\n      setFullScreenMapEnabled(state, payload) {\r\n        state.fullScreenMapEnabled = payload;\r\n      },\r\n      setLocation(state, payload) {\r\n        state.map.location.lat = payload.lat;\r\n        state.map.location.lng = payload.lng;\r\n      },\r\n      setWatchPositionOn(state, payload) {\r\n        state.map.watchPositionOn = payload;\r\n      },\r\n      setClickCoords(state, payload) {\r\n        state.clickCoords = payload;\r\n      },\r\n      setHorizontalTableGroupActiveTable(state, payload) {\r\n        // console.log('setHorizontalTableGroupActiveTable, payload:', payload);\r\n        state.horizontalTableGroups[payload.tableGroupId].activeTableId = payload.activeTableId;\r\n        state.horizontalTableGroups[payload.tableGroupId].activeTable = payload.activeTable;\r\n      },\r\n      setHorizontalTableFilteredData(state, payload) {\r\n        const { tableId, data } = payload;\r\n\r\n        // check for not-null table id\r\n        if (!tableId) return;\r\n\r\n        state.horizontalTables.filteredData[tableId] = data;\r\n      },\r\n      setActiveTopic(state, payload) {\r\n        state.activeTopic = payload;\r\n      },\r\n      setActiveParcelLayer(state, payload) {\r\n        state.activeParcelLayer = payload;\r\n      },\r\n      setSourceStatus(state, payload) {\r\n        const key = payload.key;\r\n        const status = payload.status;\r\n\r\n        // if a target id was passed in, set the status for that target\r\n        const targetId = payload.targetId;\r\n\r\n        if (targetId) {\r\n          // console.log('store.js setSourceStatus, key:', key, 'status:', status, 'targetId:', targetId);\r\n          state.sources[key].targets[targetId].status = status;\r\n        } else {\r\n          state.sources[key].status = status;\r\n        }\r\n      },\r\n      setSecondarySourceStatus(state, payload) {\r\n        const key = payload.key;\r\n        const secondaryStatus = payload.secondaryStatus;\r\n\r\n        // if a target id was passed in, set the status for that target\r\n        const targetId = payload.targetId;\r\n\r\n        // if (targetId) {\r\n        //   state.sources[key].targets[targetId].status = status;\r\n        // } else {\r\n        state.sources[key].secondaryStatus = secondaryStatus;\r\n        // }\r\n      },\r\n      setSourceData(state, payload) {\r\n        // console.log('store setSourceData payload:', payload);\r\n        const key = payload.key;\r\n        const data = payload.data;\r\n\r\n        // if a target id was passed in, set the data object for that target\r\n        const targetId = payload.targetId;\r\n\r\n        if (targetId) {\r\n          if (state.sources[key].targets[targetId]) {\r\n            state.sources[key].targets[targetId].data = data;\r\n          }\r\n        } else {\r\n          state.sources[key].data = data;\r\n        }\r\n      },\r\n      setSourceDataMore(state, payload) {\r\n        const key = payload.key;\r\n        const data = payload.data;\r\n        const nextPage = payload.page;\r\n        const oldData = state.sources[key].data;\r\n        // console.log('oldData features', oldData.features, 'data features', data.features);\r\n        const allData = oldData.features.concat(data.features);\r\n        // console.log('allData', allData);\r\n        // if a target id was passed in, set the data object for that target\r\n        // const targetId = payload.targetId;\r\n\r\n        // if (targetId) {\r\n        //   state.sources[key].targets[targetId].data = data;\r\n        // } else {\r\n\r\n        state.sources[key].data.features = allData;\r\n        state.sources[key].data.page = nextPage;\r\n        // }\r\n      },\r\n      setMapFilters(state, payload) {\r\n        state.map.filters = payload;\r\n      },\r\n      // this sets empty targets for a data source\r\n      createEmptySourceTargets(state, payload) {\r\n        const {key, targetIds} = payload;\r\n        state.sources[key].targets = targetIds.reduce((acc, targetId) => {\r\n          acc[targetId] = {\r\n            status: null,\r\n            data: null\r\n          };\r\n          return acc;\r\n        }, {});\r\n      },\r\n      clearSourceTargets(state, payload) {\r\n        const key = payload.key;\r\n        state.sources[key].targets = {};\r\n      },\r\n      setMap(state, payload) {\r\n        state.map.map = payload.map;\r\n      },\r\n      // this is the map center as an xy coordinate array (not latlng)\r\n      setMapCenter(state, payload) {\r\n        state.map.center = payload;\r\n      },\r\n      setMapZoom(state, payload) {\r\n        state.map.zoom = payload;\r\n      },\r\n      setMapBounds(state, payload) {\r\n        // const { northEast, southWest } = payload || {};\r\n        // state.map.bounds.northEast = northEast;\r\n        // state.map.bounds.southWest = southWest;\r\n        state.map.bounds = payload;\r\n      },\r\n      setMapBoundsBasedOnShape(state, payload) {\r\n        state.map.boundsBasedOnShape = payload\r\n      },\r\n      setParcelData(state, payload) {\r\n        // console.log('store setParcelData payload:', payload);\r\n        const { parcelLayer, data, multipleAllowed, status, activeParcel, activeAddress, activeMapreg } = payload || {};\r\n        // console.log('store setParcelData parcelLayer:', parcelLayer, 'data:', data, 'multipleAllowed:', multipleAllowed, 'status:', status, 'activeParcel:', activeParcel);\r\n        if (!multipleAllowed) {\r\n          state.parcels[parcelLayer] = data;\r\n        } else {\r\n          state.parcels[parcelLayer].data = data;\r\n          state.parcels[parcelLayer].status = status;\r\n          state.parcels[parcelLayer].activeParcel = activeParcel;\r\n          state.parcels[parcelLayer].activeAddress = activeAddress;\r\n          state.parcels[parcelLayer].activeMapreg = activeMapreg;\r\n        }\r\n      },\r\n      setActiveParcel(state, payload) {\r\n        // console.log('store setActiveParcel:', payload)\r\n        const { parcelLayer, activeParcel, activeAddress, activeMapreg } = payload || {};\r\n        state.parcels[parcelLayer].activeParcel = activeParcel;\r\n        state.parcels[parcelLayer].activeAddress = activeAddress;\r\n        state.parcels[parcelLayer].activeMapreg = activeMapreg;\r\n      },\r\n      // setDorParcelData(state, payload) {\r\n      //   state.dorParcels.data = payload;\r\n      //   // state.parcels.dor.data = payload;\r\n      // },\r\n      // setDorParcelStatus(state, payload) {\r\n      //   state.dorParcels.status = payload;\r\n      //   // state.parcels.dor.status = payload;\r\n      // },\r\n      // setActiveDorParcel(state, payload) {\r\n      //   state.activeDorParcel = payload;\r\n      //   // state.parcels.dor.activeParcel = payload;\r\n      // },\r\n      // setActiveDorAddress(state, payload) {\r\n      //   state.activeDorAddress = payload;\r\n      //   // state.parcels.dor.activeAddress = payload;\r\n      // },\r\n      // setActiveDorMapreg(state, payload) {\r\n      //   state.activeDorMapreg = payload;\r\n      //   // state.parcels.dor.activeMapreg = payload;\r\n      // },\r\n      // setPwdParcel(state, payload) {\r\n      //   state.pwdParcel = payload;\r\n      //   // state.parcels.pwd = payload;\r\n      // },\r\n      setGeocodeStatus(state, payload) {\r\n        state.geocode.status = payload;\r\n      },\r\n      setGeocodeData(state, payload) {\r\n        state.geocode.data = payload;\r\n      },\r\n      setGeocodeRelated(state, payload) {\r\n        state.geocode.related = payload;\r\n      },\r\n      setGeocodeInput(state, payload) {\r\n        state.geocode.input = payload;\r\n      },\r\n      setBasemap(state, payload) {\r\n        state.map.basemap = payload;\r\n      },\r\n      setImagery(state, payload) {\r\n        state.map.imagery = payload;\r\n      },\r\n      setShouldShowImagery(state, payload) {\r\n        state.map.shouldShowImagery = payload;\r\n      },\r\n      setPictometryActive(state, payload) {\r\n        if (!config.pictometry.enabled) {\r\n          return;\r\n        }\r\n        state.pictometry.active = payload;\r\n      },\r\n      setCyclomediaActive(state, payload) {\r\n        if (!config.cyclomedia.enabled) {\r\n          return;\r\n        }\r\n        state.cyclomedia.active = payload;\r\n      },\r\n      setCyclomediaYaw(state, payload) {\r\n        state.cyclomedia.orientation.yaw = payload\r\n      },\r\n      setCyclomediaHFov(state, payload) {\r\n        state.cyclomedia.orientation.hFov = payload\r\n      },\r\n      setCyclomediaXyz(state, payload) {\r\n        state.cyclomedia.orientation.xyz = payload\r\n      },\r\n      setCyclomediaRecordings(state, payload) {\r\n        state.cyclomedia.recordings = payload;\r\n      },\r\n      setCyclomediaLatLngFromMap(state, payload) {\r\n        state.cyclomedia.latLngFromMap = payload;\r\n        // const { lat, lng } = payload || {};\r\n        // state.cyclomedia.latLngFromMap[0] = lat;\r\n        // state.cyclomedia.latLngFromMap[1] = lng;\r\n      },\r\n      setCyclomediaNavBarOpen(state, payload) {\r\n        state.cyclomedia.navBarOpen = payload;\r\n      },\r\n      // setCyclomediaSurfaceCursorOn(state, payload) {\r\n      //   state.cyclomedia.surfaceCursorOn = payload;\r\n      // },\r\n      setActiveFeature(state, payload) {\r\n        // console.log('store setActiveFeature is running');\r\n        const { featureId, tableId } = payload || {};\r\n        const nextActiveFeature = { featureId, tableId };\r\n        state.activeFeature = nextActiveFeature;\r\n      },\r\n      setLastSearchMethod(state, payload) {\r\n        state.lastSearchMethod = payload;\r\n      },\r\n      setPictometryIpa(state, payload) {\r\n        state.pictometry.ipa = payload;\r\n      },\r\n      setPictometryShapeIds(state, payload) {\r\n        state.pictometry.shapeIds = payload;\r\n      },\r\n      setPictometryPngMarkerIds(state, payload) {\r\n        state.pictometry.pngMarkerIds = payload;\r\n      },\r\n      // this is the leaflet map center updated when the map is moved\r\n      setPictometryMapCenter(state, payload) {\r\n        state.pictometry.map.center = payload;\r\n      },\r\n      setPictometryMapZoom(state, payload) {\r\n        state.pictometry.map.zoom = payload;\r\n      },\r\n      setPictometryZoom(state, payload) {\r\n        state.pictometry.zoom = payload;\r\n      },\r\n      setImageOverlay(state, payload) {\r\n        state.map.imageOverlay = payload;\r\n      },\r\n      setImageOverlayOpacity(state, payload) {\r\n        state.map.imageOverlayOpacity = payload;\r\n      },\r\n      // setCircleMarkers(state, payload) {\r\n      //   state.map.circleMarkers.push(payload);\r\n      // }\r\n      setShouldShowAddressCandidateList(state, payload) {\r\n        state.shouldShowAddressCandidateList = payload;\r\n      },\r\n      setCandidates(state, payload) {\r\n        state.candidates = payload;\r\n      },\r\n      setAddressEntered(state, payload) {\r\n        state.addressEntered = payload;\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nexport default createStore;\r\n","// shout out to airyland\r\n// https://github.com/airyland/vue-config/blob/master/index.js\r\n\r\nexport default (Vue, config) => {\r\n  Vue.mixin({\r\n    created() {\r\n      this.$config = config;\r\n    }\r\n  });\r\n};\r\n","<template>\r\n  <div id=\"topic-panel-container\"\r\n       :class=\"this.topicPanelContainerClass\"\r\n  >\r\n      <!-- before search -->\r\n      <greeting v-show=\"shouldShowGreeting\" />\r\n\r\n      <!-- after search -->\r\n      <div v-if=\"!shouldShowGreeting\" class=\"topic-panel-content cell\">\r\n        <!-- address header -->\r\n        <div class=\"address-header\">\r\n          <h1 class=\"address-header-line-1\">\r\n            <i class=\"fa fa-map-marker\"></i>\r\n            {{ address }}\r\n          </h1>\r\n          <div class=\"address-header-line-2\">PHILADELPHIA, PA {{ zipCode }}</div>\r\n        </div>\r\n\r\n        <!-- topics container -->\r\n        <div class=\"topics-container cell medium-cell-block-y\"\r\n             :style=\"styleObject\"\r\n        >\r\n          <address-input v-if=\"this.shouldShowAddressInput\" />\r\n          <address-candidate-list v-if=\"this.addressAutocompleteEnabled && this.shouldShowAddressInput\" />\r\n\r\n          <topic v-for=\"topic in this.$config.topics\"\r\n                 :topicKey=\"topic.key\"\r\n                 :key=\"topic.key\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  import philaVueComps from '@cityofphiladelphia/phila-vue-comps';\r\n  const Topic = philaVueComps.Topic;\r\n  const Greeting = philaVueComps.Greeting;\r\n  const AddressInput = philaVueComps.AddressInput;\r\n  const AddressCandidateList = philaVueComps.AddressCandidateList;\r\n\r\n  export default {\r\n    components: {\r\n      Greeting,\r\n      Topic,\r\n      AddressInput,\r\n      AddressCandidateList\r\n    },\r\n    data() {\r\n      const data = {\r\n        styleObject: {\r\n          'overflow-y': 'auto',\r\n          'height': '100px'\r\n        }\r\n      };\r\n      return data;\r\n    },\r\n    mounted() {\r\n      window.addEventListener('resize', this.handleWindowResize);\r\n      this.handleWindowResize();\r\n    },\r\n    // beforeDestroy() {\r\n    //   window.removeEventListener('resize', this.handleWindowResize);\r\n    // },\r\n    computed: {\r\n      shouldShowAddressInput() {\r\n        if (this.$config.addressInputLocation == 'topics') {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      addressAutocompleteEnabled() {\r\n        // TODO tidy up the code\r\n        if (this.$config.addressInput.autocompleteEnabled === true) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      fullScreenMapEnabled() {\r\n        return this.$store.state.fullScreenMapEnabled;\r\n      },\r\n      topicPanelContainerClass() {\r\n        if (this.fullScreenMapEnabled) {\r\n          return 'cell medium-1 small-order-2 medium-order-1'\r\n        } else {\r\n          return 'cell medium-12 small-order-2 medium-order-1'\r\n        }\r\n      },\r\n      geocode() {\r\n        return this.$store.state.geocode.data;\r\n      },\r\n      dorParcels() {\r\n        return this.$store.state.parcels.dor.data.length > 0;\r\n      },\r\n      shouldShowGreeting() {\r\n        return !(this.geocode || this.dorParcels);\r\n      },\r\n      // this returns the address shown in the address header\r\n      address() {\r\n        const geocode = this.geocode;\r\n        const dorParcels = this.$store.state.parcels.dor.data;\r\n        const activeDorAddress = this.$store.state.parcels.dor.activeAddress;\r\n        let address;\r\n\r\n        if (geocode) {\r\n          // TODO make this not ais-specific\r\n          // REVIEW what's the difference between these two?\r\n          const addressA = geocode.properties.street_address;\r\n          const addressB = geocode.street_address;\r\n\r\n          address = addressA || addressB;\r\n\r\n        // a DOR address might be found even if there is no geocode\r\n        } else if (activeDorAddress) {\r\n          address = activeDorAddress;\r\n        }\r\n\r\n        return address;\r\n      },\r\n      zipCode() {\r\n        const geocode = this.geocode;\r\n        if (!geocode) return null;\r\n        const zipCode = geocode.properties.zip_code;\r\n        const zip4 = geocode.properties.zip_4;\r\n        const parts = [zipCode];\r\n        if (zip4) parts.push(zip4);\r\n        return parts.join('-');\r\n      },\r\n    },\r\n    methods: {\r\n      shouldShowTopic(topic) {\r\n        const requiredSources = topic.dataSources || [];\r\n\r\n        // if there aren't any required topics, show it\r\n        if (requiredSources.length === 0) {\r\n          return true;\r\n        }\r\n\r\n        const sources = this.$store.state.sources;\r\n        return requiredSources.every(key => sources[key].data)\r\n      },\r\n      handleWindowResize() {\r\n        // console.log('handleWindowResize is running');\r\n        if ($(window).width() >= 750) {\r\n          // console.log('if is running, window width is >= 750px');\r\n          const rootElement = document.getElementById('mb-root');\r\n          const rootStyle = window.getComputedStyle(rootElement);\r\n          const rootHeight = rootStyle.getPropertyValue('height');\r\n          const rootHeightNum = parseInt(rootHeight.replace('px', ''));\r\n          const topicsHeight = rootHeightNum - 103;\r\n          this.styleObject.height = topicsHeight.toString() + 'px';\r\n          this.styleObject['overflow-y'] = 'auto';\r\n        } else {\r\n          // console.log('else is running, window width is < 750px');\r\n          this.styleObject.height = 'auto';\r\n          this.styleObject['overflow-y'] = 'hidden';\r\n        }\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n  .address-header {\r\n    background: #daedfe;\r\n    color: #0f4d90;\r\n    padding: 20px;\r\n\r\n    /*this keeps the box shadow over the scrollable part of the panel*/\r\n    position: relative;\r\n    z-index: 1;\r\n\r\n    -webkit-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18);\r\n    -moz-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18);\r\n    box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18);\r\n    margin-bottom: 0px !important;\r\n  }\r\n\r\n  .address-header-line-1 {\r\n    margin-bottom: 0;\r\n    margin-top: 0;\r\n    padding: 0px !important;\r\n  }\r\n\r\n  .address-header-line-2 {\r\n    padding: 0px;\r\n  }\r\n\r\n  .topics-container {\r\n    padding: 20px;\r\n    overflow-x: hidden;\r\n  }\r\n\r\n  @media screen and (min-width: 40em) {\r\n    .topics-container {\r\n      /* height: 100%; */\r\n      /* height: calc(100vh - 210px); */\r\n    }\r\n  }\r\n</style>\r\n","export default {\r\n  watch: {\r\n    activeFeature(nextActiveFeature, prevActiveFeature) {\r\n      // console.log('WATCH active feature', prevActiveFeature, '=>', nextActiveFeature);\r\n\r\n      const layerMap = this.$store.state.map.map._layers;\r\n      const layers = Object.values(layerMap);\r\n\r\n      let updateFeaturePrev,\r\n          updateFeatureNext,\r\n          tableId,\r\n          featureIdPrev,\r\n          featureIdNext,\r\n          matchingLayerNext,\r\n          matchingLayerPrev;\r\n\r\n      if (prevActiveFeature && prevActiveFeature.tableId && prevActiveFeature.featureId) {\r\n        updateFeaturePrev = prevActiveFeature;\r\n        tableId = updateFeaturePrev.tableId\r\n        featureIdPrev = updateFeaturePrev.featureId;\r\n        matchingLayerPrev = layers.filter(layer => {\r\n          const options = layer.options || {};\r\n          const data = options.data;\r\n          if (!data) return;\r\n          const layerFeatureId = data.featureId;\r\n          const layerTableId = data.tableId;\r\n          return layerFeatureId === featureIdPrev && layerTableId === tableId;\r\n        })[0];\r\n        this.updateMarkerFillColor(matchingLayerPrev);\r\n      }\r\n\r\n      if (nextActiveFeature && nextActiveFeature.tableId && nextActiveFeature.featureId) {\r\n        updateFeatureNext = nextActiveFeature;\r\n        tableId = updateFeatureNext.tableId\r\n        featureIdNext = updateFeatureNext.featureId;\r\n        matchingLayerNext = layers.filter(layer => {\r\n          const options = layer.options || {};\r\n          const data = options.data;\r\n          if (!data) return;\r\n          const layerFeatureId = data.featureId;\r\n          const layerTableId = data.tableId;\r\n          return layerFeatureId === featureIdNext && layerTableId === tableId;\r\n        })[0];\r\n        this.updateMarkerFillColor(matchingLayerNext);\r\n        this.bringMarkerToFront(matchingLayerNext);\r\n      }\r\n\r\n    },\r\n  },\r\n  computed: {\r\n    locationMarker() {\r\n      const latlngArray = [this.$store.state.map.location.lat, this.$store.state.map.location.lng]\r\n      const marker = {\r\n        latlng: latlngArray,\r\n        radius: 6,\r\n        fillColor: '#ff3f3f',\r\n        color: '#ff0000',\r\n        weight: 1,\r\n        opacity: 1,\r\n        fillOpacity: 1.0\r\n      }\r\n      return marker;\r\n    },\r\n    // returns map markers as simple object with a geometry property, key,\r\n    // and optional properties for symbology\r\n    markers() {\r\n      const markers = [];\r\n\r\n      // geocoded address marker\r\n      const geocodeGeom = this.geocodeGeom;\r\n      if (this.identifyFeature === 'address-marker' && geocodeGeom) {\r\n        const latlng = [...geocodeGeom.coordinates].reverse();\r\n        const key = this.geocodeResult.properties.street_address;\r\n        const color = '#2176d2';\r\n        const markerType = 'geocode';\r\n        const addressMarker = {latlng, key, color, markerType};\r\n        markers.push(addressMarker);\r\n      }\r\n\r\n      // marker for topic from config\r\n      const topicMarker = this.activeTopicConfig.marker;\r\n      // console.log('topicMarker', topicMarker);\r\n      if (topicMarker) {\r\n        const markerPath = topicMarker['path'];\r\n        let path = this.$store.state.sources;\r\n        for (let level of markerPath) {\r\n          console.log('level:', level, 'path:', path);\r\n          if (path !== null && path !== undefined) {\r\n            path = path[level];\r\n          }\r\n        }\r\n        if (path !== null && path !== undefined) {\r\n          const latlng = [path[topicMarker.lat], path[topicMarker.lng]];\r\n          const key = path[topicMarker.key];\r\n          const color = topicMarker.color || 'green';\r\n          const markerType = 'overlay';\r\n          const markerObject = {latlng, key, color, markerType};\r\n          markers.push(markerObject);\r\n        }\r\n      }\r\n\r\n      return markers;\r\n    },\r\n    circleMarkers() {\r\n      const filteredData = this.$store.state.horizontalTables.filteredData;\r\n      // const filteredData = this.filteredData;\r\n      let circleMarkers = [];\r\n\r\n      // get visible tables based on active topic\r\n      const tableIds = this.$store.getters.visibleTableIds;\r\n\r\n      // console.log('computed circleMarkers is rerunning, filteredData:', filteredData, 'tableIds:', tableIds);\r\n\r\n      for (let tableId of tableIds) {\r\n        const tableConfig = this.getConfigForTable(tableId) || {};\r\n        // console.log('tableId:', tableId, 'tableConfig:', tableConfig);\r\n        const mapOverlay = (tableConfig.options || {}).mapOverlay;\r\n\r\n        if (!mapOverlay || mapOverlay.marker !== 'circle') {\r\n          continue;\r\n        }\r\n\r\n        const items = filteredData[tableId];\r\n\r\n        if (items.length < 1) {\r\n          continue;\r\n        }\r\n\r\n        const style = mapOverlay.style;\r\n\r\n        // go through rows\r\n        for (let item of items) {\r\n          // console.log('tableId', tableId)\r\n          let latlng;\r\n\r\n          // TODO - get geometry field name from config\r\n          if (item.geometry) {\r\n            const [x, y] = item.geometry.coordinates;\r\n            latlng = [y, x];\r\n          } else if (item.lat) {\r\n            latlng = [item.lat, item.lng]\r\n            // if (item.point_x) {\r\n            //   latlng = [item.point_y, item.point_x];\r\n            // } else if (item.geocode_x) {\r\n            //   latlng = [item.geocode_y, item.geocode_x];\r\n            // }\r\n          }\r\n\r\n          // check for active feature TODO - bind style props to state\r\n          let props = Object.assign({}, style);\r\n          props.latlng = latlng;\r\n          props.featureId = item._featureId;\r\n          props.tableId = tableId;\r\n          circleMarkers.push(props);\r\n        }\r\n      }\r\n\r\n      return circleMarkers;\r\n    },\r\n\r\n    // returns all geojson features to be rendered on the map along with\r\n    // necessary props.\r\n    geojsonFeatures() {\r\n      const features = [];\r\n\r\n      const identifyFeature = this.identifyFeature;\r\n      const activeParcelLayer = this.activeParcelLayer;\r\n\r\n      // TODO - get pwd parcel and dor parcel into the config file\r\n      // pwd parcel\r\n      if (identifyFeature === 'pwd-parcel' && activeParcelLayer === 'pwd' && this.pwdParcel) {\r\n        let props = {};\r\n        props.geojson = this.pwdParcel;\r\n        props.color = 'blue';\r\n        props.fillColor = 'blue';\r\n        props.weight = 2;\r\n        props.opacity = 1;\r\n        props.fillOpacity = 0.3;\r\n        props.key = props.geojson.properties.PARCELID;\r\n        features.push(props);\r\n\r\n      // dor parcel\r\n      } else if (identifyFeature === 'dor-parcel' && activeParcelLayer === 'dor') {\r\n        const color = 'blue';\r\n        const dorParcelFeatures = this.dorParcels.map(dorParcel => {\r\n          let props = {};\r\n          props.geojson = dorParcel;\r\n          props.color = 'blue';\r\n          props.fillColor = 'blue';\r\n          props.weight = 2;\r\n          props.opacity = 1;\r\n          props.fillOpacity = 0.3;\r\n          props.key = dorParcel.properties.OBJECTID;\r\n          return props;\r\n        });\r\n        features.push.apply(features, dorParcelFeatures);\r\n      }\r\n\r\n      // other geojson from config\r\n      const topicGeojson = this.activeTopicConfig.geojson;\r\n      if (topicGeojson) {\r\n        console.log('topicGeojson exists:', topicGeojson);\r\n        const geojsonPath = topicGeojson['path'];\r\n        let path = this.$store.state.sources;\r\n        for (let level of geojsonPath) {\r\n          if (path !== null) {\r\n            path = path[level];\r\n          }\r\n        }\r\n        if (path !== null) {\r\n          console.log('path:', path);\r\n          for (let geojson of path) {\r\n            let props = Object.assign({}, topicGeojson.style);\r\n            props.key = geojson[topicGeojson.key];\r\n            props.geojson = geojson\r\n            features.push(props);\r\n          }\r\n        }\r\n      }\r\n      return features;\r\n    },\r\n\r\n    // these geojson features will have mouseover and mouseout events,\r\n    // for highlighting horizontal table rows\r\n    reactiveGeojsonFeatures() {\r\n      const features = [];\r\n\r\n      const filteredData = this.$store.state.horizontalTables.filteredData;\r\n      // get visible tables based on active topic\r\n      const tableIds = this.$store.getters.visibleTableIds;\r\n\r\n      for (let tableId of tableIds) {\r\n        const tableConfig = this.getConfigForTable(tableId) || {};\r\n        const mapOverlay = (tableConfig.options || {}).mapOverlay;\r\n\r\n        if (!mapOverlay || mapOverlay.marker !== 'geojson') {\r\n          continue;\r\n        }\r\n\r\n        const items = filteredData[tableId];\r\n\r\n        if (items.length < 1) {\r\n          continue;\r\n        }\r\n\r\n        const style = mapOverlay.style;\r\n        items.push(tableId);\r\n\r\n        // go through rows\r\n        for (let item of items) {\r\n          let props = Object.assign({}, style);\r\n\r\n          props.geojson = item.geometry;\r\n          props.key = item.id;\r\n          props.featureId = item._featureId || null;\r\n          props.tableId = items[items.length-1];\r\n          features.push(props);\r\n        }\r\n      }\r\n      return features;\r\n    },\r\n\r\n    leafletMarkers() {\r\n      const markers = [];\r\n\r\n      markers.push.apply(markers, this.markers);\r\n      markers.push.apply(markers, this.geojsonFeatures);\r\n\r\n      return markers;\r\n    },\r\n  },\r\n  methods: {\r\n    getTableFromComps(comps, tableId) {\r\n      const matchingComps = comps.filter(comp => {\r\n        return (\r\n          comp.type === 'horizontal-table' &&\r\n          comp._id == tableId\r\n        );\r\n      }) || [];\r\n      return matchingComps[0];\r\n    },\r\n    getConfigForTable(tableId) {\r\n      const topics = this.$config.topics || [];\r\n\r\n      for (let topic of topics) {\r\n        const comps = topic.components || [];\r\n\r\n        // try outer comps\r\n        const table = this.getTableFromComps(comps, tableId);\r\n\r\n        if (table) return table;\r\n\r\n        // try inner comps\r\n        for (let comp of comps) {\r\n          const options = comp.options || {};\r\n\r\n          const innerComps = options.components || options.tables || [];\r\n\r\n          if (innerComps.length > 0) {\r\n            const innerTable = this.getTableFromComps(innerComps, tableId);\r\n            // console.log('table on 2nd try', innerTable, innerComps);\r\n\r\n            if (innerTable) return innerTable;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    bringMarkerToFront(circleMarker) {\r\n      // put marker on top\r\n      const el = circleMarker._path;\r\n\r\n      // remove from parent\r\n      const group = circleMarker._renderer._rootGroup;\r\n      group.removeChild(el);\r\n\r\n      // append to end (which brings it to the front)\r\n      group.appendChild(el);\r\n    },\r\n    handleMarkerMouseover(e) {\r\n      // console.log('handleMarkerMouseover is starting');\r\n      if (!this.isMobileOrTablet) {\r\n        // console.log('handleMarkerMouseover actions are running');\r\n        const { target } = e;\r\n        const { featureId, tableId } = target.options.data;\r\n        // console.log('target:', target, 'featureId:', featureId, 'tableId:', tableId);\r\n        this.$store.commit('setActiveFeature', { featureId, tableId });\r\n      }\r\n    },\r\n    handleMarkerClick(e) {\r\n      // console.log('handleMarkerClick is starting');\r\n      if (this.isMobileOrTablet) {\r\n        // console.log('handleMarkerClick actions are running');\r\n        const { target } = e;\r\n        const { featureId, tableId } = target.options.data;\r\n        // console.log('target:', target, 'featureId:', featureId, 'tableId:', tableId);\r\n        this.$store.commit('setActiveFeature', { featureId, tableId });\r\n      }\r\n    },\r\n    handleMarkerMouseout(e) {\r\n      // console.log('handleMarkerMouseout is starting');\r\n      // if (!this.isMobileOrTablet) {\r\n        // console.log('handleMarkerMouseout actions are running');\r\n        const { target } = e;\r\n        this.$store.commit('setActiveFeature', null);\r\n      // }\r\n    },\r\n    updateMarkerFillColor(marker) {\r\n      // console.log('updateMarkerFillColor, marker:', marker);\r\n      // get next fill color\r\n      const { featureId, tableId } = marker.options.data;\r\n      const nextFillColor = this.fillColorForCircleMarker(featureId, tableId);\r\n\r\n      // highlight. we're doing this here (non-reactively) because binding the\r\n      // fill color property was not performing well enough.\r\n      const nextStyle = Object.assign({}, marker.options);\r\n      nextStyle.fillColor = nextFillColor;\r\n      marker.setStyle(nextStyle);\r\n    },\r\n  }\r\n};\r\n","<template>\r\n  <div id=\"map-panel-container\"\r\n       :class=\"this.mapPanelContainerClass\"\r\n  >\r\n    <full-screen-map-toggle-tab v-once />\r\n    <map_ :class=\"{ 'mb-map-with-widget': this.$store.state.cyclomedia.active || this.$store.state.pictometry.active }\"\r\n          id=\"map-tag\"\r\n          :center=\"this.$store.state.map.center\"\r\n          :zoom=\"this.$store.state.map.zoom\"\r\n          @l-click=\"handleMapClick\"\r\n          @l-moveend=\"handleMapMove\"\r\n          zoom-control-position=\"bottomright\"\r\n          :min-zoom=\"this.$config.map.minZoom\"\r\n          :max-zoom=\"this.$config.map.maxZoom\"\r\n    >\r\n    <!-- :class=\"{ 'mb-map-with-widget': this.$store.state.cyclomedia.active || this.$store.state.pictometry.active }\" -->\r\n      <!-- loading mask -->\r\n      <div v-show=\"isGeocoding\" class=\"mb-map-loading-mask\">\r\n        <div class=\"mb-map-loading-mask-inner\">\r\n          <i class=\"fa fa-spinner fa-4x spin\"></i>\r\n          <h1>Finding address...</h1>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- basemaps -->\r\n      <esri-tiled-map-layer v-for=\"(basemap, key) in this.$config.map.basemaps\"\r\n                            v-if=\"activeBasemap === key\"\r\n                            :key=\"key\"\r\n                            :url=\"basemap.url\"\r\n                            :max-zoom=\"basemap.maxZoom\"\r\n                            :attribution=\"basemap.attribution\"\r\n      />\r\n\r\n      <!-- basemap labels and parcels outlines -->\r\n      <esri-tiled-map-layer v-for=\"(tiledLayer, key) in this.$config.map.tiledLayers\"\r\n                            v-if=\"tiledLayers.includes(key)\"\r\n                            :key=\"key\"\r\n                            :url=\"tiledLayer.url\"\r\n                            :zIndex=\"tiledLayer.zIndex\"\r\n                            :attribution=\"tiledLayer.attribution\"\r\n      />\r\n\r\n      <esri-tiled-overlay v-for=\"(tiledLayer, key) in this.$config.map.tiledOverlays\"\r\n                          v-if=\"activeTiledOverlays.includes(key)\"\r\n                          :key=\"key\"\r\n                          :url=\"tiledLayer.url\"\r\n                          :zIndex=\"tiledLayer.zIndex\"\r\n                          :opacity=\"tiledLayer.opacity\"\r\n      />\r\n\r\n      <esri-dynamic-map-layer v-for=\"(dynamicLayer, key) in this.$config.map.dynamicMapLayers\"\r\n                              v-if=\"activeDynamicMaps.includes(key)\"\r\n                              :key=\"key\"\r\n                              :url=\"dynamicLayer.url\"\r\n                              :attribution=\"dynamicLayer.attribution\"\r\n                              :transparent=\"true\"\r\n                              :opacity=\"dynamicLayer.opacity\"\r\n      />\r\n\r\n      <!-- dorParcels, pwdParcels, vacantLand, vacantBuilding -->\r\n      <esri-feature-layer v-for=\"(featureLayer, key) in this.$config.map.featureLayers\"\r\n                          v-if=\"shouldShowFeatureLayer(key, featureLayer.minZoom)\"\r\n                          :key=\"key\"\r\n                          :layerName=\"key\"\r\n                          :url=\"featureLayer.url\"\r\n                          :color=\"featureLayer.color\"\r\n                          :fillColor=\"featureLayer.color\"\r\n                          :fillOpacity=\"featureLayer.fillOpacity\"\r\n                          :weight=\"featureLayer.weight\"\r\n                          :style_=\"featureLayer.style\"\r\n      />\r\n\r\n      <!-- regmaps -->\r\n      <esri-dynamic-map-layer v-for=\"(item, key) in this.imageOverlayItems\"\r\n                              v-if=\"shouldShowImageOverlay(item.properties.RECMAP)\"\r\n                              :key=\"key\"\r\n                              :url=\"'//gis.phila.gov/arcgis/rest/services/Atlas/RegMaps/MapServer'\"\r\n                              :layers=\"[0]\"\r\n                              :layerDefs=\"'0:NAME=\\'g' + item.properties.RECMAP.toLowerCase() + '.tif\\''\"\r\n                              :transparent=\"true\"\r\n                              :opacity=\"0.5\"\r\n      />\r\n      <!-- :url=\"'//gis.phila.gov/arcgis/rest/services/DOR_ParcelExplorer/rtt_basemap/MapServer/'\" -->\r\n      <!-- :url=\"this.imageOverlayInfo.url\"\r\n      :opacity=\"this.imageOverlayInfo.opacity\" -->\r\n\r\n      <!-- address marker -->\r\n      <!-- REVIEW why does this need a key? it's not a list... -->\r\n      <!-- <vector-marker v-if=\"identifyFeature === 'address-marker' && geocodeGeom\"\r\n                    :latlng=\"[...geocodeGeom.coordinates].reverse()\"\r\n                    :key=\"streetAddress\"\r\n      /> -->\r\n\r\n      <!-- NEW METHOD: try rendering markers generically based on marker type -->\r\n      <!-- vector markers -->\r\n      <vector-marker v-for=\"(marker, index) in markers\"\r\n                     :latlng=\"marker.latlng\"\r\n                     :key=\"marker.key\"\r\n                     :markerColor=\"marker.color\"\r\n      />\r\n\r\n      <!-- marker using a png and ablility to rotate it -->\r\n      <png-marker v-if=\"this.cyclomediaActive\"\r\n                  :icon=\"'../../src/assets/camera.png'\"\r\n                  :latlng=\"cycloLatlng\"\r\n                  :rotationAngle=\"cycloRotationAngle\"\r\n      />\r\n\r\n      <!-- marker using custom code extending icons - https://github.com/iatkin/leaflet-svgicon -->\r\n      <svg-view-cone-marker v-if=\"this.cyclomediaActive\"\r\n                            :latlng=\"cycloLatlng\"\r\n                            :rotationAngle=\"cycloRotationAngle\"\r\n                            :hFov=\"cycloHFov\"\r\n      />\r\n\r\n\r\n      <!-- non-reactive geojson features -->\r\n      <geojson v-for=\"geojsonFeature in geojsonFeatures\"\r\n               v-if=\"shouldShowGeojson(geojsonFeature.key)\"\r\n               :geojson=\"geojsonFeature.geojson\"\r\n               :fillColor=\"geojsonFeature.fillColor\"\r\n               :color=\"geojsonFeature.color\"\r\n               :weight=\"geojsonFeature.weight\"\r\n               :opacity=\"geojsonFeature.opacity\"\r\n               :fillOpacity=\"geojsonFeature.fillOpacity\"\r\n               :key=\"geojsonFeature.key\"\r\n               :data=\"{\r\n                 featureId: geojsonFeature.featureId,\r\n                 tableId: geojsonFeature.tableId\r\n               }\"\r\n       />\r\n\r\n       <!-- reactive geojson features -->\r\n       <geojson v-for=\"geojsonFeature in reactiveGeojsonFeatures\"\r\n                v-if=\"shouldShowGeojson(geojsonFeature.key)\"\r\n                @l-mouseover=\"handleMarkerMouseover\"\r\n                @l-click=\"handleMarkerClick\"\r\n                @l-mouseout=\"handleMarkerMouseout\"\r\n                :geojson=\"geojsonFeature.geojson\"\r\n                :fillColor=\"geojsonFeature.fillColor\"\r\n                :color=\"geojsonFeature.color\"\r\n                :weight=\"geojsonFeature.weight\"\r\n                :opacity=\"geojsonFeature.opacity\"\r\n                :fillOpacity=\"geojsonFeature.fillOpacity\"\r\n                :key=\"geojsonFeature.key\"\r\n                :data=\"{\r\n                  featureId: geojsonFeature.featureId,\r\n                  tableId: geojsonFeature.tableId\r\n                }\"\r\n        />\r\n\r\n       <!-- location marker -->\r\n       <circle-marker v-if=\"this.$store.state.map.location.lat != null\"\r\n                      :latlng=\"this.locationMarker.latlng\"\r\n                      :radius=\"this.locationMarker.radius\"\r\n                      :fillColor=\"this.locationMarker.fillColor\"\r\n                      :color=\"this.locationMarker.color\"\r\n                      :weight=\"this.locationMarker.weight\"\r\n                      :opacity=\"this.locationMarker.opacity\"\r\n                      :fillOpacity=\"this.locationMarker.fillOpacity\"\r\n                      :key=\"Math.random()\"\r\n       />\r\n\r\n       <!-- TODO give these a real key -->\r\n      <circle-marker v-for=\"circleMarker in circleMarkers\"\r\n                     @l-mouseover=\"handleMarkerMouseover\"\r\n                     @l-click=\"handleMarkerClick\"\r\n                     @l-mouseout=\"handleMarkerMouseout\"\r\n                     :latlng=\"circleMarker.latlng\"\r\n                     :radius=\"circleMarker.radius\"\r\n                     :fillColor=\"circleMarker.fillColor\"\r\n                   \t :color=\"circleMarker.color\"\r\n                   \t :weight=\"circleMarker.weight\"\r\n                   \t :opacity=\"circleMarker.opacity\"\r\n                   \t :fillOpacity=\"circleMarker.fillOpacity\"\r\n                     :key=\"Math.random()\"\r\n                     :data=\"{\r\n                       featureId: circleMarker.featureId,\r\n                       tableId: circleMarker.tableId\r\n                     }\"\r\n      />\r\n\r\n       <!-- <vector-marker v-for=\"marker in threeOneOneMarkers\"\r\n                      v-if=\"activeTopicConfig.key === 'threeOneOne'\"\r\n                      :latlng=\"[marker.geometry.coordinates[1], marker.geometry.coordinates[0]]\"\r\n                      :key=\"marker.id\"\r\n                      :markerColor=\"'#b2ffb2'\"\r\n       /> -->\r\n\r\n      <!-- CONTROLS: -->\r\n      <!-- basemap control -->\r\n      <control-corner :vSide=\"'top'\"\r\n                      :hSide=\"'almostright'\"\r\n      >\r\n      </control-corner>\r\n\r\n      <control-corner :vSide=\"'top'\"\r\n                      :hSide=\"'almostleft'\"\r\n      >\r\n      </control-corner>\r\n\r\n      <!-- <basemap-tooltip :position=\"'topright'\"\r\n      /> -->\r\n\r\n      <div v-once>\r\n        <basemap-toggle-control v-if=\"shouldShowImageryToggle\"\r\n                                v-once\r\n                                :position=\"'topright'\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <basemap-select-control :position=\"this.basemapSelectControlPosition\" />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <pictometry-button v-if=\"this.shouldShowPictometryButton\"\r\n                           v-once\r\n                           :position=\"'topright'\"\r\n                           :link=\"'pictometry'\"\r\n                           :imgSrc=\"'../../src/assets/pictometry.png'\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <cyclomedia-button v-if=\"this.shouldShowCyclomediaButton\"\r\n                           v-once\r\n                           :position=\"'topright'\"\r\n                           :link=\"'cyclomedia'\"\r\n                           :imgSrc=\"'../../src/assets/cyclomedia.png'\"\r\n                           @click=\"handleCyclomediaButtonClick\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once\r\n           v-if=\"this.measureControlEnabled\"\r\n      >\r\n        <measure-control :position=\"'bottomleft'\" />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <legend-control v-for=\"legendControl in Object.keys(legendControls)\"\r\n                        :key=\"legendControl\"\r\n                        :position=\"'bottomleft'\"\r\n                        :options=\"legendControls[legendControl].options\"\r\n                        :items=\"legendControls[legendControl].data\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <location-control v-once\r\n                          v-if=\"this.geolocationEnabled\"\r\n                          :position=\"'bottomright'\"\r\n        />\r\n      </div>\r\n\r\n      <!-- <basemap-tooltip :position=\"'bottomalmostleft'\"\r\n      /> -->\r\n\r\n      <!-- <scale-control :vSide=\"'top'\"\r\n                     :hSide=\"'almostright'\"\r\n      >\r\n      </scale-control> -->\r\n\r\n      <div v-once>\r\n        <AddressInput v-if=\"this.shouldShowAddressInput\"\r\n                      :position=\"this.addressInputPosition\" />\r\n      </div>\r\n      <AddressCandidateList v-if=\"this.addressAutocompleteEnabled && this.shouldShowAddressInput\"\r\n                            :position=\"this.addressInputPosition\"\r\n      />\r\n\r\n\r\n      <cyclomedia-recording-circle v-for=\"recording in cyclomediaRecordings\"\r\n                                   v-if=\"cyclomediaActive\"\r\n                                   :key=\"recording.imageId\"\r\n                                   :imageId=\"recording.imageId\"\r\n                                   :latlng=\"[recording.lat, recording.lng]\"\r\n                                   :size=\"1.2\"\r\n                                   :color=\"'#3388ff'\"\r\n                                   :weight=\"1\"\r\n                                   @l-click=\"handleCyclomediaRecordingClick\"\r\n      />\r\n    </map_>\r\n    <slot class='widget-slot' name=\"cycloWidget\" />\r\n    <slot class='widget-slot' name=\"pictWidget\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import * as L from 'leaflet';\r\n  import philaVueMapping from '@cityofphiladelphia/phila-vue-mapping';\r\n\r\n  // mixins\r\n  import markersMixin from './markers-mixin';\r\n  const cyclomediaMixin = philaVueMapping.CyclomediaMixin;\r\n  const pictometryMixin = philaVueMapping.PictometryMixin;\r\n\r\n  // vue doesn't like it when you import this as Map (reserved-ish word)\r\n  const Map_ = philaVueMapping.Map_;\r\n  const Control = philaVueMapping.Control;\r\n  const AddressInput = philaVueMapping.AddressInput;\r\n  const AddressCandidateList = philaVueMapping.AddressCandidateList;\r\n  const EsriTiledMapLayer = philaVueMapping.EsriTiledMapLayer;\r\n  const EsriTiledOverlay = philaVueMapping.EsriTiledOverlay;\r\n  const EsriDynamicMapLayer = philaVueMapping.EsriDynamicMapLayer;\r\n  const EsriFeatureLayer = philaVueMapping.EsriFeatureLayer;\r\n  const Geojson = philaVueMapping.Geojson;\r\n  const CircleMarker = philaVueMapping.CircleMarker;\r\n  const OpacitySlider = philaVueMapping.OpacitySlider;\r\n  const VectorMarker = philaVueMapping.VectorMarker;\r\n  const PngMarker = philaVueMapping.PngMarker;\r\n  const BasemapToggleControl = philaVueMapping.BasemapToggleControl;\r\n  const BasemapSelectControl = philaVueMapping.BasemapSelectControl;\r\n  const FullScreenMapToggleTab = philaVueMapping.FullScreenMapToggleTab;\r\n  const LocationControl = philaVueMapping.LocationControl;\r\n  const CyclomediaButton = philaVueMapping.CyclomediaButton;\r\n  const PictometryButton = philaVueMapping.PictometryButton;\r\n  const CyclomediaRecordingCircle = philaVueMapping.CyclomediaRecordingCircle;\r\n  const CyclomediaRecordingsClient = philaVueMapping.CyclomediaRecordingsClient;\r\n  const SvgViewConeMarker = philaVueMapping.SvgViewConeMarker;\r\n  const MeasureControl = philaVueMapping.MeasureControl;\r\n  const LegendControl = philaVueMapping.LegendControl;\r\n  const BasemapTooltip = philaVueMapping.BasemapTooltip;\r\n  const ControlCorner = philaVueMapping.ControlCorner;\r\n\r\n  export default {\r\n    mixins: [\r\n      markersMixin,\r\n      cyclomediaMixin,\r\n      pictometryMixin,\r\n    ],\r\n    components: {\r\n      Map_,\r\n      Control,\r\n      AddressInput,\r\n      AddressCandidateList,\r\n      EsriTiledMapLayer,\r\n      EsriTiledOverlay,\r\n      EsriDynamicMapLayer,\r\n      EsriFeatureLayer,\r\n      Geojson,\r\n      CircleMarker,\r\n      OpacitySlider,\r\n      VectorMarker,\r\n      PngMarker,\r\n      BasemapToggleControl,\r\n      BasemapSelectControl,\r\n      FullScreenMapToggleTab,\r\n      LocationControl,\r\n      PictometryButton,\r\n      CyclomediaButton,\r\n      CyclomediaRecordingCircle,\r\n      SvgViewConeMarker,\r\n      MeasureControl,\r\n      LegendControl,\r\n      BasemapTooltip,\r\n      ControlCorner,\r\n    },\r\n    created() {\r\n      // if there's a default address, navigate to it\r\n      const defaultAddress = this.$config.defaultAddress;\r\n      if (defaultAddress) {\r\n        this.$controller.goToDefaultAddress(defaultAddress);\r\n      }\r\n\r\n      const cyclomediaConfig = this.$config.cyclomedia || {};\r\n      if (cyclomediaConfig.enabled) {\r\n      // create cyclomedia recordings client\r\n        this.$cyclomediaRecordingsClient = new CyclomediaRecordingsClient(\r\n          this.$config.cyclomedia.recordingsUrl,\r\n          this.$config.cyclomedia.username,\r\n          this.$config.cyclomedia.password,\r\n          4326\r\n        );\r\n      }\r\n    },\r\n    mounted() {\r\n      // this.geofind();\r\n      this.$controller.appDidLoad();\r\n    },\r\n    computed: {\r\n      shouldShowAddressInput() {\r\n        if (this.$config.addressInputLocation == 'map') {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      addressAutocompleteEnabled() {\r\n        // TODO tidy up the code\r\n        if (this.$config.addressInput.autocompleteEnabled === true) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      addressInputPosition() {\r\n        if (this.isMobileOrTablet) {\r\n          return 'topleft'\r\n        } else {\r\n          return 'topalmostleft'\r\n        }\r\n      },\r\n      basemapSelectControlPosition() {\r\n        if (this.isMobileOrTablet) {\r\n          return 'topright'\r\n        } else {\r\n          return 'topalmostright'\r\n        }\r\n      },\r\n      shouldShowAddressCandidateList() {\r\n        return this.$store.state.map.shouldShowAddressCandidateList;\r\n      },\r\n      measureControlEnabled() {\r\n        if (this.$config.measureControlEnabled === false) {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      },\r\n      fullScreenMapEnabled() {\r\n        return this.$store.state.fullScreenMapEnabled;\r\n      },\r\n      mapPanelContainerClass() {\r\n        // return 'medium-12 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map'\r\n        if (this.fullScreenMapEnabled) {\r\n          return 'medium-24 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map'\r\n        } else {\r\n          return 'medium-12 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map'\r\n        }\r\n      },\r\n      cycloLatlng() {\r\n        if (this.$store.state.cyclomedia.orientation.xyz !== null) {\r\n          const xyz = this.$store.state.cyclomedia.orientation.xyz;\r\n          return [xyz[1], xyz[0]];\r\n        } else {\r\n          const center = this.$config.map.center;\r\n          return center;\r\n        }\r\n      },\r\n      cycloRotationAngle() {\r\n        return this.$store.state.cyclomedia.orientation.yaw * (180/3.14159265359);\r\n      },\r\n      cycloHFov() {\r\n        return this.$store.state.cyclomedia.orientation.hFov;\r\n      },\r\n      isMobileOrTablet() {\r\n        return this.$store.state.isMobileOrTablet;\r\n      },\r\n      shouldShowCyclomediaButton() {\r\n        return this.$config.cyclomedia.enabled && !this.isMobileOrTablet;\r\n      },\r\n      shouldShowPictometryButton() {\r\n        return this.$config.pictometry.enabled && !this.isMobileOrTablet;\r\n      },\r\n      geolocationEnabled() {\r\n        return this.$config.geolocation.enabled;\r\n      },\r\n      activeDorParcel() {\r\n        // return this.$store.state.activeDorParcel;\r\n        return this.$store.state.parcels.dor.activeParcel;\r\n      },\r\n      legendControls() {\r\n        return this.$config.legendControls;\r\n      },\r\n      imageOverlay() {\r\n        return this.$store.state.map.imageOverlay;\r\n      },\r\n      imageOverlayItems() {\r\n        // console.log('calculating imageOverlayItem');\r\n        if (this.activeTopicConfig.imageOverlayGroup) {\r\n          const overlayGroup = this.activeTopicConfig.imageOverlayGroup;\r\n          const state = this.$store.state;\r\n          const overlay = this.$config.imageOverlayGroups[overlayGroup].items(state);\r\n          // console.log('returning imageOverlayItem', overlay);\r\n          return overlay;\r\n        } else {\r\n          return [];\r\n        }\r\n      },\r\n      imageOverlayInfo() {\r\n        console.log('config:', this.$config);\r\n        return this.$config.map.dynamicMapLayers.regmaps;\r\n      },\r\n      activeBasemap() {\r\n        const shouldShowImagery = this.$store.state.map.shouldShowImagery;\r\n        if (shouldShowImagery) {\r\n          return this.$store.state.map.imagery;\r\n        }\r\n        const defaultBasemap = this.$config.map.defaultBasemap;\r\n        const basemap = this.$store.state.map.basemap || defaultBasemap;\r\n        return basemap;\r\n      },\r\n      tiledLayers() {\r\n        const activeBasemap = this.activeBasemap;\r\n        const activeBasemapConfig = this.configForBasemap(activeBasemap)\r\n\r\n        return activeBasemapConfig.tiledLayers || [];\r\n      },\r\n      activeTiledOverlays() {\r\n        if (!this.activeTopicConfig || !this.activeTopicConfig.tiledOverlays) {\r\n          return [];\r\n        } else {\r\n          return this.activeTopicConfig.tiledOverlays;\r\n        }\r\n      },\r\n      activeDynamicMaps() {\r\n        if (!this.activeTopicConfig || !this.activeTopicConfig.dynamicMapLayers) {\r\n          return [];\r\n        } else {\r\n          return this.activeTopicConfig.dynamicMapLayers;\r\n        }\r\n      },\r\n      activeFeatureLayers() {\r\n        if (!this.activeTopicConfig || !this.activeTopicConfig.featureLayers) {\r\n          return [];\r\n        } else {\r\n          return this.activeTopicConfig.featureLayers;\r\n        }\r\n      },\r\n      activeFeature() {\r\n        return this.$store.state.activeFeature;\r\n      },\r\n      basemaps() {\r\n        return Object.values(this.$config.map.basemaps);\r\n      },\r\n      imageryBasemaps() {\r\n        return this.basemaps.filter(basemap => basemap.type === 'imagery');\r\n      },\r\n      hasImageryBasemaps() {\r\n        return this.imageryBasemaps.length > 0;\r\n      },\r\n      shouldShowImageryToggle() {\r\n        return this.hasImageryBasemaps && this.$config.map.imagery.enabled;\r\n      },\r\n      identifyFeature() {\r\n        let configFeature;\r\n        if (this.geocodeType === 'intersection') {\r\n          configFeature = \"address-marker\";\r\n        } else if (this.activeTopicConfig.identifyFeature) {\r\n          configFeature = this.activeTopicConfig.identifyFeature;\r\n        } else {\r\n          if (this.$config) {\r\n            configFeature = this.$config.map.defaultIdentifyFeature;\r\n          }\r\n        }\r\n        return configFeature;\r\n      },\r\n      activeTopic() {\r\n        return this.$store.state.activeTopic;\r\n      },\r\n      activeTopicConfig() {\r\n        const key = this.activeTopic;\r\n        let config;\r\n\r\n        // if no active topic, return null\r\n        if (key) {\r\n          config = this.$config.topics.filter((topic) => {\r\n            return topic.key === key;\r\n          })[0];\r\n        }\r\n\r\n        return config || {};\r\n      },\r\n      activeParcelLayer() {\r\n        return this.activeTopicConfig.parcels;\r\n      },\r\n      dorParcels() {\r\n        return this.$store.state.parcels.dor.data;\r\n      },\r\n      pwdParcel() {\r\n        return this.$store.state.parcels.pwd;\r\n      },\r\n      geocodeResult() {\r\n        return this.$store.state.geocode.data || {};\r\n      },\r\n      geocodeGeom() {\r\n        return this.geocodeResult.geometry;\r\n      },\r\n      geocodeType() {\r\n        return this.geocodeResult.ais_feature_type;\r\n      },\r\n      streetAddress() {\r\n        return this.geocodeResult.properties.street_address;\r\n      },\r\n      picOrCycloActive() {\r\n        if (this.cyclomediaActive || this.pictometryActive) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      mapBounds() {\r\n        // TODO calculate map bounds based on leaflet markers above\r\n      },\r\n      boundsBasedOnShape() {\r\n        return this.$store.state.map.boundsBasedOnShape;\r\n      },\r\n      isGeocoding() {\r\n        return this.$store.state.geocode.status === 'waiting';\r\n      }\r\n    },\r\n    watch: {\r\n      picOrCycloActive(value) {\r\n        this.$nextTick(() => {\r\n          this.$store.state.map.map.invalidateSize();\r\n        })\r\n      },\r\n      geojsonFeatures() {\r\n        this.setMapToBounds();\r\n      },\r\n      markers() {\r\n        this.setMapToBounds();\r\n      },\r\n    },\r\n    methods: {\r\n      setMapToBounds() {\r\n        // console.log('setMapToBounds is running');\r\n        let featureArray = []\r\n        if (this.activeTopicConfig.zoomToShape) {\r\n          if (this.activeTopicConfig.zoomToShape.includes('geojson')) {\r\n            for (let geojsonFeature of this.geojsonFeatures) {\r\n              featureArray.push(L.geoJSON(geojsonFeature.geojson))\r\n            }\r\n          }\r\n          if (this.activeTopicConfig.zoomToShape.includes('marker')) {\r\n            for (let marker of this.markers) {\r\n              if (marker.markerType === 'overlay') {\r\n                featureArray.push(L.marker(marker.latlng))\r\n              }\r\n            }\r\n          }\r\n          const group = new L.featureGroup(featureArray);\r\n          const bounds = group.getBounds();\r\n          this.$store.commit('setMapBounds', bounds);\r\n        }\r\n      },\r\n      configForBasemap(basemap) {\r\n        return this.$config.map.basemaps[basemap] || {};\r\n      },\r\n      shouldShowGeojson(key) {\r\n        if (this.activeTopicConfig.basemap === 'pwd') {\r\n          return true;\r\n        } else {\r\n          return key === this.activeDorParcel;\r\n        }\r\n      },\r\n      shouldShowImageOverlay(key) {\r\n        return key === this.imageOverlay;\r\n      },\r\n      shouldShowFeatureLayer(key, minZoom) {\r\n        if (this.activeFeatureLayers.includes(key)) {\r\n          if (minZoom) {\r\n            return this.$store.state.map.zoom >= minZoom;\r\n          }\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      handleMapClick(e) {\r\n        // console.log('MapPanel.vue handleMapClick e:', e);\r\n        // latLng = L.latLng(e.lat, e.lng)\r\n        this.$controller.handleMapClick(e);\r\n      },\r\n\r\n      handleMapMove(e) {\r\n        const map = this.$store.state.map.map;\r\n\r\n        const pictometryConfig = this.$config.pictometry || {};\r\n\r\n        const center = map.getCenter();\r\n        const { lat, lng } = center;\r\n        const coords = [lng, lat];\r\n\r\n        if (pictometryConfig.enabled) {\r\n          // update state for pictometry\r\n          this.$store.commit('setPictometryMapCenter', coords);\r\n\r\n          const zoom = map.getZoom();\r\n          this.$store.commit('setPictometryMapZoom', zoom);\r\n        }\r\n\r\n        const cyclomediaConfig = this.$config.cyclomedia || {};\r\n\r\n        if (cyclomediaConfig.enabled) {\r\n          // update cyclo recordings\r\n          this.updateCyclomediaRecordings();\r\n          this.$store.commit('setCyclomediaLatLngFromMap', [lat, lng]);\r\n        }\r\n      },\r\n      fillColorForCircleMarker(markerId, tableId) {\r\n        // get map overlay style and hover style for table\r\n        const tableConfig = this.getConfigForTable(tableId);\r\n        const mapOverlay = tableConfig.options.mapOverlay;\r\n        const { style, hoverStyle } = mapOverlay;\r\n\r\n        // compare id to active feature id\r\n        const activeFeature = this.activeFeature;\r\n        const useHoverStyle = (\r\n          markerId === activeFeature.featureId &&\r\n          tableId === activeFeature.tableId\r\n        );\r\n        const curStyle = useHoverStyle ? hoverStyle : style;\r\n\r\n        return curStyle.fillColor;\r\n      },\r\n    }, // end of methods\r\n  }; //end of export\r\n</script>\r\n\r\n<style scoped>\r\n  .mb-panel-map {\r\n    /*this allows the loading mask to fill the div*/\r\n    position: relative;\r\n  }\r\n\r\n  .mb-map-with-widget {\r\n    height: 50%;\r\n  }\r\n\r\n  .widget-slot {\r\n    display: inline-block;\r\n    float: left;\r\n  }\r\n\r\n  .mb-map-loading-mask {\r\n    /*display: inline;*/\r\n    position: absolute;\r\n    top: 0;\r\n    height: 100%;\r\n    width: 100%;\r\n    background: rgba(0, 0 ,0 , 0.25);\r\n    z-index: 1000;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n  }\r\n\r\n  .mb-map-loading-mask-inner {\r\n    position: absolute;\r\n    top: 40%;\r\n    left: 40%;\r\n  }\r\n\r\n  /*small retina*/\r\n  /*@media\r\n  (-webkit-min-device-pixel-ratio: 2),\r\n  (min-resolution: 192dpi),\r\n  (max-width: 39.9375em) {\r\n    .mb-search-control-input {\r\n      max-width: 250px;\r\n    }\r\n  }*/\r\n\r\n</style>\r\n","<template>\r\n  <div id=\"mb-root\"\r\n       :class=\"rootClass\"\r\n       :style=\"styleObject\"\r\n  >\r\n      <topic-panel :class=\"this.shouldShowTopicPanel\"\r\n      />\r\n      <map-panel>\r\n        <cyclomedia-widget v-if=\"this.shouldLoadCyclomediaWidget\"\r\n                           slot=\"cycloWidget\"\r\n                           v-show=\"cyclomediaActive\"\r\n                           screen-percent=\"2\"\r\n        />\r\n        <pictometry-widget v-if=\"this.shouldLoadPictometryWidget\"\r\n                           slot=\"pictWidget\"\r\n                           v-show=\"pictometryActive\"\r\n                           :apiKey=\"this.ak\"\r\n                           :secretKey=\"this.sk\"\r\n        >\r\n          <png-marker v-if=\"this.pictometryShowAddressMarker\"\r\n                      :latlng=\"[this.geocodeData.geometry.coordinates[1], this.geocodeData.geometry.coordinates[0]]\"\r\n                      :icon=\"'markers.png'\"\r\n                      :height=\"60\"\r\n                      :width=\"40\"\r\n                      :offsetX=\"0\"\r\n                      :offsetY=\"0\"\r\n          />\r\n          <layer v-if=\"this.pictometryActive\" />\r\n          <png-marker v-if=\"this.cyclomediaActive && this.pictometryActive\"\r\n                      :latlng=\"cycloLatlng\"\r\n                      :icon=\"'camera2.png'\"\r\n                      :height=\"20\"\r\n                      :width=\"30\"\r\n                      :offsetX=\"-2\"\r\n                      :offsetY=\"-2\"\r\n          />\r\n          <view-cone v-if=\"this.cyclomediaActive && this.pictometryActive\"\r\n                     :latlng=\"cycloLatlng\"\r\n                     :rotationAngle=\"cycloRotationAngle\"\r\n                     :hFov=\"cycloHFov\"\r\n          />\r\n        </pictometry-widget>\r\n      </map-panel>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import philaVueMapping from '@cityofphiladelphia/phila-vue-mapping';\r\n\r\n  import TopicPanel from './TopicPanel.vue';\r\n  import MapPanel from './MapPanel.vue';\r\n\r\n  const CyclomediaWidget = philaVueMapping.CyclomediaWidget;\r\n  const PictometryWidget = philaVueMapping.PictometryWidget;\r\n  const Layer = philaVueMapping.PictometryLayer;\r\n  const ViewCone = philaVueMapping.PictometryViewCone;\r\n  const PngMarker = philaVueMapping.PictometryPngMarker;\r\n\r\n  export default {\r\n    components: {\r\n      TopicPanel,\r\n      MapPanel,\r\n      CyclomediaWidget,\r\n      PictometryWidget,\r\n      Layer,\r\n      PngMarker,\r\n      ViewCone\r\n    },\r\n    data() {\r\n      const data = {\r\n        // this will only affect the app size if the app is set to \"plugin\" mode\r\n        styleObject: {\r\n          'height': '100px'\r\n        }\r\n      };\r\n      return data;\r\n    },\r\n    created() {\r\n      window.addEventListener('click', this.closeAddressCandidateList);\r\n      window.addEventListener('resize', this.handleWindowResize);\r\n      this.handleWindowResize();\r\n    },\r\n    computed: {\r\n      rootClass() {\r\n        if (this.$config.plugin) {\r\n          return 'grid-x';\r\n        } else {\r\n          return 'cell medium-auto grid-x';\r\n        }\r\n      },\r\n      isMobileOrTablet() {\r\n        return this.$store.state.isMobileOrTablet;\r\n      },\r\n      shouldLoadCyclomediaWidget() {\r\n        return this.$config.cyclomedia.enabled && !this.isMobileOrTablet;\r\n      },\r\n      shouldLoadPictometryWidget() {\r\n        return this.$config.pictometry.enabled && !this.isMobileOrTablet;\r\n      },\r\n      fullScreenMapEnabled() {\r\n        return this.$store.state.fullScreenMapEnabled;\r\n      },\r\n      shouldShowTopicPanel() {\r\n        let value = 'topic-panel-true';\r\n        if (this.fullScreenMapEnabled) {\r\n          value = 'topic-panel-false';\r\n        }\r\n        return value;\r\n      },\r\n      cyclomediaActive() {\r\n        return this.$store.state.cyclomedia.active\r\n      },\r\n      cycloLatlng() {\r\n        if (this.$store.state.cyclomedia.orientation.xyz !== null) {\r\n          const xyz = this.$store.state.cyclomedia.orientation.xyz;\r\n          return [xyz[1], xyz[0]];\r\n        } else {\r\n          const center = this.$config.map.center;\r\n          return center;\r\n        }\r\n      },\r\n      cycloRotationAngle() {\r\n        return this.$store.state.cyclomedia.orientation.yaw * (180/3.14159265359);\r\n      },\r\n      cycloHFov() {\r\n        return this.$store.state.cyclomedia.orientation.hFov;\r\n      },\r\n      pictometryActive() {\r\n        return this.$store.state.pictometry.active\r\n      },\r\n      pictometryZoom() {\r\n        return this.$store.state.pictometry.zoom\r\n      },\r\n      pictometryShowAddressMarker() {\r\n        if (!this.pictometryActive || !this.geocodeData) {\r\n          return false;\r\n        } else if (this.pictometryZoom < 20 && this.cyclomediaActive) {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      },\r\n      geocodeData() {\r\n        return this.$store.state.geocode.data\r\n      },\r\n      ak() {\r\n        const host = window.location.hostname;\r\n        if (host === 'atlas.phila.gov') {\r\n          return this.$config.pictometry.apiKey;\r\n        }\r\n        if (host === 'atlas-dev.phila.gov') {\r\n          return this.$config.pictometryDev.apiKey;\r\n        }\r\n        if (host === 'cityatlas.phila.gov') {\r\n          return this.$config.pictometryCity.apiKey;\r\n        }\r\n        if (host === 'cityatlas-dev.phila.gov') {\r\n          return this.$config.pictometryCityDev.apiKey;\r\n        }\r\n        if (host === '10.8.101.67') {\r\n          return this.$config.pictometryLocal.apiKey;\r\n        }\r\n      },\r\n      sk() {\r\n        const host = window.location.hostname;\r\n        if (host === 'atlas.phila.gov') {\r\n          return this.$config.pictometry.secretKey;\r\n        }\r\n        if (host === 'atlas-dev.phila.gov') {\r\n          return this.$config.pictometryDev.secretKey;\r\n        }\r\n        if (host === 'cityatlas.phila.gov') {\r\n          return this.$config.pictometryCity.secretKey;\r\n        }\r\n        if (host === 'cityatlas-dev.phila.gov') {\r\n          return this.$config.pictometryCityDev.secretKey;\r\n        }\r\n        if (host === '10.8.101.67') {\r\n          return this.$config.pictometryLocal.secretKey;\r\n        }\r\n      }\r\n    },\r\n    watch: {\r\n      pictometryShowAddressMarker(nextValue) {\r\n        console.log('watch pictometryShowAddressMarker', nextValue);\r\n      }\r\n    },\r\n    methods: {\r\n      closeAddressCandidateList() {\r\n        this.$store.state.map.shouldShowAddressCandidateList = false;\r\n      },\r\n      handleWindowResize() {\r\n        // this only actually affects the size if it is set to \"plugin mode\"\r\n        if ($(window).width() >= 750) {\r\n          this.styleObject.height = '600px'\r\n        } else {\r\n          this.styleObject.height = 'auto';\r\n        }\r\n      }\r\n    },\r\n  };\r\n</script>\r\n\r\n<style>\r\n  /*don't highlight any form elements*/\r\n  input:focus,\r\n  select:focus,\r\n  textarea:focus,\r\n  button:focus {\r\n    outline: none;\r\n  }\r\n\r\n  .mb-panel-topics-with-widget {\r\n    height: 50%;\r\n  }\r\n\r\n  /* standards applies padding to buttons, which causes some weirdness with\r\n  buttons on the map panel. override here. */\r\n  button {\r\n    padding: inherit;\r\n  }\r\n\r\n  .topic-panel-false {\r\n    /* display: none; */\r\n  }\r\n\r\n  @media screen and (min-width: 46.875em) {\r\n    .topic-panel-false {\r\n      display: none;\r\n    }\r\n  }\r\n\r\n</style>\r\n","// http://stackoverflow.com/a/37164538/676001\r\n\r\n// helper to verify that an item is an object\r\nexport function isObject(item) {\r\n  return (item && typeof item === 'object' && !Array.isArray(item) && item !== null);\r\n};\r\n\r\n// merges n objects, deeply, immutably\r\nexport default function mergeDeep(target, source) {\r\n  let output = Object.assign({}, target);\r\n  if (isObject(target) && isObject(source)) {\r\n    Object.keys(source).forEach(key => {\r\n      if (isObject(source[key])) {\r\n        if (!(key in target))\r\n          Object.assign(output, { [key]: source[key] });\r\n        else\r\n          output[key] = mergeDeep(target[key], source[key]);\r\n      } else {\r\n        Object.assign(output, { [key]: source[key] });\r\n      }\r\n    });\r\n  }\r\n  return output;\r\n};\r\n","function generateUniqueId() {\r\n  return Math.random().toString(36).substring(7);\r\n}\r\n\r\nexport default generateUniqueId;\r\n","import Vue from 'vue';\r\nimport axios from 'axios';\r\nimport createStore from './store';\r\nimport configMixin from './util/config-mixin';\r\nimport Mapboard from './components/Mapboard.vue';\r\nimport mergeDeep from './util/merge-deep';\r\nimport generateUniqueId from './util/unique-id';\r\n\r\nimport philaVueDatafetch from '@cityofphiladelphia/phila-vue-datafetch';\r\nconst controllerMixin = philaVueDatafetch;\r\n\r\n// helper function to auto-assign ids to horizontal tables\r\nfunction assignTableIds(comps) {\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.components || options.tables;\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (innerComps) {\r\n      assignTableIds(innerComps);\r\n      // return;\r\n    }\r\n\r\n    // skip comps that aren't horizontal tables\r\n    if (comp.type !== 'horizontal-table') {\r\n      continue;\r\n    }\r\n\r\n     const id = generateUniqueId();\r\n     comp._id = id;\r\n     // the id also needs to get passed to the horizontal table component, so\r\n     // use the options object.\r\n     comp.options.tableId = id;\r\n  }\r\n}\r\n\r\nfunction assignHorizontalTableGroupIds(comps) {\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.tables;\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (!innerComps) {\r\n      continue;\r\n    }\r\n\r\n    // skip comps that aren't horizontal table groups\r\n    if (comp.type !== 'horizontal-table-group') {\r\n      continue;\r\n    }\r\n\r\n     const id = generateUniqueId();\r\n     comp._id = id;\r\n     // the id also needs to get passed to the horizontal table component, so\r\n     // use the options object.\r\n     comp.options.horizontalTableGroupId = id;\r\n  }\r\n}\r\n\r\nfunction initMapboard(clientConfig) {\r\n  const baseConfigUrl = clientConfig.baseConfig;\r\n\r\n  // get base config\r\n  return axios.get(baseConfigUrl).then(response => {\r\n    const data = response.data;\r\n\r\n    // parse raw js. yes, it's ok to use eval :)\r\n    // http://stackoverflow.com/a/87260/676001\r\n    const baseConfigFn = eval(data);\r\n    const { gatekeeperKey } = clientConfig;\r\n    const baseConfig = baseConfigFn({ gatekeeperKey });\r\n\r\n    // deep merge base config and client config\r\n    const config = mergeDeep(baseConfig, clientConfig);\r\n\r\n    // assign table ids\r\n    for (let topic of config.topics) {\r\n      assignTableIds(topic.components);\r\n      assignHorizontalTableGroupIds(topic.components);\r\n    }\r\n\r\n    // make config accessible from each component via this.$config\r\n    Vue.use(configMixin, config);\r\n\r\n    // create store\r\n    const store = createStore(config);\r\n\r\n    // mix in controller\r\n    Vue.use(controllerMixin, { config, store });\r\n    // Vue.use(controllerMixin, { config, store, eventBus });\r\n\r\n    // mount main vue\r\n    const vm = new Vue({\r\n      el: config.el || '#mapboard',\r\n      render: h => h(Mapboard),\r\n      store\r\n    });\r\n\r\n  }).catch(err => {\r\n    console.error('Error loading base config:', err);\r\n  });\r\n}\r\n\r\nexport default initMapboard;\r\n\r\n// also expose the vue component as a named export\r\nexport { Mapboard };\r\n"],"names":["const","let","Vue","latlng","key","color","markerType","this","props","AddressInput","AddressCandidateList","L.featureGroup","PngMarker"],"mappings":";;;;;;;;;;;;;EAAe,2BAAY;IACzBA,IAAM,oBAAoB,GAAG,qVAAqV,CAAC;IACnXA,IAAM,oBAAoB,GAAG,ykDAAykD,CAAC;;;IAGvmDA,IAAM,SAAS,IAAI,SAAS,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,IAAI,MAAM,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;IAClFA,IAAM,gBAAgB,IAAI,oBAAoB,CAAC,IAAI,CAAC,SAAS,CAAC;8BACpC,oBAAoB,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;IAE5E,OAAO,gBAAgB,CAAC;GACzB;;;ECLD,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;;;;EAId,SAAS,8BAA8B,CAAC,KAAU,EAAE;iCAAP,GAAG;;;;IAG9CC,IAAI,QAAQ,GAAG,EAAE,CAAC;;IAElB,KAAK,kBAAY,8BAAK,EAAE;MAAnBA,IAAI;;MACPD,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;MACnCA,IAAM,UAAU,GAAG,OAAO,CAAC,UAAU,IAAI,OAAO,CAAC,MAAM,CAAC;;;MAGxD,IAAI,UAAU,EAAE;QACdA,IAAM,aAAa,GAAG,8BAA8B,CAAC,UAAU,CAAC,CAAC;QACjE,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;QAC1C,SAAS;OACV;;;MAGD,IAAI,IAAI,CAAC,IAAI,KAAK,kBAAkB,EAAE;QACpC,SAAS;OACV;;MAEDA,IAAM,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;;MAEzB,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACxB;;IAED,OAAO,QAAQ,CAAC;GACjB;;;EAGD,SAAS,kBAAkB,CAAC,MAAM,EAAE;IAClCA,IAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;IAC7BC,IAAI,QAAQ,GAAG,EAAE,CAAC;;IAElB,KAAK,kBAAa,+BAAM,EAAE;MAArBA,IAAI;;MACPD,IAAM,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC;MAC/BA,IAAM,YAAY,GAAG,8BAA8B,CAAC,KAAK,CAAC,CAAC;MAC3D,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;KAC1C;;;;;;;;;IASDC,IAAI,YAAY,GAAG,GAAE;IACrB,KAAKA,IAAI,KAAK,CAAC,CAAC,EAAE,KAAK,GAAG,QAAQ,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;MAClD,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC;KACpC;;IAED,OAAO,YAAY,CAAC;GACrB;;;EAGD,SAAS,mCAAmC,CAAC,KAAU,EAAE;iCAAP,GAAG;;;IAEnDA,IAAI,YAAY,CAAC;;IAEjB,KAAK,kBAAY,8BAAK,EAAE;MAAnBA,IAAI;;MACPD,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;MACnCA,IAAM,UAAU,GAAG,OAAO,CAAC,UAAU,IAAI,OAAO,CAAC,MAAM,CAAC;;;;;MAKxD,IAAI,CAAC,UAAU,EAAE;QACf,SAAS;OACV;;;;;MAKD,IAAI,IAAI,CAAC,IAAI,KAAK,wBAAwB,EAAE;QAC1C,SAAS;OACV;;MAED,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC;;KAEzB;;IAED,OAAO,YAAY,CAAC;GACrB;;;EAGD,SAAS,2BAA2B,CAAC,MAAM,EAAE;IAC3CA,IAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;;IAE7BC,IAAI,aAAa,GAAG,EAAE,CAAC;;IAEvB,KAAK,kBAAa,+BAAM,EAAE;MAArBA,IAAI;;MACPD,IAAM,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC;MAC/BA,IAAM,gBAAgB,GAAG,mCAAmC,CAAC,KAAK,CAAC,CAAC;MACpE,IAAI,gBAAgB,IAAE,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAC;KAC5D;;;IAGDC,IAAI,qBAAqB,GAAG,EAAE,CAAC;;IAE/B,KAAK,sBAAoB,4CAAa,EAAE;MAAnCA,IAAI;;MACP,qBAAqB,CAAC,YAAY,CAAC,GAAG;QACpC,WAAW,EAAE,IAAI;QACjB,aAAa,EAAE,IAAI;OACpB,CAAC;KACH;IACD,OAAO,qBAAqB,CAAC;GAC9B;;EAED,SAAS,WAAW,CAAC,MAAM,EAAE;;IAE3BD,IAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,IAAI,EAAE,CAAC,CAAC;IACzDA,IAAM,OAAO,GAAG,UAAU,CAAC,MAAM,WAAE,CAAC,EAAE,GAAG,EAAE;MACzCC,IAAI,GAAG,CAAC;;MAER,IAAI,MAAM,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE;QACnC,GAAG,GAAG;UACJ,OAAO,EAAE,EAAE;SACZ,CAAC;OACH,MAAM;QACL,GAAG,GAAG;;;SAGL,MAAM,EAAE,IAAI;SACZ,eAAe,EAAE,IAAI;SACrB,IAAI,EAAE,IAAI;QACX,CAAC;OACF;;MAED,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;;MAEb,OAAO,CAAC,CAAC;KACV,EAAE,EAAE,CAAC,CAAC;;IAEPD,IAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC;IACrDA,IAAM,OAAO,GAAG,UAAU,CAAC,MAAM,WAAE,CAAC,EAAE,GAAG,EAAE;MACzCC,IAAI,GAAG,CAAC;MACR,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,eAAe,EAAE;QACvC,GAAG,GAAG;UACJ,IAAI,EAAE,EAAE;UACR,MAAM,EAAE,IAAI;UACZ,YAAY,EAAE,IAAI;UAClB,aAAa,EAAE,IAAI;UACnB,YAAY,EAAE,IAAI;SACnB,CAAC;OACH,MAAM;QACL,GAAG,GAAG,IAAI,CAAC;;;;;;;OAOZ;;MAED,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;;MAEb,OAAO,CAAC,CAAC;KACV,EAAE,EAAE,CAAC,CAAC;;IAEPD,IAAM,YAAY,GAAG;MACnB,gBAAgB,EAAE,cAAc,EAAE;MAClC,oBAAoB,EAAE,KAAK;;;;;MAK3B,WAAW,EAAE,EAAE;MACf,iBAAiB,EAAE,EAAE;;;MAGrB,WAAW,EAAE,IAAI;MACjB,OAAO,EAAE;QACP,MAAM,EAAE,IAAI;QACZ,IAAI,EAAE,IAAI;QACV,KAAK,EAAE,IAAI;QACX,OAAO,EAAE,IAAI;OACd;MACD,gBAAgB,EAAE,SAAS;;MAE3B,GAAG,EAAE;QACH,QAAQ,EAAE;UACR,GAAG,EAAE,IAAI;UACT,GAAG,EAAE,IAAI;SACV;QACD,MAAM,EAAE,MAAM,CAAC,GAAG,CAAC,MAAM;QACzB,MAAM,EAAE;UACN,SAAS,EAAE,IAAI;UACf,SAAS,EAAE,IAAI;SAChB;QACD,IAAI,EAAE,MAAM,CAAC,GAAG,CAAC,IAAI;QACrB,kBAAkB,EAAE,IAAI;QACxB,GAAG,EAAE,IAAI;;;;QAIT,OAAO,EAAE,EAAE;QACX,OAAO,EAAE,aAAa;QACtB,iBAAiB,EAAE,KAAK;;QAExB,YAAY,EAAE,IAAI;QAClB,mBAAmB,EAAE,IAAI;QACzB,OAAO,EAAE,EAAE;QACX,eAAe,EAAE,KAAK;OACvB;MACD,8BAA8B,EAAE,KAAK;MACrC,UAAU,EAAE,EAAE;MACd,cAAc,EAAE,IAAI;eACpB,OAAO;eACP,OAAO;MACP,UAAU,EAAE;QACV,WAAW,EAAE,KAAK;QAClB,UAAU,EAAE,KAAK;;QAEjB,aAAa,EAAE,IAAI;QACnB,WAAW,EAAE;UACX,GAAG,EAAE,IAAI;UACT,IAAI,EAAE,IAAI;UACV,GAAG,EAAE,IAAI;SACV;QACD,MAAM,EAAE,KAAK;QACb,UAAU,EAAE,EAAE;OACf;;MAED,UAAU,EAAE;QACV,GAAG,EAAE,IAAI;QACT,MAAM,EAAE,KAAK;QACb,QAAQ,EAAE,EAAE;QACZ,YAAY,EAAE,EAAE;QAChB,IAAI,EAAE,IAAI;;;;;QAKV,GAAG,EAAE;UACH,MAAM,EAAE,MAAM,CAAC,GAAG,CAAC,MAAM;UACzB,IAAI,EAAE,MAAM,CAAC,GAAG,CAAC,IAAI;SACtB;OACF;MACD,gBAAgB,EAAE;;QAEhB,YAAY,EAAE,kBAAkB,CAAC,MAAM,CAAC;OACzC;MACD,qBAAqB,EAAE,2BAA2B,CAAC,MAAM,CAAC;MAC1D,aAAa,EAAE;QACb,SAAS,EAAE,IAAI;QACf,OAAO,EAAE,IAAI;OACd;KACF,CAAC;;;IAGF,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC;MACpB,KAAK,EAAE,YAAY;MACnB,OAAO,EAAE;QACP,yCAAe,CAAC,KAAK,EAAE;;UAErBA,IAAM,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;;UAEtC,IAAI,CAAC,WAAW,EAAE;YAChB,OAAO,EAAE,CAAC;WACX;;;UAGDA,IAAM,iBAAiB,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,WAAC,OAAM,SAAG,KAAK,CAAC,GAAG,KAAK,cAAW,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC;UAC9FA,IAAM,KAAK,GAAG,iBAAiB,CAAC,UAAU,CAAC;;UAE3CA,IAAM,cAAc,GAAG,mCAAmC,CAAC,KAAK,CAAC,CAAC;UAClE,IAAI,cAAc,EAAE;;YAElBA,IAAM,KAAK,GAAG,EAAE,CAAC;YACjB,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,cAAc,CAAC,CAAC,aAAa,CAAC,CAAC;YACtE,OAAO,KAAK,CAAC;WACd,MAAM;YACLA,IAAM,UAAU,GAAG,8BAA8B,CAAC,KAAK,CAAC,CAAC;YACzD,OAAO,UAAU,CAAC;WACnB;SACF;OACF;MACD,SAAS,EAAE;QACT,2DAAwB,CAAC,KAAK,EAAE,OAAO,EAAE;UACvC,KAAK,CAAC,UAAU,CAAC,WAAW,GAAG,OAAO,CAAC;SACxC;QACD,iDAAmB,CAAC,KAAK,EAAE,OAAO,EAAE;UAClC,KAAK,CAAC,gBAAgB,GAAG,OAAO,CAAC;SAClC;QACD,yDAAuB,CAAC,KAAK,EAAE,OAAO,EAAE;UACtC,KAAK,CAAC,oBAAoB,GAAG,OAAO,CAAC;SACtC;QACD,iCAAW,CAAC,KAAK,EAAE,OAAO,EAAE;UAC1B,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;UACrC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;SACtC;QACD,+CAAkB,CAAC,KAAK,EAAE,OAAO,EAAE;UACjC,KAAK,CAAC,GAAG,CAAC,eAAe,GAAG,OAAO,CAAC;SACrC;QACD,uCAAc,CAAC,KAAK,EAAE,OAAO,EAAE;UAC7B,KAAK,CAAC,WAAW,GAAG,OAAO,CAAC;SAC7B;QACD,+EAAkC,CAAC,KAAK,EAAE,OAAO,EAAE;;UAEjD,KAAK,CAAC,qBAAqB,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;UACxF,KAAK,CAAC,qBAAqB,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;SACrF;QACD,uEAA8B,CAAC,KAAK,EAAE,OAAO,EAAE;UAC7C;UAAiB,wBAAiB;;;UAGlC,IAAI,CAAC,OAAO,IAAE,SAAO;;UAErB,KAAK,CAAC,gBAAgB,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC;SACrD;QACD,uCAAc,CAAC,KAAK,EAAE,OAAO,EAAE;UAC7B,KAAK,CAAC,WAAW,GAAG,OAAO,CAAC;SAC7B;QACD,mDAAoB,CAAC,KAAK,EAAE,OAAO,EAAE;UACnC,KAAK,CAAC,iBAAiB,GAAG,OAAO,CAAC;SACnC;QACD,yCAAe,CAAC,KAAK,EAAE,OAAO,EAAE;UAC9BA,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;UACxBA,IAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;;;UAG9BA,IAAM,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;;UAElC,IAAI,QAAQ,EAAE;;YAEZ,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC;WACtD,MAAM;YACL,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC;WACpC;SACF;QACD,2DAAwB,CAAC,KAAK,EAAE,OAAO,EAAE;UACvCA,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;UACxBA,IAAM,eAAe,GAAG,OAAO,CAAC,eAAe,CAAC;;;UAGhDA,IAAM,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;;;;;UAKlC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,eAAe,GAAG,eAAe,CAAC;;SAEtD;QACD,qCAAa,CAAC,KAAK,EAAE,OAAO,EAAE;;UAE5BA,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;UACxBA,IAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;;;UAG1BA,IAAM,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;;UAElC,IAAI,QAAQ,EAAE;YACZ,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;cACxC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC;aAClD;WACF,MAAM;YACL,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC;WAChC;SACF;QACD,6CAAiB,CAAC,KAAK,EAAE,OAAO,EAAE;UAChCA,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;UACxBA,IAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;UAC1BA,IAAM,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC;UAC9BA,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;;UAExCA,IAAM,OAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;;;;;;;;;UASvD,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;UAC3C,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC;;SAEzC;QACD,qCAAa,CAAC,KAAK,EAAE,OAAO,EAAE;UAC5B,KAAK,CAAC,GAAG,CAAC,OAAO,GAAG,OAAO,CAAC;SAC7B;;QAED,2DAAwB,CAAC,KAAK,EAAE,OAAO,EAAE;UACvC;UAAY,kCAAqB;UACjC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,SAAS,CAAC,MAAM,WAAE,GAAG,EAAE,QAAQ,EAAE;YAC5D,GAAG,CAAC,QAAQ,CAAC,GAAG;cACd,MAAM,EAAE,IAAI;cACZ,IAAI,EAAE,IAAI;aACX,CAAC;YACF,OAAO,GAAG,CAAC;WACZ,EAAE,EAAE,CAAC,CAAC;SACR;QACD,+CAAkB,CAAC,KAAK,EAAE,OAAO,EAAE;UACjCA,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;UACxB,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC;SACjC;QACD,uBAAM,CAAC,KAAK,EAAE,OAAO,EAAE;UACrB,KAAK,CAAC,GAAG,CAAC,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;SAC7B;;QAED,mCAAY,CAAC,KAAK,EAAE,OAAO,EAAE;UAC3B,KAAK,CAAC,GAAG,CAAC,MAAM,GAAG,OAAO,CAAC;SAC5B;QACD,+BAAU,CAAC,KAAK,EAAE,OAAO,EAAE;UACzB,KAAK,CAAC,GAAG,CAAC,IAAI,GAAG,OAAO,CAAC;SAC1B;QACD,mCAAY,CAAC,KAAK,EAAE,OAAO,EAAE;;;;UAI3B,KAAK,CAAC,GAAG,CAAC,MAAM,GAAG,OAAO,CAAC;SAC5B;QACD,2DAAwB,CAAC,KAAK,EAAE,OAAO,EAAE;UACvC,KAAK,CAAC,GAAG,CAAC,kBAAkB,GAAG,QAAO;SACvC;QACD,qCAAa,CAAC,KAAK,EAAE,OAAO,EAAE;;UAE5B,OAA+F,GAAG,OAAO,IAAI;UAArG;UAAa;UAAM;UAAiB;UAAQ;UAAc;UAAe,oCAA+B;;UAEhH,IAAI,CAAC,eAAe,EAAE;YACpB,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC;WACnC,MAAM;YACL,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC;YACvC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC;YAC3C,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,YAAY,GAAG,YAAY,CAAC;YACvD,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,aAAa,GAAG,aAAa,CAAC;YACzD,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,YAAY,GAAG,YAAY,CAAC;WACxD;SACF;QACD,yCAAe,CAAC,KAAK,EAAE,OAAO,EAAE;;UAE9B,OAAgE,GAAG,OAAO,IAAI;UAAtE;UAAa;UAAc;UAAe,oCAA+B;UACjF,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,YAAY,GAAG,YAAY,CAAC;UACvD,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,aAAa,GAAG,aAAa,CAAC;UACzD,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,YAAY,GAAG,YAAY,CAAC;SACxD;;;;;;;;;;;;;;;;;;;;;;;;;QAyBD,2CAAgB,CAAC,KAAK,EAAE,OAAO,EAAE;UAC/B,KAAK,CAAC,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC;SAChC;QACD,uCAAc,CAAC,KAAK,EAAE,OAAO,EAAE;UAC7B,KAAK,CAAC,OAAO,CAAC,IAAI,GAAG,OAAO,CAAC;SAC9B;QACD,6CAAiB,CAAC,KAAK,EAAE,OAAO,EAAE;UAChC,KAAK,CAAC,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC;SACjC;QACD,yCAAe,CAAC,KAAK,EAAE,OAAO,EAAE;UAC9B,KAAK,CAAC,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC;SAC/B;QACD,+BAAU,CAAC,KAAK,EAAE,OAAO,EAAE;UACzB,KAAK,CAAC,GAAG,CAAC,OAAO,GAAG,OAAO,CAAC;SAC7B;QACD,+BAAU,CAAC,KAAK,EAAE,OAAO,EAAE;UACzB,KAAK,CAAC,GAAG,CAAC,OAAO,GAAG,OAAO,CAAC;SAC7B;QACD,mDAAoB,CAAC,KAAK,EAAE,OAAO,EAAE;UACnC,KAAK,CAAC,GAAG,CAAC,iBAAiB,GAAG,OAAO,CAAC;SACvC;QACD,iDAAmB,CAAC,KAAK,EAAE,OAAO,EAAE;UAClC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE;YAC9B,OAAO;WACR;UACD,KAAK,CAAC,UAAU,CAAC,MAAM,GAAG,OAAO,CAAC;SACnC;QACD,iDAAmB,CAAC,KAAK,EAAE,OAAO,EAAE;UAClC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,EAAE;YAC9B,OAAO;WACR;UACD,KAAK,CAAC,UAAU,CAAC,MAAM,GAAG,OAAO,CAAC;SACnC;QACD,2CAAgB,CAAC,KAAK,EAAE,OAAO,EAAE;UAC/B,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,GAAG,QAAO;SAC3C;QACD,6CAAiB,CAAC,KAAK,EAAE,OAAO,EAAE;UAChC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,GAAG,QAAO;SAC5C;QACD,2CAAgB,CAAC,KAAK,EAAE,OAAO,EAAE;UAC/B,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,GAAG,QAAO;SAC3C;QACD,yDAAuB,CAAC,KAAK,EAAE,OAAO,EAAE;UACtC,KAAK,CAAC,UAAU,CAAC,UAAU,GAAG,OAAO,CAAC;SACvC;QACD,+DAA0B,CAAC,KAAK,EAAE,OAAO,EAAE;UACzC,KAAK,CAAC,UAAU,CAAC,aAAa,GAAG,OAAO,CAAC;;;;SAI1C;QACD,yDAAuB,CAAC,KAAK,EAAE,OAAO,EAAE;UACtC,KAAK,CAAC,UAAU,CAAC,UAAU,GAAG,OAAO,CAAC;SACvC;;;;QAID,2CAAgB,CAAC,KAAK,EAAE,OAAO,EAAE;;UAE/B,OAA4B,GAAG,OAAO,IAAI;UAAlC;UAAW,0BAA0B;UAC7CA,IAAM,iBAAiB,GAAG,aAAE,SAAS,WAAE,OAAO,EAAE,CAAC;UACjD,KAAK,CAAC,aAAa,GAAG,iBAAiB,CAAC;SACzC;QACD,iDAAmB,CAAC,KAAK,EAAE,OAAO,EAAE;UAClC,KAAK,CAAC,gBAAgB,GAAG,OAAO,CAAC;SAClC;QACD,2CAAgB,CAAC,KAAK,EAAE,OAAO,EAAE;UAC/B,KAAK,CAAC,UAAU,CAAC,GAAG,GAAG,OAAO,CAAC;SAChC;QACD,qDAAqB,CAAC,KAAK,EAAE,OAAO,EAAE;UACpC,KAAK,CAAC,UAAU,CAAC,QAAQ,GAAG,OAAO,CAAC;SACrC;QACD,6DAAyB,CAAC,KAAK,EAAE,OAAO,EAAE;UACxC,KAAK,CAAC,UAAU,CAAC,YAAY,GAAG,OAAO,CAAC;SACzC;;QAED,uDAAsB,CAAC,KAAK,EAAE,OAAO,EAAE;UACrC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,GAAG,OAAO,CAAC;SACvC;QACD,mDAAoB,CAAC,KAAK,EAAE,OAAO,EAAE;UACnC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,GAAG,OAAO,CAAC;SACrC;QACD,6CAAiB,CAAC,KAAK,EAAE,OAAO,EAAE;UAChC,KAAK,CAAC,UAAU,CAAC,IAAI,GAAG,OAAO,CAAC;SACjC;QACD,yCAAe,CAAC,KAAK,EAAE,OAAO,EAAE;UAC9B,KAAK,CAAC,GAAG,CAAC,YAAY,GAAG,OAAO,CAAC;SAClC;QACD,uDAAsB,CAAC,KAAK,EAAE,OAAO,EAAE;UACrC,KAAK,CAAC,GAAG,CAAC,mBAAmB,GAAG,OAAO,CAAC;SACzC;;;;QAID,6EAAiC,CAAC,KAAK,EAAE,OAAO,EAAE;UAChD,KAAK,CAAC,8BAA8B,GAAG,OAAO,CAAC;SAChD;QACD,qCAAa,CAAC,KAAK,EAAE,OAAO,EAAE;UAC5B,KAAK,CAAC,UAAU,GAAG,OAAO,CAAC;SAC5B;QACD,6CAAiB,CAAC,KAAK,EAAE,OAAO,EAAE;UAChC,KAAK,CAAC,cAAc,GAAG,OAAO,CAAC;SAChC;OACF;KACF,CAAC,CAAC;GACJ;;EC/jBD;;;AAGA,wBAAgBE,MAAG,EAAE,MAAM,EAAE;IAC3BA,MAAG,CAAC,KAAK,CAAC;MACR,yBAAO,GAAG;QACR,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;OACvB;KACF,CAAC,CAAC;GACJ;;ECTD;EAoCAF,IAAM,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC;EAClCA,IAAM,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;EACxCA,IAAM,YAAY,GAAG,aAAa,CAAC,YAAY,CAAC;EAChDA,IAAM,oBAAoB,GAAG,aAAa,CAAC,oBAAoB,CAAC;;AAEhE,mBAAe,CAAC;IACd,UAAU,EAAE;gBACV,QAAQ;aACR,KAAK;oBACL,YAAY;4BACZ,oBAAoB;KACrB;IACD,mBAAI,GAAG;MACLA,IAAM,IAAI,GAAG;QACX,WAAW,EAAE;UACX,YAAY,EAAE,MAAM;UACpB,QAAQ,EAAE,OAAO;SAClB;OACF,CAAC;MACF,OAAO,IAAI,CAAC;KACb;IACD,yBAAO,GAAG;MACR,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;MAC3D,IAAI,CAAC,kBAAkB,EAAE,CAAC;KAC3B;;;;IAID,QAAQ,EAAE;MACR,uDAAsB,GAAG;QACvB,IAAI,IAAI,CAAC,OAAO,CAAC,oBAAoB,IAAI,QAAQ,EAAE;UACjD,OAAO,IAAI,CAAC;SACb,MAAM;UACL,OAAO,KAAK,CAAC;SACd;OACF;MACD,+DAA0B,GAAG;;QAE3B,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,mBAAmB,KAAK,IAAI,EAAE;UAC1D,OAAO,IAAI,CAAC;SACb,MAAM;UACL,OAAO,KAAK,CAAC;SACd;OACF;MACD,mDAAoB,GAAG;QACrB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,oBAAoB,CAAC;OAC/C;MACD,2DAAwB,GAAG;QACzB,IAAI,IAAI,CAAC,oBAAoB,EAAE;UAC7B,OAAO,4CAA4C;SACpD,MAAM;UACL,OAAO,6CAA6C;SACrD;OACF;MACD,yBAAO,GAAG;QACR,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC;OACvC;MACD,+BAAU,GAAG;QACX,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;OACtD;MACD,+CAAkB,GAAG;QACnB,OAAO,EAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC;OAC3C;;MAED,yBAAO,GAAG;QACRA,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7BA,IAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;QACtDA,IAAM,gBAAgB,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC;QACrEC,IAAI,OAAO,CAAC;;QAEZ,IAAI,OAAO,EAAE;;;UAGXD,IAAM,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,cAAc,CAAC;UACnDA,IAAM,QAAQ,GAAG,OAAO,CAAC,cAAc,CAAC;;UAExC,OAAO,GAAG,QAAQ,IAAI,QAAQ,CAAC;;;SAGhC,MAAM,IAAI,gBAAgB,EAAE;UAC3B,OAAO,GAAG,gBAAgB,CAAC;SAC5B;;QAED,OAAO,OAAO,CAAC;OAChB;MACD,yBAAO,GAAG;QACRA,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7B,IAAI,CAAC,OAAO,IAAE,OAAO,IAAI,GAAC;QAC1BA,IAAM,OAAO,GAAG,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC;QAC5CA,IAAM,IAAI,GAAG,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC;QACtCA,IAAM,KAAK,GAAG,CAAC,OAAO,CAAC,CAAC;QACxB,IAAI,IAAI,IAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,GAAC;QAC3B,OAAO,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;OACxB;KACF;IACD,OAAO,EAAE;MACP,yCAAe,CAAC,KAAK,EAAE;QACrBA,IAAM,eAAe,GAAG,KAAK,CAAC,WAAW,IAAI,EAAE,CAAC;;;QAGhD,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;UAChC,OAAO,IAAI,CAAC;SACb;;QAEDA,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;QAC1C,OAAO,eAAe,CAAC,KAAK,WAAC,KAAI,SAAG,OAAO,CAAC,GAAG,CAAC,CAAC,OAAI,CAAC;OACvD;MACD,+CAAkB,GAAG;;QAEnB,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,IAAI,GAAG,EAAE;;UAE5BA,IAAM,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;UACvDA,IAAM,SAAS,GAAG,MAAM,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;UACvDA,IAAM,UAAU,GAAG,SAAS,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;UACxDA,IAAM,aAAa,GAAG,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC;UAC7DA,IAAM,YAAY,GAAG,aAAa,GAAG,GAAG,CAAC;UACzC,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,YAAY,CAAC,QAAQ,EAAE,GAAG,IAAI,CAAC;UACzD,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,GAAG,MAAM,CAAC;SACzC,MAAM;;UAEL,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,MAAM,CAAC;UACjC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,GAAG,QAAQ,CAAC;SAC3C;OACF;KACF;GACF,CAAC;;ACjKF,qBAAe;IACb,KAAK,EAAE;MACL,qCAAa,CAAC,iBAAiB,EAAE,iBAAiB,EAAE;;;QAGlDA,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC;QACnDA,IAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;;QAEvCC,IAAI,iBAAiB;YACjB,iBAAiB;YACjB,OAAO;YACP,aAAa;YACb,aAAa;YACb,iBAAiB;YACjB,iBAAiB,CAAC;;QAEtB,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,OAAO,IAAI,iBAAiB,CAAC,SAAS,EAAE;UACjF,iBAAiB,GAAG,iBAAiB,CAAC;UACtC,OAAO,GAAG,iBAAiB,CAAC,QAAO;UACnC,aAAa,GAAG,iBAAiB,CAAC,SAAS,CAAC;UAC5C,iBAAiB,GAAG,MAAM,CAAC,MAAM,WAAC,OAAM;YACtCD,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,EAAE,CAAC;YACpCA,IAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;YAC1B,IAAI,CAAC,IAAI,IAAE,SAAO;YAClBA,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC;YACtCA,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC;YAClC,OAAO,cAAc,KAAK,aAAa,IAAI,YAAY,KAAK,OAAO,CAAC;WACrE,CAAC,CAAC,CAAC,CAAC,CAAC;UACN,IAAI,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,CAAC;SAC/C;;QAED,IAAI,iBAAiB,IAAI,iBAAiB,CAAC,OAAO,IAAI,iBAAiB,CAAC,SAAS,EAAE;UACjF,iBAAiB,GAAG,iBAAiB,CAAC;UACtC,OAAO,GAAG,iBAAiB,CAAC,QAAO;UACnC,aAAa,GAAG,iBAAiB,CAAC,SAAS,CAAC;UAC5C,iBAAiB,GAAG,MAAM,CAAC,MAAM,WAAC,OAAM;YACtCA,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,EAAE,CAAC;YACpCA,IAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;YAC1B,IAAI,CAAC,IAAI,IAAE,SAAO;YAClBA,IAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC;YACtCA,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC;YAClC,OAAO,cAAc,KAAK,aAAa,IAAI,YAAY,KAAK,OAAO,CAAC;WACrE,CAAC,CAAC,CAAC,CAAC,CAAC;UACN,IAAI,CAAC,qBAAqB,CAAC,iBAAiB,CAAC,CAAC;UAC9C,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,CAAC;SAC5C;;OAEF;KACF;IACD,QAAQ,EAAE;MACR,uCAAc,GAAG;QACfA,IAAM,WAAW,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAC;QAC5FA,IAAM,MAAM,GAAG;UACb,MAAM,EAAE,WAAW;UACnB,MAAM,EAAE,CAAC;UACT,SAAS,EAAE,SAAS;UACpB,KAAK,EAAE,SAAS;UAChB,MAAM,EAAE,CAAC;UACT,OAAO,EAAE,CAAC;UACV,WAAW,EAAE,GAAG;UACjB;QACD,OAAO,MAAM,CAAC;OACf;;;MAGD,yBAAO,GAAG;QACRA,IAAM,OAAO,GAAG,EAAE,CAAC;;;QAGnBA,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QACrC,IAAI,IAAI,CAAC,eAAe,KAAK,gBAAgB,IAAI,WAAW,EAAE;UAC5DA,IAAM,MAAM,GAAG,WAAI,WAAW,CAAC,WAAW,EAAC,CAAC,OAAO,EAAE,CAAC;UACtDA,IAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,cAAc,CAAC;UACzDA,IAAM,KAAK,GAAG,SAAS,CAAC;UACxBA,IAAM,UAAU,GAAG,SAAS,CAAC;UAC7BA,IAAM,aAAa,GAAG,SAAC,MAAM,OAAE,GAAG,SAAE,KAAK,cAAE,UAAU,CAAC,CAAC;UACvD,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;SAC7B;;;QAGDA,IAAM,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC;;QAElD,IAAI,WAAW,EAAE;UACfA,IAAM,UAAU,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC;UACvCC,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;UACrC,KAAK,kBAAa,mCAAU,EAAE;YAAzBA,IAAI;;YACP,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;YAC5C,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,KAAK,SAAS,EAAE;cACvC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;aACpB;WACF;UACD,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,KAAK,SAAS,EAAE;YACvCD,IAAMG,QAAM,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC;YAC9DH,IAAMI,KAAG,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YAClCJ,IAAMK,OAAK,GAAG,WAAW,CAAC,KAAK,IAAI,OAAO,CAAC;YAC3CL,IAAMM,YAAU,GAAG,SAAS,CAAC;YAC7BN,IAAM,YAAY,GAAG,SAACG,QAAM,OAAEC,KAAG,SAAEC,OAAK,cAAEC,YAAU,CAAC,CAAC;YACtD,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;WAC5B;SACF;;QAED,OAAO,OAAO,CAAC;OAChB;MACD,qCAAa,GAAG;;;QACdN,IAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,YAAY,CAAC;;QAErEC,IAAI,aAAa,GAAG,EAAE,CAAC;;;QAGvBD,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,eAAe,CAAC;;;;QAIrD,KAAK,sBAAe,uCAAQ,EAAE;UAAzBC,IAAI;;UACPD,IAAM,WAAW,GAAGO,MAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;;UAE1DP,IAAM,UAAU,GAAG,CAAC,WAAW,CAAC,OAAO,IAAI,EAAE,EAAE,UAAU,CAAC;;UAE1D,IAAI,CAAC,UAAU,IAAI,UAAU,CAAC,MAAM,KAAK,QAAQ,EAAE;YACjD,SAAS;WACV;;UAEDA,IAAM,KAAK,GAAG,YAAY,CAAC,OAAO,CAAC,CAAC;;UAEpC,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACpB,SAAS;WACV;;UAEDA,IAAM,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;;;UAG/B,KAAK,kBAAY,8BAAK,EAAE;;YAAnBC,IAAI;;YAEPA,IAAI,iBAAM,CAAC;;;YAGX,IAAI,IAAI,CAAC,QAAQ,EAAE;cACjB,OAAY,GAAG,IAAI,CAAC,QAAQ,CAAC;cAAtB;cAAG,eAA+B;cACzC,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;aACjB,MAAM,IAAI,IAAI,CAAC,GAAG,EAAE;cACnB,MAAM,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,EAAC;;;;;;aAM9B;;;YAGDA,IAAI,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;YACrC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;YACtB,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC;YAClC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;YACxB,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;WAC3B;SACF;;QAED,OAAO,aAAa,CAAC;OACtB;;;;MAID,yCAAe,GAAG;QAChBD,IAAM,QAAQ,GAAG,EAAE,CAAC;;QAEpBA,IAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QAC7CA,IAAM,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC;;;;QAIjD,IAAI,eAAe,KAAK,YAAY,IAAI,iBAAiB,KAAK,KAAK,IAAI,IAAI,CAAC,SAAS,EAAE;UACrFC,IAAI,KAAK,GAAG,EAAE,CAAC;UACf,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC;UAC/B,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;UACrB,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC;UACzB,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;UACjB,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC;UAClB,KAAK,CAAC,WAAW,GAAG,GAAG,CAAC;UACxB,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC;UAC9C,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;;SAGtB,MAAM,IAAI,eAAe,KAAK,YAAY,IAAI,iBAAiB,KAAK,KAAK,EAAE;UAE1ED,IAAM,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,WAAC,WAAU;YACtDC,IAAI,KAAK,GAAG,EAAE,CAAC;YACf,KAAK,CAAC,OAAO,GAAG,SAAS,CAAC;YAC1B,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;YACrB,KAAK,CAAC,SAAS,GAAG,MAAM,CAAC;YACzB,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;YACjB,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC;YAClB,KAAK,CAAC,WAAW,GAAG,GAAG,CAAC;YACxB,KAAK,CAAC,GAAG,GAAG,SAAS,CAAC,UAAU,CAAC,QAAQ,CAAC;YAC1C,OAAO,KAAK,CAAC;WACd,CAAC,CAAC;UACH,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;SAClD;;;QAGDD,IAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC;QACpD,IAAI,YAAY,EAAE;UAChB,OAAO,CAAC,GAAG,CAAC,sBAAsB,EAAE,YAAY,CAAC,CAAC;UAClDA,IAAM,WAAW,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;UACzCC,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;UACrC,KAAK,kBAAa,oCAAW,EAAE;YAA1BA,IAAI;;YACP,IAAI,IAAI,KAAK,IAAI,EAAE;cACjB,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;aACpB;WACF;UACD,IAAI,IAAI,KAAK,IAAI,EAAE;YACjB,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;YAC3B,KAAK,sBAAe,mCAAI,EAAE;cAArBA,IAAI;;cACPA,IAAIO,OAAK,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,YAAY,CAAC,KAAK,CAAC,CAAC;cAClDA,OAAK,CAAC,GAAG,GAAG,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;cACtCA,OAAK,CAAC,OAAO,GAAG,QAAO;cACvB,QAAQ,CAAC,IAAI,CAACA,OAAK,CAAC,CAAC;aACtB;WACF;SACF;QACD,OAAO,QAAQ,CAAC;OACjB;;;;MAID,yDAAuB,GAAG;;;QACxBR,IAAM,QAAQ,GAAG,EAAE,CAAC;;QAEpBA,IAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,YAAY,CAAC;;QAErEA,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,eAAe,CAAC;;QAErD,KAAK,sBAAe,uCAAQ,EAAE;UAAzBC,IAAI;;UACPD,IAAM,WAAW,GAAGO,MAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;UAC1DP,IAAM,UAAU,GAAG,CAAC,WAAW,CAAC,OAAO,IAAI,EAAE,EAAE,UAAU,CAAC;;UAE1D,IAAI,CAAC,UAAU,IAAI,UAAU,CAAC,MAAM,KAAK,SAAS,EAAE;YAClD,SAAS;WACV;;UAEDA,IAAM,KAAK,GAAG,YAAY,CAAC,OAAO,CAAC,CAAC;;UAEpC,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACpB,SAAS;WACV;;UAEDA,IAAM,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;UAC/B,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;;UAGpB,KAAK,kBAAY,8BAAK,EAAE;YAAnBC,IAAI;;YACPA,IAAI,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;;YAErC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC9B,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC;YACpB,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC;YAC1C,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;YACtC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;WACtB;SACF;QACD,OAAO,QAAQ,CAAC;OACjB;;MAED,uCAAc,GAAG;QACfD,IAAM,OAAO,GAAG,EAAE,CAAC;;QAEnB,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAC1C,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;;QAElD,OAAO,OAAO,CAAC;OAChB;KACF;IACD,OAAO,EAAE;MACP,6CAAiB,CAAC,KAAK,EAAE,OAAO,EAAE;QAChCA,IAAM,aAAa,GAAG,KAAK,CAAC,MAAM,WAAC,MAAK;UACtC;YACE,IAAI,CAAC,IAAI,KAAK,kBAAkB;YAChC,IAAI,CAAC,GAAG,IAAI,OAAO;YACnB;SACH,CAAC,IAAI,EAAE,CAAC;QACT,OAAO,aAAa,CAAC,CAAC,CAAC,CAAC;OACzB;MACD,6CAAiB,CAAC,OAAO,EAAE;;;QACzBA,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,EAAE,CAAC;;QAEzC,KAAK,sBAAa,qCAAM,EAAE;UAArBC,IAAI;;UACPD,IAAM,KAAK,GAAG,KAAK,CAAC,UAAU,IAAI,EAAE,CAAC;;;UAGrCA,IAAM,KAAK,GAAGO,MAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;;UAErD,IAAI,KAAK,IAAE,OAAO,KAAK,GAAC;;;UAGxB,KAAK,kBAAY,8BAAK,EAAE;YAAnBN,IAAI;;YACPD,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;;YAEnCA,IAAM,UAAU,GAAG,OAAO,CAAC,UAAU,IAAI,OAAO,CAAC,MAAM,IAAI,EAAE,CAAC;;YAE9D,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;cACzBA,IAAM,UAAU,GAAGO,MAAI,CAAC,iBAAiB,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;;;cAG/D,IAAI,UAAU,IAAE,OAAO,UAAU,GAAC;aACnC;WACF;SACF;OACF;MACD,+CAAkB,CAAC,YAAY,EAAE;;QAE/BP,IAAM,EAAE,GAAG,YAAY,CAAC,KAAK,CAAC;;;QAG9BA,IAAM,KAAK,GAAG,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC;QAChD,KAAK,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;;;QAGtB,KAAK,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;OACvB;MACD,qDAAqB,CAAC,CAAC,EAAE;;QAEvB,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;;UAE1B,sBAAqB;UACrB,OAA4B,GAAG,MAAM,CAAC,OAAO,CAAC;UAAtC;UAAW,0BAAgC;;UAEnD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,kBAAkB,EAAE,aAAE,SAAS,WAAE,OAAO,EAAE,CAAC,CAAC;SAChE;OACF;MACD,6CAAiB,CAAC,CAAC,EAAE;;QAEnB,IAAI,IAAI,CAAC,gBAAgB,EAAE;;UAEzB,sBAAqB;UACrB,OAA4B,GAAG,MAAM,CAAC,OAAO,CAAC;UAAtC;UAAW,0BAAgC;;UAEnD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,kBAAkB,EAAE,aAAE,SAAS,WAAE,OAAO,EAAE,CAAC,CAAC;SAChE;OACF;MACD,mDAAoB,CAAC,CAAC,EAAE;;;;UAIpB,sBAAqB;UACrB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,kBAAkB,EAAE,IAAI,CAAC,CAAC;;OAEhD;MACD,qDAAqB,CAAC,MAAM,EAAE;;;QAG5B,OAA4B,GAAG,MAAM,CAAC,OAAO,CAAC;QAAtC;QAAW,0BAAgC;QACnDA,IAAM,aAAa,GAAG,IAAI,CAAC,wBAAwB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;;;;QAIxEA,IAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC;QACpD,SAAS,CAAC,SAAS,GAAG,aAAa,CAAC;QACpC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;OAC5B;KACF;GACF,CAAC;;ECvWF;EAuSAA,IAAM,eAAe,GAAG,eAAe,CAAC,eAAe,CAAC;EACxDA,IAAM,eAAe,GAAG,eAAe,CAAC,eAAe,CAAC;;;EAGxDA,IAAM,IAAI,GAAG,eAAe,CAAC,IAAI,CAAC;EAClCA,IAAM,OAAO,GAAG,eAAe,CAAC,OAAO,CAAC;EACxCA,IAAMS,cAAY,GAAG,eAAe,CAAC,YAAY,CAAC;EAClDT,IAAMU,sBAAoB,GAAG,eAAe,CAAC,oBAAoB,CAAC;EAClEV,IAAM,iBAAiB,GAAG,eAAe,CAAC,iBAAiB,CAAC;EAC5DA,IAAM,gBAAgB,GAAG,eAAe,CAAC,gBAAgB,CAAC;EAC1DA,IAAM,mBAAmB,GAAG,eAAe,CAAC,mBAAmB,CAAC;EAChEA,IAAM,gBAAgB,GAAG,eAAe,CAAC,gBAAgB,CAAC;EAC1DA,IAAM,OAAO,GAAG,eAAe,CAAC,OAAO,CAAC;EACxCA,IAAM,YAAY,GAAG,eAAe,CAAC,YAAY,CAAC;EAClDA,IAAM,aAAa,GAAG,eAAe,CAAC,aAAa,CAAC;EACpDA,IAAM,YAAY,GAAG,eAAe,CAAC,YAAY,CAAC;EAClDA,IAAM,SAAS,GAAG,eAAe,CAAC,SAAS,CAAC;EAC5CA,IAAM,oBAAoB,GAAG,eAAe,CAAC,oBAAoB,CAAC;EAClEA,IAAM,oBAAoB,GAAG,eAAe,CAAC,oBAAoB,CAAC;EAClEA,IAAM,sBAAsB,GAAG,eAAe,CAAC,sBAAsB,CAAC;EACtEA,IAAM,eAAe,GAAG,eAAe,CAAC,eAAe,CAAC;EACxDA,IAAM,gBAAgB,GAAG,eAAe,CAAC,gBAAgB,CAAC;EAC1DA,IAAM,gBAAgB,GAAG,eAAe,CAAC,gBAAgB,CAAC;EAC1DA,IAAM,yBAAyB,GAAG,eAAe,CAAC,yBAAyB,CAAC;EAC5EA,IAAM,0BAA0B,GAAG,eAAe,CAAC,0BAA0B,CAAC;EAC9EA,IAAM,iBAAiB,GAAG,eAAe,CAAC,iBAAiB,CAAC;EAC5DA,IAAM,cAAc,GAAG,eAAe,CAAC,cAAc,CAAC;EACtDA,IAAM,aAAa,GAAG,eAAe,CAAC,aAAa,CAAC;EACpDA,IAAM,cAAc,GAAG,eAAe,CAAC,cAAc,CAAC;EACtDA,IAAM,aAAa,GAAG,eAAe,CAAC,aAAa,CAAC;;AAEpD,iBAAe,CAAC;;iBAED;gBACD,CAAC,CAAC,CAAC,CAAC;kBACF;;iBAED;;;;IAIb,MAAM,EAAE;MACN,YAAY;MACZ,eAAe;MACf,eAAe,EAChB;IACD,UAAU;YACR,IAAI;eACJ,OAAO;oBACPS,cAAY;4BACZC;yBACA,iBAAiB;wBACjB,gBAAgB;2BAChB,mBAAmB;wBACnB,gBAAgB;eAChB,OAAO;oBACP,YAAY;qBACZ,aAAa;oBACb,YAAY;iBACZ,SAAS;4BACT;4BACA;8BACA;uBACA;wBACA;wBACA,gBAAgB;iCAChB,yBAAyB;yBACzB,iBAAiB;sBACjB,cAAc;qBACd;;qBAEA,aAAa;KACd;IACD,yBAAO,GAAG;;MAERV,IAAM,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC;MACpC,IAAI,cAAc,EAAE;QAClB,IAAI,CAAC,WAAW,CAAC,kBAAkB;OACpC;;MAEDA;MACA;;QAEE,IAAI,CAAC;UACH,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC;;UAExB,IAAI,CAAC;UACL,IAAI;SACL,CAAC;OACH;KACF;IACD,yBAAO,GAAG;;MAER;KACD;IACD,QAAQ,EAAE;MACR,uDAAsB,GAAG;QACvB,IAAI,IAAI,CAAC;UACP;SACD,MAAM;;;OAGR;MACD,+DAA0B,GAAG;;QAE3B,IAAI,IAAI;UACN,OAAO,IAAI,CAAC;SACb;;SAEA;OACF;MACD,mDAAoB;QAClB,IAAI,IAAI;UACN,OAAO,SAAS;SACjB;;SAEA;OACF;MACD;QACE,IAAI,IAAI,CAAC;UACP,OAAO,UAAU;SAClB,MAAM;UACL;SACD;OACF;MACD;QACE,OAAO,IAAI,CAAC,MAAM,CAAC;OACpB;MACD;QACE,IAAI,IAAI,CAAC,OAAO,CAAC;UACf,OAAO,KAAK,CAAC;SACd,MAAM;UACL,OAAO,IAAI,CAAC;SACb;OACF;MACD;QACE;OACD;MACD,uDAAsB,GAAG;;QAEvB,IAAI,IAAI,CAAC;UACP;SACD,MAAM;UACL,OAAO;SACR;OACF;MACD,iCAAW,GAAG;QACZ,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,KAAK,IAAI,EAAE;;UAEzD,OAAO,CAAC;SACT,MAAM;;UAEL,OAAO,MAAM,CAAC;SACf;OACF;MACD,+CAAkB,GAAG;QACnB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI,GAAG,CAAC;OAC5D;MACD,6BAAS,GAAG;QACV,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC;OACtD;MACD,2CAAgB,GAAG;QACjB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;OAC1B;MACD;QACE,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,IAAI,CAAC;OAC5C;MACD;QACE,OAAO,IAAI,CAAC;OACb;MACD;QACE,OAAO,IAAI,CAAC;OACb;MACD;;QAEE,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC;OACtC;MACD,uCAAc,GAAG;QACf,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc;OACnC;MACD,mCAAY,GAAG;QACb,OAAO,IAAI,CAAC;OACb;MACD;;QAEE;UACEA,IAAM;UACNA,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;UAChCA,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,kBAAkB;;UAE/C,OAAO;SACR,MAAM;UACL,OAAO,EAAE,CAAC;SACX;OACF;MACD,2CAAgB,GAAG;QACjB,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QACrC,OAAO,IAAI,CAAC;OACb;MACD,qCAAa;QACXA,IAAM,iBAAiB,GAAG,IAAI,CAAC,MAAM,CAAC;QACtC,IAAI,iBAAiB,EAAE;;SAEtB;QACDA;QACAA,IAAM,OAAO,GAAG,IAAI,CAAC;QACrB,OAAO,OAAO,CAAC;OAChB;MACD;QACEA,IAAM,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;QACzCA;;QAEA,OAAO;OACR;MACD;QACE,IAAI,CAAC;UACH,OAAO,EAAE,CAAC;SACX;;SAEA;OACF;MACD;QACE,IAAI,CAAC;UACH,OAAO,EAAE,CAAC;SACX;;SAEA;OACF;MACD;QACE,IAAI,CAAC,IAAI,CAAC;UACR,OAAO,EAAE,CAAC;;UAEV,OAAO,IAAI,CAAC;SACb;OACF;MACD,qCAAa,GAAG;QACd,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,CAAC;OACxC;MACD,2BAAQ,GAAG;QACT,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;OACjD;MACD,yCAAe,GAAG;QAChB,OAAO,IAAI,CAAC;OACb;MACD,+CAAkB,GAAG;QACnB,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;OACxC;MACD;QACE,OAAO,IAAI,CAAC;OACb;MACD;QACEC;QACA,IAAI,IAAI,CAAC,WAAW;;SAEnB,MAAM,IAAI;UACT,aAAa,GAAG,IAAI,CAAC;;UAErB,IAAI,IAAI,CAAC,OAAO;YACd,aAAa,GAAG,IAAI,CAAC;WACtB;;QAEH,OAAO,aAAa,CAAC;OACtB;MACD,iCAAW,GAAG;QACZ,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;OAC1B;MACD;;QAEEA,IAAI,MAAM,CAAC;;;QAGX,IAAI,GAAG,EAAE;;YAEL,OAAO;WACR,CAAC,CAAC,CAAC,CAAC,CAAC;;;QAGR,OAAO,MAAM,IAAI,EAAE,CAAC;OACrB;MACD,6CAAiB;QACf,OAAO,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC;OACvC;MACD,+BAAU,GAAG;QACX,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;OAClC;MACD,6BAAS,GAAG;QACV,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC;OACtC;MACD,qCAAa,GAAG;QACd,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,IAAI,EAAE,CAAC;OAC7C;MACD,iCAAW,GAAG;QACZ,OAAO,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC;OACpC;MACD;QACE,OAAO,IAAI,CAAC;OACb;MACD;QACE,OAAO,IAAI;OACZ;MACD;QACE,IAAI,IAAI,CAAC;UACP,OAAO,IAAI,CAAC;;UAEZ,OAAO;SACR;OACF;MACD;;OAEC;MACD,+CAAkB,GAAG;QACnB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC;OAC9B;MACD;QACE,OAAO,IAAI,CAAC;OACb;KACF;IACD,KAAK,EAAE;MACL,2CAAgB,CAAC,KAAK,EAAE;;;QACtB;;SAEC,EAAC;OACH;MACD,yCAAe,GAAG;QAChB,IAAI,CAAC,cAAc,EAAE;OACtB;MACD,yBAAO,GAAG;QACR,IAAI,CAAC,cAAc,EAAE,CAAC;OACvB;KACF;IACD,OAAO;MACL,uCAAc,GAAG;;;;QAEfA,IAAI,YAAY,GAAG,GAAE;QACrB,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE;UACtC,IAAI;YACF;;;;aAEC;WACF;UACD,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC;;;;;gBAGjC,YAAY,CAAC,IAAI;eAClB;;WAEJ;UACDD,IAAM,KAAK,GAAG,IAAIW,cAAc,CAAC,YAAY;UAC7CX,IAAM,MAAM;UACZ,IAAI,CAAC;SACN;OACF;MACD;QACE,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;OACzB;MACD;QACE,IAAI,IAAI,CAAC,iBAAiB,CAAC,OAAO;UAChC,OAAO,IAAI,CAAC;SACb,MAAM;UACL,OAAO,GAAG,KAAK,IAAI,CAAC,eAAe,CAAC;SACrC;OACF;MACD;QACE,OAAO,GAAG;OACX;MACD;QACE,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;UAC1C,IAAI,OAAO,EAAE;YACX,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC;;;SAGhC;QACD,OAAO,KAAK,CAAC;;MAEf,uCAAc,CAAC,CAAC,EAAE;;;QAGhB,IAAI,CAAC,WAAW,CAAC;OAClB;;MAED,qCAAa,CAAC,CAAC,EAAE;QACfA,IAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;;;;QAI9BA,IAAM,MAAM,GAAG,GAAG,CAAC,SAAS,EAAE,CAAC;QAC/B;;;;;;UAKE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;;UAEnBA,IAAM,IAAI,GAAG,GAAG,CAAC,OAAO,EAAE,CAAC;;;;QAI7BA,IAAM,gBAAgB,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU;;QAEhD,IAAI,gBAAgB,CAAC,OAAO,EAAE;;;UAG5B,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;SACpB;OACF;MACD,2DAAwB,CAAC,QAAQ,EAAE,OAAO;;QAExCA;QACAA,IAAM,UAAU,GAAG,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC;;;;;QAIlDA,IAAM;QACNA,IAAM;;;;;;;;;;;ECpsBZ;;EAoDAA,IAAM,gBAAgB,GAAG,eAAe,CAAC,gBAAgB,CAAC;EAC1DA,IAAM,gBAAgB,GAAG,eAAe,CAAC,gBAAgB,CAAC;EAC1DA,IAAM,KAAK,GAAG,eAAe,CAAC,eAAe,CAAC;EAC9CA,IAAM,QAAQ,GAAG,eAAe,CAAC,kBAAkB,CAAC;EACpDA,IAAMY,WAAS,GAAG,eAAe,CAAC,mBAAmB,CAAC;;AAEtD,iBAAe,CAAC;IACd,UAAU,EAAE;kBACV,UAAU;gBACV,QAAQ;wBACR,gBAAgB;wBAChB,gBAAgB;aAChB,KAAK;iBACLA,WAAS;gBACT,QAAQ;KACT;IACD,mBAAI,GAAG;MACLZ,IAAM,IAAI,GAAG;;QAEX,WAAW,EAAE;UACX,QAAQ,EAAE,OAAO;SAClB;OACF,CAAC;MACF,OAAO,IAAI,CAAC;KACb;IACD,yBAAO,GAAG;MACR,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,yBAAyB,CAAC,CAAC;MACjE,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;MAC3D,IAAI,CAAC,kBAAkB,EAAE,CAAC;KAC3B;IACD,QAAQ,EAAE;MACR,6BAAS,GAAG;QACV,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;UACvB,OAAO,QAAQ,CAAC;SACjB,MAAM;UACL,OAAO,yBAAyB,CAAC;SAClC;OACF;MACD,2CAAgB,GAAG;QACjB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC;OAC3C;MACD,+DAA0B,GAAG;QAC3B,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC;OAClE;MACD,+DAA0B,GAAG;QAC3B,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC;OAClE;MACD,mDAAoB,GAAG;QACrB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,oBAAoB,CAAC;OAC/C;MACD,mDAAoB,GAAG;QACrBC,IAAI,KAAK,GAAG,kBAAkB,CAAC;QAC/B,IAAI,IAAI,CAAC,oBAAoB,EAAE;UAC7B,KAAK,GAAG,mBAAmB,CAAC;SAC7B;QACD,OAAO,KAAK,CAAC;OACd;MACD,2CAAgB,GAAG;QACjB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM;OAC3C;MACD,iCAAW,GAAG;QACZ,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,KAAK,IAAI,EAAE;UACzDD,IAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,CAAC;UACzD,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;SACzB,MAAM;UACLA,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC;UACvC,OAAO,MAAM,CAAC;SACf;OACF;MACD,+CAAkB,GAAG;QACnB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI,GAAG,CAAC,aAAa,CAAC,CAAC;OAC3E;MACD,6BAAS,GAAG;QACV,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC;OACtD;MACD,2CAAgB,GAAG;QACjB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM;OAC3C;MACD,uCAAc,GAAG;QACf,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI;OACzC;MACD,iEAA2B,GAAG;QAC5B,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;UAC/C,OAAO,KAAK,CAAC;SACd,MAAM,IAAI,IAAI,CAAC,cAAc,GAAG,EAAE,IAAI,IAAI,CAAC,gBAAgB,EAAE;UAC5D,OAAO,KAAK,CAAC;SACd,MAAM;UACL,OAAO,IAAI,CAAC;SACb;OACF;MACD,iCAAW,GAAG;QACZ,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI;OACtC;MACD,eAAE,GAAG;QACHA,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;QACtC,IAAI,IAAI,KAAK,iBAAiB,EAAE;UAC9B,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,CAAC;SACvC;QACD,IAAI,IAAI,KAAK,qBAAqB,EAAE;UAClC,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC;SAC1C;QACD,IAAI,IAAI,KAAK,qBAAqB,EAAE;UAClC,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,MAAM,CAAC;SAC3C;QACD,IAAI,IAAI,KAAK,yBAAyB,EAAE;UACtC,OAAO,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,MAAM,CAAC;SAC9C;QACD,IAAI,IAAI,KAAK,aAAa,EAAE;UAC1B,OAAO,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,MAAM,CAAC;SAC5C;OACF;MACD,eAAE,GAAG;QACHA,IAAM,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;QACtC,IAAI,IAAI,KAAK,iBAAiB,EAAE;UAC9B,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC;SAC1C;QACD,IAAI,IAAI,KAAK,qBAAqB,EAAE;UAClC,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC;SAC7C;QACD,IAAI,IAAI,KAAK,qBAAqB,EAAE;UAClC,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC;SAC9C;QACD,IAAI,IAAI,KAAK,yBAAyB,EAAE;UACtC,OAAO,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC;SACjD;QACD,IAAI,IAAI,KAAK,aAAa,EAAE;UAC1B,OAAO,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,SAAS,CAAC;SAC/C;OACF;KACF;IACD,KAAK,EAAE;MACL,iEAA2B,CAAC,SAAS,EAAE;QACrC,OAAO,CAAC,GAAG,CAAC,mCAAmC,EAAE,SAAS,CAAC,CAAC;OAC7D;KACF;IACD,OAAO,EAAE;MACP,6DAAyB,GAAG;QAC1B,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,8BAA8B,GAAG,KAAK,CAAC;OAC9D;MACD,+CAAkB,GAAG;;QAEnB,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,KAAK,EAAE,IAAI,GAAG,EAAE;UAC5B,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,QAAO;SAClC,MAAM;UACL,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,MAAM,CAAC;SAClC;OACF;KACF;GACF,CAAC;;ECxMF;;;AAGA,EAAO,SAAS,QAAQ,CAAC,IAAI,EAAE;IAC7B,QAAQ,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,KAAK,IAAI,EAAE;GACpF;;AAGD,EAAe,SAAS,SAAS,CAAC,MAAM,EAAE,MAAM,EAAE;IAChDC,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;IACvC,IAAI,QAAQ,CAAC,MAAM,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE;MACxC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,WAAC,KAAI;;;QAC9B,IAAI,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE;UACzB,IAAI,EAAE,GAAG,IAAI,MAAM,CAAC;cAClB,MAAM,CAAC,MAAM,CAAC,MAAM,UAAE,EAAC,KAAC,CAAC,GAAG,CAAC,GAAE,MAAM,CAAC,GAAG,CAAC,OAAG,GAAC;;cAE9C,MAAM,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,GAAC;SACrD,MAAM;UACL,MAAM,CAAC,MAAM,CAAC,MAAM,YAAE,EAAC,OAAC,CAAC,GAAG,CAAC,GAAE,MAAM,CAAC,GAAG,CAAC,SAAG,CAAC;SAC/C;OACF,CAAC,CAAC;KACJ;IACD,OAAO,MAAM,CAAC;GACf;;ECvBD,SAAS,gBAAgB,GAAG;IAC1B,OAAO,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;GAChD;;ECODD,IAAM,eAAe,GAAG,iBAAiB,CAAC;;;EAG1C,SAAS,cAAc,CAAC,KAAK,EAAE;IAC7B,KAAK,kBAAY,8BAAK,EAAE;MAAnBC,IAAI;;MACPD,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;MACnCA,IAAM,UAAU,GAAG,OAAO,CAAC,UAAU,IAAI,OAAO,CAAC,MAAM,CAAC;;;MAGxD,IAAI,UAAU,EAAE;QACd,cAAc,CAAC,UAAU,CAAC,CAAC;;OAE5B;;;MAGD,IAAI,IAAI,CAAC,IAAI,KAAK,kBAAkB,EAAE;QACpC,SAAS;OACV;;OAEAA,IAAM,EAAE,GAAG,gBAAgB,EAAE,CAAC;OAC9B,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;;;OAGd,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,EAAE,CAAC;KAC5B;GACF;;EAED,SAAS,6BAA6B,CAAC,KAAK,EAAE;IAC5C,KAAK,kBAAY,8BAAK,EAAE;MAAnBC,IAAI;;MACPD,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC;MACnCA,IAAM,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC;;;MAGlC,IAAI,CAAC,UAAU,EAAE;QACf,SAAS;OACV;;;MAGD,IAAI,IAAI,CAAC,IAAI,KAAK,wBAAwB,EAAE;QAC1C,SAAS;OACV;;OAEAA,IAAM,EAAE,GAAG,gBAAgB,EAAE,CAAC;OAC9B,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;;;OAGd,IAAI,CAAC,OAAO,CAAC,sBAAsB,GAAG,EAAE,CAAC;KAC3C;GACF;;EAED,SAAS,YAAY,CAAC,YAAY,EAAE;IAClCA,IAAM,aAAa,GAAG,YAAY,CAAC,UAAU,CAAC;;;IAG9C,OAAO,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,IAAI,WAAC,UAAS;MAC5CA,IAAM,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC;;;;MAI3BA,IAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;MAChC,+CAAuC;MACvCA,IAAM,UAAU,GAAG,YAAY,CAAC,iBAAE,aAAa,EAAE,CAAC,CAAC;;;MAGnDA,IAAM,MAAM,GAAG,SAAS,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC;;;MAGnD,KAAK,kBAAa,MAAM,CAAC,+BAAM,EAAE;QAA5BC,IAAI;;QACP,cAAc,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QACjC,6BAA6B,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;OACjD;;;MAGD,GAAG,CAAC,GAAG,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;;;MAG7BD,IAAM,KAAK,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC;;;MAGlC,GAAG,CAAC,GAAG,CAAC,eAAe,EAAE,UAAE,MAAM,SAAE,KAAK,EAAE,CAAC,CAAC;;;;MAI5CA,IAAM,EAAE,GAAG,IAAI,GAAG,CAAC;QACjB,EAAE,EAAE,MAAM,CAAC,EAAE,IAAI,WAAW;QAC5B,MAAM,YAAE,GAAE,SAAG,CAAC,CAAC,QAAQ,IAAC;eACxB,KAAK;OACN,CAAC,CAAC;;KAEJ,CAAC,CAAC,KAAK,WAAC,KAAI;MACX,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,GAAG,CAAC,CAAC;KAClD,CAAC,CAAC;GACJ;;;;;;;;;;;;;"}
=======
{"version":3,"file":"mapboard.js","sources":["../src/util/is-mobile-device.js","../src/store.js","../src/util/config-mixin.js","../src/components/TopicPanel.vue","../src/components/markers-mixin.js","../src/components/MapPanel.vue","../src/components/Mapboard.vue","../src/util/merge-deep.js","../src/util/unique-id.js","../src/main.js"],"sourcesContent":["export default function () {\r\n  const mobileOrTabletRegexA = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i;\r\n  const mobileOrTabletRegexB = /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i;\r\n\r\n  // get the user agent and test against both regex patterns\r\n  const userAgent = (navigator.userAgent || navigator.vendor || window.opera || '');\r\n  const isMobileOrTablet = (mobileOrTabletRegexA.test(userAgent) ||\r\n                            mobileOrTabletRegexB.test(userAgent.substr(0,4)));\r\n\r\n  return isMobileOrTablet;\r\n};\r\n","import Vue from 'vue';\r\nimport Vuex from 'vuex';\r\nimport isMobileDevice from './util/is-mobile-device';\r\n\r\n// when you load vuex from a script tag this seems to happen automatically\r\nVue.use(Vuex);\r\n\r\n// this grabs horizontal table ids from an array of topic components,\r\n// recursively\r\nfunction getHorizontalTableIdsFromComps(comps = []) {\r\n  // console.log('getHorizontalTableIdsFromComps is running, comps:', comps);\r\n\r\n  let tableIds = [];\r\n\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.components || options.tables;\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (innerComps) {\r\n      const innerTableIds = getHorizontalTableIdsFromComps(innerComps);\r\n      tableIds = tableIds.concat(innerTableIds);\r\n      continue;\r\n    }\r\n\r\n    // skip comps that aren't horizontal tables\r\n    if (comp.type !== 'horizontal-table') {\r\n      continue;\r\n    }\r\n\r\n    const tableId = comp._id;\r\n\r\n    tableIds.push(tableId);\r\n  }\r\n\r\n  return tableIds;\r\n}\r\n\r\n// this makes the empty filtered data object given a list of topics.\r\nfunction createFilteredData(config) {\r\n  const topics = config.topics;\r\n  let tableIds = [];\r\n\r\n  for (let topic of topics) {\r\n    const comps = topic.components;\r\n    const compTableIds = getHorizontalTableIdsFromComps(comps);\r\n    tableIds = tableIds.concat(compTableIds);\r\n  }\r\n\r\n  // console.log('createFilteredData is running, tableIds:', tableIds);\r\n\r\n  // const filteredData = tableIds.reduce((acc, tableId) => {\r\n  //   acc[tableId] = [];\r\n  //   return acc;\r\n  // }, {});\r\n\r\n  let filteredData = {}\r\n  for (let index=0; index < tableIds.length; index++) {\r\n    filteredData[tableIds[index]] = [];\r\n  }\r\n\r\n  return filteredData;\r\n}\r\n\r\n// this grabs table group ids from an array of topic components\r\nfunction getHorizontalTableGroupIdsFromComps(comps = []) {\r\n  // console.log('getHorizontalTableGroupIdsFromComps is running, comps:', comps);\r\n  let tableGroupId;\r\n\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.components || options.tables;\r\n\r\n    // console.log('getHorizontalTableGroupIdsFromComps, comp:', comp);\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (!innerComps) {\r\n      continue;\r\n    }\r\n\r\n    // console.log('getTableGroupIdsFromComps, comp.type:', comp.type);\r\n\r\n    // skip comps that aren't horizontal tables\r\n    if (comp.type !== 'horizontal-table-group') {\r\n      continue;\r\n    }\r\n\r\n    tableGroupId = comp._id;\r\n    // console.log('getHorizontalTableGroupIdsFromComps, tableGroupId:', tableGroupId);\r\n  }\r\n\r\n  return tableGroupId;\r\n}\r\n\r\n// this makes the empty horizontalTableGroups object given a list of topics.\r\nfunction createHorizontalTableGroups(config) {\r\n  const topics = config.topics;\r\n\r\n  let tableGroupIds = [];\r\n\r\n  for (let topic of topics) {\r\n    const comps = topic.components;\r\n    const compTableGroupId = getHorizontalTableGroupIdsFromComps(comps);\r\n    if (compTableGroupId) tableGroupIds.push(compTableGroupId);\r\n  }\r\n  // console.log('createHorizontalTableGroups is running, config:', config, 'tableGroupIds:', tableGroupIds);\r\n\r\n  let horizontalTableGroups = {};\r\n\r\n  for (let tableGroupId of tableGroupIds) {\r\n    horizontalTableGroups[tableGroupId] = {\r\n      activeTable: null,\r\n      activeTableId: null\r\n    };\r\n  }\r\n  return horizontalTableGroups;\r\n}\r\n\r\nfunction createStore(config) {\r\n  // create initial state for sources. data key => {}\r\n  const sourceKeys = Object.keys(config.dataSources || {});\r\n  const sources = sourceKeys.reduce((o, key) => {\r\n    let val;\r\n    // if the source has targets, just set it to be an empty object\r\n    if (config.dataSources[key].targets) {\r\n      val = {\r\n        targets: {}\r\n      };\r\n    } else {\r\n      val = {\r\n       // we have to define these here, because vue can't observe properties that\r\n       // are added later.\r\n       status: null,\r\n       secondaryStatus: null,\r\n       data: null\r\n     };\r\n    }\r\n\r\n    o[key] = val;\r\n\r\n    return o;\r\n  }, {});\r\n\r\n  const parcelKeys = Object.keys(config.parcels || {});\r\n  const parcels = parcelKeys.reduce((o, key) => {\r\n    let val;\r\n    if (config.parcels[key].multipleAllowed) {\r\n      val = {\r\n        data: [],\r\n        status: null,\r\n        activeParcel: null,\r\n        activeAddress: null,\r\n        activeMapreg: null\r\n      };\r\n    } else {\r\n      val = null;\r\n      // val = {\r\n      //   geometry: null,\r\n      //   id: null,\r\n      //   properties: null,\r\n      //   type: null\r\n      // };\r\n    }\r\n\r\n    o[key] = val;\r\n\r\n    return o;\r\n  }, {});\r\n\r\n  const initialState = {\r\n    isMobileOrTablet: isMobileDevice(),\r\n    fullScreen: {\r\n      mapOnly: false,\r\n      topicsOnly: false,\r\n    },\r\n    fullScreenMapEnabled: false,\r\n    fullScreenTopicsEnabled: false,\r\n\r\n    // this gets set to the parcel layer for the default (aka first) topic in\r\n    // DataManager.resetGeocode, which is called by Router.hashChanged on app\r\n    // load.\r\n    activeTopic: '',\r\n    activeParcelLayer: '',\r\n\r\n    // the ais feature\r\n    clickCoords: null,\r\n    geocode: {\r\n      status: null,\r\n      data: null,\r\n      input: null,\r\n      related: null,\r\n    },\r\n    lastSearchMethod: 'geocode',\r\n    // the leaflet map object\r\n    map: {\r\n      location: {\r\n        lat: null,\r\n        lng: null\r\n      },\r\n      center: config.map.center,\r\n      bounds: {\r\n        northEast: null,\r\n        southWest: null,\r\n      },\r\n      zoom: config.map.zoom,\r\n      boundsBasedOnShape: null,\r\n      map: null,\r\n      // this gets set to the parcel layer for the default topic by\r\n      // DataManager.resetGeocode; see note above for activeTopic and\r\n      // activeParcelLayer.\r\n      basemap: '',\r\n      imagery: 'imagery2017',\r\n      shouldShowImagery: false,\r\n      // this is the key for the active overlay image (eg regmap)\r\n      imageOverlay: null,\r\n      imageOverlayOpacity: null,\r\n      filters: [],\r\n      watchPositionOn: false,\r\n    },\r\n    shouldShowAddressCandidateList: false,\r\n    candidates: [],\r\n    addressEntered: null,\r\n    parcels,\r\n    sources,\r\n    cyclomedia: {\r\n      initialized: false,\r\n      navBarOpen: false,\r\n      // surfaceCursorOn: true,\r\n      latLngFromMap: null,\r\n      orientation: {\r\n        yaw: null,\r\n        hFov: null,\r\n        xyz: null,\r\n      },\r\n      active: false,\r\n      recordings: [],\r\n    },\r\n    // we need this to know whether or not to force an update on the first show\r\n    pictometry: {\r\n      ipa: null,\r\n      active: false,\r\n      shapeIds: [],\r\n      pngMarkerIds: [],\r\n      zoom: null,\r\n      // this is the state of the main leaflet map. when these values change\r\n      // the pictometry widget should react. the reason these are duplicated\r\n      // here is to avoid an infinite loop in the Map component when the\r\n      // viewport changes.\r\n      map: {\r\n        center: config.map.center,\r\n        zoom: config.map.zoom\r\n      }\r\n    },\r\n    horizontalTables: {\r\n      // table id => filtered rows\r\n      filteredData: createFilteredData(config),\r\n    },\r\n    horizontalTableGroups: createHorizontalTableGroups(config),\r\n    activeFeature: {\r\n      featureId: null,\r\n      tableId: null\r\n    },\r\n\r\n    appData: {\r\n      propertyBalance: 0,\r\n    },\r\n  };\r\n\r\n  // TODO standardize how payloads are passed around/handled\r\n  return new Vuex.Store({\r\n    state: initialState,\r\n    getters: {\r\n      visibleTableIds(state) {\r\n        // get active topic\r\n        const activeTopic = state.activeTopic;\r\n\r\n        if (!activeTopic) {\r\n          return [];\r\n        }\r\n\r\n        // get horizontal table ids for that topic\r\n        const activeTopicConfig = (config.topics.filter(topic => topic.key === activeTopic) || [])[0];\r\n        const comps = activeTopicConfig.components;\r\n\r\n        const compTableGroup = getHorizontalTableGroupIdsFromComps(comps);\r\n        if (compTableGroup) {\r\n          // even though there is only 1 value, it has to be in array form in the state\r\n          const array = [];\r\n          array.push(state.horizontalTableGroups[compTableGroup].activeTableId);\r\n          return array;\r\n        } else {\r\n          const compTables = getHorizontalTableIdsFromComps(comps);\r\n          return compTables;\r\n        }\r\n      }\r\n    },\r\n    mutations: {\r\n      setCyclomediaInitialized(state, payload) {\r\n        state.cyclomedia.initialized = payload;\r\n      },\r\n      setIsMobileOrTablet(state, payload) {\r\n        state.isMobileOrTablet = payload;\r\n      },\r\n      setMapOnly(state, payload) {\r\n        state.fullScreen.mapOnly = payload;\r\n      },\r\n      setTopicsOnly(state, payload) {\r\n        state.fullScreen.topicsOnly = payload;\r\n      },\r\n      setFullScreenMapEnabled(state, payload) {\r\n        state.fullScreenMapEnabled = payload;\r\n      },\r\n      setFullScreenTopicsEnabled(state, payload) {\r\n        state.fullScreenTopicsEnabled = payload;\r\n      },\r\n      setLocation(state, payload) {\r\n        state.map.location.lat = payload.lat;\r\n        state.map.location.lng = payload.lng;\r\n      },\r\n      setWatchPositionOn(state, payload) {\r\n        state.map.watchPositionOn = payload;\r\n      },\r\n      setClickCoords(state, payload) {\r\n        state.clickCoords = payload;\r\n      },\r\n      setHorizontalTableGroupActiveTable(state, payload) {\r\n        // console.log('setHorizontalTableGroupActiveTable, payload:', payload);\r\n        state.horizontalTableGroups[payload.tableGroupId].activeTableId = payload.activeTableId;\r\n        state.horizontalTableGroups[payload.tableGroupId].activeTable = payload.activeTable;\r\n      },\r\n      setHorizontalTableFilteredData(state, payload) {\r\n        const { tableId, data } = payload;\r\n\r\n        // check for not-null table id\r\n        if (!tableId) return;\r\n\r\n        state.horizontalTables.filteredData[tableId] = data;\r\n      },\r\n      setActiveTopic(state, payload) {\r\n        state.activeTopic = payload;\r\n      },\r\n      setActiveParcelLayer(state, payload) {\r\n        state.activeParcelLayer = payload;\r\n      },\r\n      setSourceStatus(state, payload) {\r\n        const key = payload.key;\r\n        const status = payload.status;\r\n\r\n        // if a target id was passed in, set the status for that target\r\n        const targetId = payload.targetId;\r\n\r\n        if (targetId) {\r\n          // console.log('store.js setSourceStatus, key:', key, 'status:', status, 'targetId:', targetId);\r\n          state.sources[key].targets[targetId].status = status;\r\n        } else {\r\n          state.sources[key].status = status;\r\n        }\r\n      },\r\n      setSecondarySourceStatus(state, payload) {\r\n        const key = payload.key;\r\n        const secondaryStatus = payload.secondaryStatus;\r\n\r\n        // if a target id was passed in, set the status for that target\r\n        const targetId = payload.targetId;\r\n\r\n        // if (targetId) {\r\n        //   state.sources[key].targets[targetId].status = status;\r\n        // } else {\r\n        state.sources[key].secondaryStatus = secondaryStatus;\r\n        // }\r\n      },\r\n      setSourceData(state, payload) {\r\n        // console.log('store setSourceData payload:', payload);\r\n        const key = payload.key;\r\n        const data = payload.data;\r\n\r\n        // if a target id was passed in, set the data object for that target\r\n        const targetId = payload.targetId;\r\n\r\n        if (targetId) {\r\n          if (state.sources[key].targets[targetId]) {\r\n            state.sources[key].targets[targetId].data = data;\r\n          }\r\n        } else {\r\n          state.sources[key].data = data;\r\n        }\r\n      },\r\n      setSourceDataMore(state, payload) {\r\n        const key = payload.key;\r\n        const data = payload.data;\r\n        const nextPage = payload.page;\r\n        const oldData = state.sources[key].data;\r\n        // console.log('oldData features', oldData.features, 'data features', data.features);\r\n        const allData = oldData.features.concat(data.features);\r\n        // console.log('allData', allData);\r\n        // if a target id was passed in, set the data object for that target\r\n        // const targetId = payload.targetId;\r\n\r\n        // if (targetId) {\r\n        //   state.sources[key].targets[targetId].data = data;\r\n        // } else {\r\n\r\n        state.sources[key].data.features = allData;\r\n        state.sources[key].data.page = nextPage;\r\n        // }\r\n      },\r\n      setMapFilters(state, payload) {\r\n        state.map.filters = payload;\r\n      },\r\n      // this sets empty targets for a data source\r\n      createEmptySourceTargets(state, payload) {\r\n        const {key, targetIds} = payload;\r\n        state.sources[key].targets = targetIds.reduce((acc, targetId) => {\r\n          acc[targetId] = {\r\n            status: null,\r\n            data: null\r\n          };\r\n          return acc;\r\n        }, {});\r\n      },\r\n      clearSourceTargets(state, payload) {\r\n        const key = payload.key;\r\n        state.sources[key].targets = {};\r\n      },\r\n      setMap(state, payload) {\r\n        state.map.map = payload.map;\r\n      },\r\n      // this is the map center as an xy coordinate array (not latlng)\r\n      setMapCenter(state, payload) {\r\n        state.map.center = payload;\r\n      },\r\n      setMapZoom(state, payload) {\r\n        state.map.zoom = payload;\r\n      },\r\n      setMapBounds(state, payload) {\r\n        // const { northEast, southWest } = payload || {};\r\n        // state.map.bounds.northEast = northEast;\r\n        // state.map.bounds.southWest = southWest;\r\n        state.map.bounds = payload;\r\n      },\r\n      setMapBoundsBasedOnShape(state, payload) {\r\n        state.map.boundsBasedOnShape = payload\r\n      },\r\n      setParcelData(state, payload) {\r\n        // console.log('store setParcelData payload:', payload);\r\n        const { parcelLayer, data, multipleAllowed, status, activeParcel, activeAddress, activeMapreg } = payload || {};\r\n        // console.log('store setParcelData parcelLayer:', parcelLayer, 'data:', data, 'multipleAllowed:', multipleAllowed, 'status:', status, 'activeParcel:', activeParcel);\r\n        if (!multipleAllowed) {\r\n          state.parcels[parcelLayer] = data;\r\n        } else {\r\n          state.parcels[parcelLayer].data = data;\r\n          state.parcels[parcelLayer].status = status;\r\n          state.parcels[parcelLayer].activeParcel = activeParcel;\r\n          state.parcels[parcelLayer].activeAddress = activeAddress;\r\n          state.parcels[parcelLayer].activeMapreg = activeMapreg;\r\n        }\r\n      },\r\n      setActiveParcel(state, payload) {\r\n        // console.log('store setActiveParcel:', payload)\r\n        const { parcelLayer, activeParcel, activeAddress, activeMapreg } = payload || {};\r\n        state.parcels[parcelLayer].activeParcel = activeParcel;\r\n        state.parcels[parcelLayer].activeAddress = activeAddress;\r\n        state.parcels[parcelLayer].activeMapreg = activeMapreg;\r\n      },\r\n      // setDorParcelData(state, payload) {\r\n      //   state.dorParcels.data = payload;\r\n      //   // state.parcels.dor.data = payload;\r\n      // },\r\n      // setDorParcelStatus(state, payload) {\r\n      //   state.dorParcels.status = payload;\r\n      //   // state.parcels.dor.status = payload;\r\n      // },\r\n      // setActiveDorParcel(state, payload) {\r\n      //   state.activeDorParcel = payload;\r\n      //   // state.parcels.dor.activeParcel = payload;\r\n      // },\r\n      // setActiveDorAddress(state, payload) {\r\n      //   state.activeDorAddress = payload;\r\n      //   // state.parcels.dor.activeAddress = payload;\r\n      // },\r\n      // setActiveDorMapreg(state, payload) {\r\n      //   state.activeDorMapreg = payload;\r\n      //   // state.parcels.dor.activeMapreg = payload;\r\n      // },\r\n      // setPwdParcel(state, payload) {\r\n      //   state.pwdParcel = payload;\r\n      //   // state.parcels.pwd = payload;\r\n      // },\r\n      setGeocodeStatus(state, payload) {\r\n        state.geocode.status = payload;\r\n      },\r\n      setGeocodeData(state, payload) {\r\n        state.geocode.data = payload;\r\n      },\r\n      setGeocodeRelated(state, payload) {\r\n        state.geocode.related = payload;\r\n      },\r\n      setGeocodeInput(state, payload) {\r\n        state.geocode.input = payload;\r\n      },\r\n      setBasemap(state, payload) {\r\n        state.map.basemap = payload;\r\n      },\r\n      setImagery(state, payload) {\r\n        state.map.imagery = payload;\r\n      },\r\n      setShouldShowImagery(state, payload) {\r\n        state.map.shouldShowImagery = payload;\r\n      },\r\n      setPictometryActive(state, payload) {\r\n        if (!config.pictometry.enabled) {\r\n          return;\r\n        }\r\n        state.pictometry.active = payload;\r\n      },\r\n      setCyclomediaActive(state, payload) {\r\n        if (!config.cyclomedia.enabled) {\r\n          return;\r\n        }\r\n        state.cyclomedia.active = payload;\r\n      },\r\n      setCyclomediaYaw(state, payload) {\r\n        state.cyclomedia.orientation.yaw = payload\r\n      },\r\n      setCyclomediaHFov(state, payload) {\r\n        state.cyclomedia.orientation.hFov = payload\r\n      },\r\n      setCyclomediaXyz(state, payload) {\r\n        state.cyclomedia.orientation.xyz = payload\r\n      },\r\n      setCyclomediaRecordings(state, payload) {\r\n        state.cyclomedia.recordings = payload;\r\n      },\r\n      setCyclomediaLatLngFromMap(state, payload) {\r\n        state.cyclomedia.latLngFromMap = payload;\r\n        // const { lat, lng } = payload || {};\r\n        // state.cyclomedia.latLngFromMap[0] = lat;\r\n        // state.cyclomedia.latLngFromMap[1] = lng;\r\n      },\r\n      setCyclomediaNavBarOpen(state, payload) {\r\n        state.cyclomedia.navBarOpen = payload;\r\n      },\r\n      // setCyclomediaSurfaceCursorOn(state, payload) {\r\n      //   state.cyclomedia.surfaceCursorOn = payload;\r\n      // },\r\n      setActiveFeature(state, payload) {\r\n        // console.log('store setActiveFeature is running');\r\n        const { featureId, tableId } = payload || {};\r\n        const nextActiveFeature = { featureId, tableId };\r\n        state.activeFeature = nextActiveFeature;\r\n      },\r\n      setLastSearchMethod(state, payload) {\r\n        state.lastSearchMethod = payload;\r\n      },\r\n      setPictometryIpa(state, payload) {\r\n        state.pictometry.ipa = payload;\r\n      },\r\n      setPictometryShapeIds(state, payload) {\r\n        state.pictometry.shapeIds = payload;\r\n      },\r\n      setPictometryPngMarkerIds(state, payload) {\r\n        state.pictometry.pngMarkerIds = payload;\r\n      },\r\n      // this is the leaflet map center updated when the map is moved\r\n      setPictometryMapCenter(state, payload) {\r\n        state.pictometry.map.center = payload;\r\n      },\r\n      setPictometryMapZoom(state, payload) {\r\n        state.pictometry.map.zoom = payload;\r\n      },\r\n      setPictometryZoom(state, payload) {\r\n        state.pictometry.zoom = payload;\r\n      },\r\n      setImageOverlay(state, payload) {\r\n        state.map.imageOverlay = payload;\r\n      },\r\n      setImageOverlayOpacity(state, payload) {\r\n        state.map.imageOverlayOpacity = payload;\r\n      },\r\n      // setCircleMarkers(state, payload) {\r\n      //   state.map.circleMarkers.push(payload);\r\n      // }\r\n      setShouldShowAddressCandidateList(state, payload) {\r\n        state.shouldShowAddressCandidateList = payload;\r\n      },\r\n      setCandidates(state, payload) {\r\n        state.candidates = payload;\r\n      },\r\n      setAddressEntered(state, payload) {\r\n        state.addressEntered = payload;\r\n      },\r\n\r\n      setPropertyBalance(state, payload) {\r\n        state.appData.propertyBalance = payload;\r\n      },\r\n    }\r\n  });\r\n}\r\n\r\nexport default createStore;\r\n","// shout out to airyland\r\n// https://github.com/airyland/vue-config/blob/master/index.js\r\n\r\nexport default (Vue, config) => {\r\n  Vue.mixin({\r\n    created() {\r\n      this.$config = config;\r\n    }\r\n  });\r\n};\r\n","<template>\r\n  <div id=\"topic-panel-container\"\r\n       :class=\"'mb-panel-topics cell ' + this.topicPanelContainerClass\"\r\n  >\r\n    <full-screen-topics-toggle-tab v-once\r\n                                   v-if=\"!this.fullScreenTopicsOnly\"\r\n    />\r\n\r\n    <!-- <div v-if=\"!shouldShowGreeting\" class=\"topic-panel-content\"> -->\r\n\r\n    <!-- address header -->\r\n    <div class=\"address-header cell small-24 medium-24\"\r\n         v-if=\"this.fullScreenTopicsOnly\"\r\n    >\r\n\r\n      <div :class=\"'address-container columns ' +  this.addressContainerClass\"\r\n           :style=\"this.addressContainerStyle\"\r\n      >\r\n\r\n        <h1 class=\"address-header-line-1\">\r\n          <!-- <i class=\"fa fa-map-marker\"></i> -->\r\n          {{ address }}\r\n        </h1>\r\n        <div class=\"address-header-line-2\"\r\n             v-show=\"this.geocode\"\r\n        >\r\n          PHILADELPHIA, PA {{ zipCode }}\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"address-input-container columns small-24 medium-12 large-12\"\r\n           :style=\"this.addressInputContainerStyle\"\r\n           v-if=\"this.fullScreenTopicsEnabled || this.fullScreenTopicsOnly\"\r\n      >\r\n        <address-input :widthFromConfig=\"this.addressInputWidth\"\r\n                       :placeholder=\"this.addressInputPlaceholder\"\r\n        >\r\n          <address-candidate-list v-if=\"this.addressAutocompleteEnabled\"\r\n                                  slot=\"address-candidates-slot\"\r\n                                  :widthFromConfig=\"this.addressInputWidth\"\r\n          />\r\n        />\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- before search -->\r\n    <greeting v-show=\"shouldShowGreeting\" />\r\n\r\n    <div v-if=\"!shouldShowGreeting\" class=\"topic-panel-content\">\r\n\r\n      <div class=\"address-header cell small-24 medium-24\"\r\n           v-if=\"!this.fullScreenTopicsOnly\"\r\n      >\r\n\r\n        <div :class=\"'address-container columns ' +  this.addressContainerClass\"\r\n             :style=\"this.addressContainerStyle\"\r\n        >\r\n\r\n          <h1 class=\"address-header-line-1\">\r\n            <i class=\"fa fa-map-marker\"></i>\r\n            {{ address }}\r\n          </h1>\r\n          <div class=\"address-header-line-2\">PHILADELPHIA, PA {{ zipCode }}</div>\r\n        </div>\r\n\r\n        <div class=\"address-input-container columns small-24 medium-12 large-12\"\r\n             :style=\"this.addressInputContainerStyle\"\r\n             v-if=\"this.fullScreenTopicsEnabled || this.fullScreenTopicsOnly\"\r\n        >\r\n          <address-input :widthFromConfig=\"this.addressInputWidth\"\r\n                         :placeholder=\"this.addressInputPlaceholder\"\r\n          >\r\n            <address-candidate-list v-if=\"this.addressAutocompleteEnabled\"\r\n                                    slot=\"address-candidates-slot\"\r\n                                    :widthFromConfig=\"this.addressInputWidth\"\r\n            />\r\n          />\r\n        </div>\r\n\r\n      </div>\r\n\r\n\r\n      <!-- topics container -->\r\n      <!-- <div class=\"topics-container cell medium-cell-block-y\"\r\n           :style=\"topicsContainerStyle\"\r\n      >\r\n        <topic v-for=\"topic in this.$config.topics\"\r\n               :topicKey=\"topic.key\"\r\n               :key=\"topic.key\"\r\n        />\r\n      </div> -->\r\n      <div v-if=\"!shouldShowGreeting\"\r\n           class=\"topics-container cell medium-cell-block-y\"\r\n           :style=\"topicsContainerStyle\"\r\n      >\r\n        <topic-component-group :topic-components=\"this.$config.components\" />\r\n      </div>\r\n\r\n\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import philaVueComps from '@cityofphiladelphia/phila-vue-comps';\r\n  const Topic = philaVueComps.Topic;\r\n  const TopicComponentGroup = philaVueComps.TopicComponentGroup;\r\n  const Greeting = philaVueComps.Greeting;\r\n  const AddressInput = philaVueComps.AddressInput;\r\n  const AddressCandidateList = philaVueComps.AddressCandidateList;\r\n  const FullScreenTopicsToggleTab = philaVueComps.FullScreenTopicsToggleTab;\r\n\r\n\r\n  export default {\r\n    components: {\r\n      Greeting,\r\n      TopicComponentGroup,\r\n      Topic,\r\n      AddressInput,\r\n      AddressCandidateList,\r\n      FullScreenTopicsToggleTab,\r\n    },\r\n    data() {\r\n      const data = {\r\n        topicsContainerStyle: {\r\n          'overflow-y': 'auto',\r\n          'height': '100px',\r\n        },\r\n        addressContainerStyle: {\r\n          'height': '100%',\r\n          'padding-bottom:': '20px',\r\n        },\r\n        addressInputContainerStyle: {\r\n          'align-items': 'flex-start',\r\n          'height': '100%',\r\n          'padding-top': '20px',\r\n        }\r\n      };\r\n      return data;\r\n    },\r\n    mounted() {\r\n      window.addEventListener('click', this.closeAddressCandidateList);\r\n      window.addEventListener('resize', this.handleWindowResize);\r\n      this.handleWindowResize();\r\n    },\r\n    computed: {\r\n      inputAlign() {\r\n        if (this.$config.addressInput.position) {\r\n          const position = this.$config.addressInput.position;\r\n          switch(position) {\r\n            case 'left':\r\n              return 'flex-start';\r\n            case 'right':\r\n              return 'flex-end';\r\n            case 'center':\r\n              return 'center';\r\n          }\r\n        } else {\r\n          return 'flex-start';\r\n        }\r\n      },\r\n      addressInputWidth() {\r\n        return this.$config.addressInput.width;\r\n      },\r\n      addressInputPlaceholder() {\r\n        return this.$config.addressInput.placeholder;\r\n      },\r\n      addressAutocompleteEnabled() {\r\n        // TODO tidy up the code\r\n        if (this.$config.addressInput.autocompleteEnabled === true) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      fullScreenMapEnabled() {\r\n        return this.$store.state.fullScreenMapEnabled;\r\n      },\r\n      fullScreenTopicsEnabled() {\r\n        return this.$store.state.fullScreenTopicsEnabled;\r\n      },\r\n      fullScreenTopicsOnly() {\r\n        return this.$store.state.fullScreen.topicsOnly;\r\n      },\r\n      topicPanelContainerClass() {\r\n        if (this.fullScreenTopicsEnabled || this.fullScreenTopicsOnly) {\r\n          return 'medium-24 small-order-2 medium-order-1';\r\n        } else if (this.fullScreenMapEnabled) {\r\n          return 'medium-1 small-order-2 medium-order-1';\r\n        } else {\r\n          return 'medium-12 small-order-2 medium-order-1';\r\n        }\r\n      },\r\n      addressContainerClass() {\r\n        if (this.fullScreenTopicsEnabled || this.fullScreenTopicsOnly) {\r\n          return 'small-24 medium-12 large-12';\r\n        } else {\r\n          return 'small-24';\r\n        }\r\n      },\r\n      geocode() {\r\n        return this.$store.state.geocode.data;\r\n      },\r\n      dorParcels() {\r\n        return this.$store.state.parcels.dor.data.length > 0;\r\n      },\r\n      shouldShowGreeting() {\r\n        return !(this.geocode || this.dorParcels);\r\n      },\r\n      // this returns the address shown in the address header\r\n      address() {\r\n        const geocode = this.geocode;\r\n        const dorParcels = this.$store.state.parcels.dor.data;\r\n        const activeDorAddress = this.$store.state.parcels.dor.activeAddress;\r\n        let address;\r\n        if (this.$config.defaultAddressTextPlaceholder) {\r\n          address = this.$config.defaultAddressTextPlaceholder;\r\n        }\r\n\r\n        if (geocode) {\r\n          // TODO make this not ais-specific\r\n          // REVIEW what's the difference between these two?\r\n          const addressA = geocode.properties.street_address;\r\n          const addressB = geocode.street_address;\r\n\r\n          address = addressA || addressB;\r\n\r\n        // a DOR address might be found even if there is no geocode\r\n        } else if (activeDorAddress) {\r\n          address = activeDorAddress;\r\n        }\r\n\r\n        return address;\r\n      },\r\n      zipCode() {\r\n        const geocode = this.geocode;\r\n        if (!geocode) return null;\r\n        const zipCode = geocode.properties.zip_code;\r\n        const zip4 = geocode.properties.zip_4;\r\n        const parts = [zipCode];\r\n        if (zip4) parts.push(zip4);\r\n        return parts.join('-');\r\n      },\r\n    },\r\n    methods: {\r\n      closeAddressCandidateList() {\r\n        this.$store.state.shouldShowAddressCandidateList = false;\r\n      },\r\n      shouldShowTopic(topic) {\r\n        const requiredSources = topic.dataSources || [];\r\n\r\n        // if there aren't any required topics, show it\r\n        if (requiredSources.length === 0) {\r\n          return true;\r\n        }\r\n\r\n        const sources = this.$store.state.sources;\r\n        return requiredSources.every(key => sources[key].data)\r\n      },\r\n      handleWindowResize() {\r\n        if ($(window).width() >= 750) {\r\n          // console.log('handleWindowResize if is running, window width is >= 750px');\r\n          this.addressContainerStyle = {\r\n            'height': '100%',\r\n            'align-items': 'flex-start',\r\n            'padding-bottom': '20px',\r\n          }\r\n          this.addressInputContainerStyle = {\r\n            'height': '100%',\r\n            'align-items': this.inputAlign,\r\n            'padding-top': '25px',\r\n          }\r\n\r\n          const rootElement = document.getElementById('mb-root');\r\n          const rootStyle = window.getComputedStyle(rootElement);\r\n          const rootHeight = rootStyle.getPropertyValue('height');\r\n          const rootHeightNum = parseInt(rootHeight.replace('px', ''));\r\n          const topicsHeight = rootHeightNum - 103;\r\n\r\n          this.topicsContainerStyle.height = topicsHeight.toString() + 'px';\r\n          this.topicsContainerStyle['overflow-y'] = 'auto';\r\n\r\n\r\n        } else {\r\n          this.addressContainerStyle = {\r\n            'height': 'auto',\r\n            'align-items': 'center',\r\n            'padding-bottom': '20px',\r\n          }\r\n          this.addressInputContainerStyle = {\r\n            'height': 'auto',\r\n            'align-items': 'center',\r\n            'padding-top': '5px',\r\n          }\r\n          // console.log('handleWindowResize lse is running, window width is < 750px');\r\n          this.topicsContainerStyle.height = 'auto';\r\n          this.topicsContainerStyle['overflow-y'] = 'hidden';\r\n        }\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n  /*don't highlight any form elements*/\r\n  input:focus,\r\n  select:focus,\r\n  textarea:focus,\r\n  button:focus {\r\n    outline: none;\r\n  }\r\n\r\n  /* standards applies padding to buttons, which causes some weirdness with\r\n  buttons on the map panel. override here. */\r\n  button {\r\n    padding: inherit;\r\n  }\r\n\r\n  .mb-panel-topics {\r\n    position: relative;\r\n  }\r\n\r\n  .address-header {\r\n    background: #daedfe;\r\n    color: #0f4d90;\r\n\r\n    /*this keeps the box shadow over the scrollable part of the panel*/\r\n    position: relative;\r\n    z-index: 1;\r\n\r\n    -webkit-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18);\r\n    -moz-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18);\r\n    box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18);\r\n    margin-bottom: 0px !important;\r\n    display: inline-block;\r\n  }\r\n\r\n  .address-header-line-1 {\r\n    margin-bottom: 0;\r\n    margin-top: 0;\r\n    padding: 0px !important;\r\n  }\r\n\r\n  .address-header-line-2 {\r\n    padding: 0px;\r\n  }\r\n\r\n  .address-container {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    padding-left: 20px;\r\n    padding-top: 20px;\r\n    padding-bottom: 20px;\r\n  }\r\n\r\n  .address-input-container {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    padding-top: 20px;\r\n    padding-bottom: 20px;\r\n  }\r\n\r\n  .topics-container {\r\n    padding: 26px;\r\n    overflow-x: hidden;\r\n    position: relative;\r\n  }\r\n\r\n  @media screen and (min-width: 40em) {\r\n    .topics-container {\r\n      /* height: 100%; */\r\n      /* height: calc(100vh - 210px); */\r\n    }\r\n  }\r\n\r\n</style>\r\n","export default {\r\n  watch: {\r\n    activeFeature(nextActiveFeature, prevActiveFeature) {\r\n      // console.log('WATCH active feature', prevActiveFeature, '=>', nextActiveFeature);\r\n\r\n      const layerMap = this.$store.state.map.map._layers;\r\n      const layers = Object.values(layerMap);\r\n\r\n      let updateFeaturePrev,\r\n          updateFeatureNext,\r\n          tableId,\r\n          featureIdPrev,\r\n          featureIdNext,\r\n          matchingLayerNext,\r\n          matchingLayerPrev;\r\n\r\n      if (prevActiveFeature && prevActiveFeature.tableId && prevActiveFeature.featureId) {\r\n        updateFeaturePrev = prevActiveFeature;\r\n        tableId = updateFeaturePrev.tableId\r\n        featureIdPrev = updateFeaturePrev.featureId;\r\n        matchingLayerPrev = layers.filter(layer => {\r\n          const options = layer.options || {};\r\n          const data = options.data;\r\n          if (!data) return;\r\n          const layerFeatureId = data.featureId;\r\n          const layerTableId = data.tableId;\r\n          return layerFeatureId === featureIdPrev && layerTableId === tableId;\r\n        })[0];\r\n        this.updateMarkerFillColor(matchingLayerPrev);\r\n      }\r\n\r\n      if (nextActiveFeature && nextActiveFeature.tableId && nextActiveFeature.featureId) {\r\n        updateFeatureNext = nextActiveFeature;\r\n        tableId = updateFeatureNext.tableId\r\n        featureIdNext = updateFeatureNext.featureId;\r\n        matchingLayerNext = layers.filter(layer => {\r\n          const options = layer.options || {};\r\n          const data = options.data;\r\n          if (!data) return;\r\n          const layerFeatureId = data.featureId;\r\n          const layerTableId = data.tableId;\r\n          return layerFeatureId === featureIdNext && layerTableId === tableId;\r\n        })[0];\r\n        this.updateMarkerFillColor(matchingLayerNext);\r\n        this.bringMarkerToFront(matchingLayerNext);\r\n      }\r\n\r\n    },\r\n  },\r\n  computed: {\r\n    locationMarker() {\r\n      const latlngArray = [this.$store.state.map.location.lat, this.$store.state.map.location.lng]\r\n      const marker = {\r\n        latlng: latlngArray,\r\n        radius: 6,\r\n        fillColor: '#ff3f3f',\r\n        color: '#ff0000',\r\n        weight: 1,\r\n        opacity: 1,\r\n        fillOpacity: 1.0\r\n      }\r\n      return marker;\r\n    },\r\n    // returns map markers as simple object with a geometry property, key,\r\n    // and optional properties for symbology\r\n    markers() {\r\n      const markers = [];\r\n\r\n      // geocoded address marker\r\n      const geocodeGeom = this.geocodeGeom;\r\n      if (this.identifyFeature === 'address-marker' && geocodeGeom) {\r\n        const latlng = [...geocodeGeom.coordinates].reverse();\r\n        const key = this.geocodeResult.properties.street_address;\r\n        const color = '#2176d2';\r\n        const markerType = 'geocode';\r\n        const addressMarker = {latlng, key, color, markerType};\r\n        markers.push(addressMarker);\r\n      }\r\n\r\n      // marker for topic from config\r\n      const topicMarker = this.activeTopicConfig.marker;\r\n      // console.log('topicMarker', topicMarker);\r\n      if (topicMarker) {\r\n        const markerPath = topicMarker['path'];\r\n        let path = this.$store.state.sources;\r\n        for (let level of markerPath) {\r\n          console.log('level:', level, 'path:', path);\r\n          if (path !== null && path !== undefined) {\r\n            path = path[level];\r\n          }\r\n        }\r\n        if (path !== null && path !== undefined) {\r\n          const latlng = [path[topicMarker.lat], path[topicMarker.lng]];\r\n          const key = path[topicMarker.key];\r\n          const color = topicMarker.color || 'green';\r\n          const markerType = 'overlay';\r\n          const markerObject = {latlng, key, color, markerType};\r\n          markers.push(markerObject);\r\n        }\r\n      }\r\n\r\n      return markers;\r\n    },\r\n    circleMarkers() {\r\n      const filteredData = this.$store.state.horizontalTables.filteredData;\r\n      // const filteredData = this.filteredData;\r\n      let circleMarkers = [];\r\n\r\n      // get visible tables based on active topic\r\n      const tableIds = this.$store.getters.visibleTableIds;\r\n\r\n      // console.log('computed circleMarkers is rerunning, filteredData:', filteredData, 'tableIds:', tableIds);\r\n\r\n      for (let tableId of tableIds) {\r\n        const tableConfig = this.getConfigForTable(tableId) || {};\r\n        // console.log('tableId:', tableId, 'tableConfig:', tableConfig);\r\n        const mapOverlay = (tableConfig.options || {}).mapOverlay;\r\n\r\n        if (!mapOverlay || mapOverlay.marker !== 'circle') {\r\n          continue;\r\n        }\r\n\r\n        const items = filteredData[tableId];\r\n\r\n        if (items.length < 1) {\r\n          continue;\r\n        }\r\n\r\n        const style = mapOverlay.style;\r\n\r\n        // go through rows\r\n        for (let item of items) {\r\n          // console.log('tableId', tableId)\r\n          let latlng;\r\n\r\n          // TODO - get geometry field name from config\r\n          if (item.geometry) {\r\n            const [x, y] = item.geometry.coordinates;\r\n            latlng = [y, x];\r\n          } else if (item.lat) {\r\n            latlng = [item.lat, item.lng]\r\n            // if (item.point_x) {\r\n            //   latlng = [item.point_y, item.point_x];\r\n            // } else if (item.geocode_x) {\r\n            //   latlng = [item.geocode_y, item.geocode_x];\r\n            // }\r\n          }\r\n\r\n          // check for active feature TODO - bind style props to state\r\n          let props = Object.assign({}, style);\r\n          props.latlng = latlng;\r\n          props.featureId = item._featureId;\r\n          props.tableId = tableId;\r\n          circleMarkers.push(props);\r\n        }\r\n      }\r\n\r\n      return circleMarkers;\r\n    },\r\n\r\n    // returns all geojson features to be rendered on the map along with\r\n    // necessary props.\r\n    geojsonFeatures() {\r\n      const features = [];\r\n\r\n      const identifyFeature = this.identifyFeature;\r\n      const activeParcelLayer = this.activeParcelLayer;\r\n\r\n      // TODO - get pwd parcel and dor parcel into the config file\r\n      // pwd parcel\r\n      if (identifyFeature === 'pwd-parcel' && activeParcelLayer === 'pwd' && this.pwdParcel) {\r\n        let props = {};\r\n        props.geojson = this.pwdParcel;\r\n        props.color = 'blue';\r\n        props.fillColor = 'blue';\r\n        props.weight = 2;\r\n        props.opacity = 1;\r\n        props.fillOpacity = 0.3;\r\n        props.key = props.geojson.properties.PARCELID;\r\n        features.push(props);\r\n\r\n      // dor parcel\r\n      } else if (identifyFeature === 'dor-parcel' && activeParcelLayer === 'dor') {\r\n        const color = 'blue';\r\n        const dorParcelFeatures = this.dorParcels.map(dorParcel => {\r\n          let props = {};\r\n          props.geojson = dorParcel;\r\n          props.color = 'blue';\r\n          props.fillColor = 'blue';\r\n          props.weight = 2;\r\n          props.opacity = 1;\r\n          props.fillOpacity = 0.3;\r\n          props.key = dorParcel.properties.OBJECTID;\r\n          return props;\r\n        });\r\n        features.push.apply(features, dorParcelFeatures);\r\n      }\r\n\r\n      // other geojson from config\r\n      const topicGeojson = this.activeTopicConfig.geojson;\r\n      if (topicGeojson) {\r\n        console.log('topicGeojson exists:', topicGeojson);\r\n        const geojsonPath = topicGeojson['path'];\r\n        let path = this.$store.state.sources;\r\n        for (let level of geojsonPath) {\r\n          if (path !== null) {\r\n            path = path[level];\r\n          }\r\n        }\r\n        if (path !== null) {\r\n          console.log('path:', path);\r\n          for (let geojson of path) {\r\n            let props = Object.assign({}, topicGeojson.style);\r\n            props.key = geojson[topicGeojson.key];\r\n            props.geojson = geojson\r\n            features.push(props);\r\n          }\r\n        }\r\n      }\r\n      return features;\r\n    },\r\n\r\n    // these geojson features will have mouseover and mouseout events,\r\n    // for highlighting horizontal table rows\r\n    reactiveGeojsonFeatures() {\r\n      const features = [];\r\n\r\n      const filteredData = this.$store.state.horizontalTables.filteredData;\r\n      // get visible tables based on active topic\r\n      const tableIds = this.$store.getters.visibleTableIds;\r\n\r\n      for (let tableId of tableIds) {\r\n        const tableConfig = this.getConfigForTable(tableId) || {};\r\n        const mapOverlay = (tableConfig.options || {}).mapOverlay;\r\n\r\n        if (!mapOverlay || mapOverlay.marker !== 'geojson') {\r\n          continue;\r\n        }\r\n\r\n        const items = filteredData[tableId];\r\n\r\n        if (items.length < 1) {\r\n          continue;\r\n        }\r\n\r\n        const style = mapOverlay.style;\r\n        items.push(tableId);\r\n\r\n        // go through rows\r\n        for (let item of items) {\r\n          let props = Object.assign({}, style);\r\n\r\n          props.geojson = item.geometry;\r\n          props.key = item.id;\r\n          props.featureId = item._featureId || null;\r\n          props.tableId = items[items.length-1];\r\n          features.push(props);\r\n        }\r\n      }\r\n      return features;\r\n    },\r\n\r\n    leafletMarkers() {\r\n      const markers = [];\r\n\r\n      markers.push.apply(markers, this.markers);\r\n      markers.push.apply(markers, this.geojsonFeatures);\r\n\r\n      return markers;\r\n    },\r\n  },\r\n  methods: {\r\n    getTableFromComps(comps, tableId) {\r\n      const matchingComps = comps.filter(comp => {\r\n        return (\r\n          comp.type === 'horizontal-table' &&\r\n          comp._id == tableId\r\n        );\r\n      }) || [];\r\n      return matchingComps[0];\r\n    },\r\n    getConfigForTable(tableId) {\r\n      const topics = this.$config.topics || [];\r\n\r\n      for (let topic of topics) {\r\n        const comps = topic.components || [];\r\n\r\n        // try outer comps\r\n        const table = this.getTableFromComps(comps, tableId);\r\n\r\n        if (table) return table;\r\n\r\n        // try inner comps\r\n        for (let comp of comps) {\r\n          const options = comp.options || {};\r\n\r\n          const innerComps = options.components || options.tables || [];\r\n\r\n          if (innerComps.length > 0) {\r\n            const innerTable = this.getTableFromComps(innerComps, tableId);\r\n            // console.log('table on 2nd try', innerTable, innerComps);\r\n\r\n            if (innerTable) return innerTable;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    bringMarkerToFront(circleMarker) {\r\n      // put marker on top\r\n      const el = circleMarker._path;\r\n\r\n      // remove from parent\r\n      const group = circleMarker._renderer._rootGroup;\r\n      group.removeChild(el);\r\n\r\n      // append to end (which brings it to the front)\r\n      group.appendChild(el);\r\n    },\r\n    handleMarkerMouseover(e) {\r\n      // console.log('handleMarkerMouseover is starting');\r\n      if (!this.isMobileOrTablet) {\r\n        // console.log('handleMarkerMouseover actions are running');\r\n        const { target } = e;\r\n        const { featureId, tableId } = target.options.data;\r\n        // console.log('target:', target, 'featureId:', featureId, 'tableId:', tableId);\r\n        this.$store.commit('setActiveFeature', { featureId, tableId });\r\n      }\r\n    },\r\n    handleMarkerClick(e) {\r\n      // console.log('handleMarkerClick is starting');\r\n      if (this.isMobileOrTablet) {\r\n        // console.log('handleMarkerClick actions are running');\r\n        const { target } = e;\r\n        const { featureId, tableId } = target.options.data;\r\n        // console.log('target:', target, 'featureId:', featureId, 'tableId:', tableId);\r\n        this.$store.commit('setActiveFeature', { featureId, tableId });\r\n      }\r\n    },\r\n    handleMarkerMouseout(e) {\r\n      // console.log('handleMarkerMouseout is starting');\r\n      // if (!this.isMobileOrTablet) {\r\n        // console.log('handleMarkerMouseout actions are running');\r\n        const { target } = e;\r\n        this.$store.commit('setActiveFeature', null);\r\n      // }\r\n    },\r\n    updateMarkerFillColor(marker) {\r\n      // console.log('updateMarkerFillColor, marker:', marker);\r\n      // get next fill color\r\n      const { featureId, tableId } = marker.options.data;\r\n      const nextFillColor = this.fillColorForCircleMarker(featureId, tableId);\r\n\r\n      // highlight. we're doing this here (non-reactively) because binding the\r\n      // fill color property was not performing well enough.\r\n      const nextStyle = Object.assign({}, marker.options);\r\n      nextStyle.fillColor = nextFillColor;\r\n      marker.setStyle(nextStyle);\r\n    },\r\n  }\r\n};\r\n","<template>\r\n  <div id=\"map-panel-container\"\r\n       :class=\"this.mapPanelContainerClass\"\r\n  >\r\n    <full-screen-map-toggle-tab v-once />\r\n    <map_ :class=\"{ 'mb-map-with-widget': this.$store.state.cyclomedia.active || this.$store.state.pictometry.active }\"\r\n          id=\"map-tag\"\r\n          :center=\"this.$store.state.map.center\"\r\n          :zoom=\"this.$store.state.map.zoom\"\r\n          @l-click=\"handleMapClick\"\r\n          @l-moveend=\"handleMapMove\"\r\n          zoom-control-position=\"bottomright\"\r\n          :min-zoom=\"this.$config.map.minZoom\"\r\n          :max-zoom=\"this.$config.map.maxZoom\"\r\n    >\r\n    <!-- :class=\"{ 'mb-map-with-widget': this.$store.state.cyclomedia.active || this.$store.state.pictometry.active }\" -->\r\n      <!-- loading mask -->\r\n      <div v-show=\"isGeocoding\" class=\"mb-map-loading-mask\">\r\n        <div class=\"mb-map-loading-mask-inner\">\r\n          <i class=\"fa fa-spinner fa-4x spin\"></i>\r\n          <h1>Finding address...</h1>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- basemaps -->\r\n      <esri-tiled-map-layer v-for=\"(basemap, key) in this.$config.map.basemaps\"\r\n                            v-if=\"activeBasemap === key\"\r\n                            :key=\"key\"\r\n                            :url=\"basemap.url\"\r\n                            :max-zoom=\"basemap.maxZoom\"\r\n                            :attribution=\"basemap.attribution\"\r\n      />\r\n\r\n      <!-- basemap labels and parcels outlines -->\r\n      <esri-tiled-map-layer v-for=\"(tiledLayer, key) in this.$config.map.tiledLayers\"\r\n                            v-if=\"tiledLayers.includes(key)\"\r\n                            :key=\"key\"\r\n                            :url=\"tiledLayer.url\"\r\n                            :zIndex=\"tiledLayer.zIndex\"\r\n                            :attribution=\"tiledLayer.attribution\"\r\n      />\r\n\r\n      <esri-tiled-overlay v-for=\"(tiledLayer, key) in this.$config.map.tiledOverlays\"\r\n                          v-if=\"activeTiledOverlays.includes(key)\"\r\n                          :key=\"key\"\r\n                          :url=\"tiledLayer.url\"\r\n                          :zIndex=\"tiledLayer.zIndex\"\r\n                          :opacity=\"tiledLayer.opacity\"\r\n      />\r\n\r\n      <esri-dynamic-map-layer v-for=\"(dynamicLayer, key) in this.$config.map.dynamicMapLayers\"\r\n                              v-if=\"activeDynamicMaps.includes(key)\"\r\n                              :key=\"key\"\r\n                              :url=\"dynamicLayer.url\"\r\n                              :attribution=\"dynamicLayer.attribution\"\r\n                              :transparent=\"true\"\r\n                              :opacity=\"dynamicLayer.opacity\"\r\n      />\r\n\r\n      <!-- dorParcels, pwdParcels, vacantLand, vacantBuilding -->\r\n      <esri-feature-layer v-for=\"(featureLayer, key) in this.$config.map.featureLayers\"\r\n                          v-if=\"shouldShowFeatureLayer(key, featureLayer.minZoom)\"\r\n                          :key=\"key\"\r\n                          :layerName=\"key\"\r\n                          :url=\"featureLayer.url\"\r\n                          :color=\"featureLayer.color\"\r\n                          :fillColor=\"featureLayer.color\"\r\n                          :fillOpacity=\"featureLayer.fillOpacity\"\r\n                          :weight=\"featureLayer.weight\"\r\n                          :style_=\"featureLayer.style\"\r\n                          :minZoom=\"featureLayer.minZoom\"\r\n                          :maxZoom=\"featureLayer.maxZoom\"\r\n                          :zIndex=\"featureLayer.zIndex\"\r\n                          :markerType=\"featureLayer.markerType\"\r\n                          :radius=\"featureLayer.radius\"\r\n      />\r\n\r\n      <!-- regmaps -->\r\n      <esri-dynamic-map-layer v-for=\"(item, key) in this.imageOverlayItems\"\r\n                              v-if=\"shouldShowImageOverlay(item.properties.RECMAP)\"\r\n                              :key=\"key\"\r\n                              :url=\"'//gis.phila.gov/arcgis/rest/services/Atlas/RegMaps/MapServer'\"\r\n                              :layers=\"[0]\"\r\n                              :layerDefs=\"'0:NAME=\\'g' + item.properties.RECMAP.toLowerCase() + '.tif\\''\"\r\n                              :transparent=\"true\"\r\n                              :opacity=\"0.5\"\r\n      />\r\n      <!-- :url=\"'//gis.phila.gov/arcgis/rest/services/DOR_ParcelExplorer/rtt_basemap/MapServer/'\" -->\r\n      <!-- :url=\"this.imageOverlayInfo.url\"\r\n      :opacity=\"this.imageOverlayInfo.opacity\" -->\r\n\r\n      <!-- address marker -->\r\n      <!-- REVIEW why does this need a key? it's not a list... -->\r\n      <!-- <vector-marker v-if=\"identifyFeature === 'address-marker' && geocodeGeom\"\r\n                    :latlng=\"[...geocodeGeom.coordinates].reverse()\"\r\n                    :key=\"streetAddress\"\r\n      /> -->\r\n\r\n      <!-- NEW METHOD: try rendering markers generically based on marker type -->\r\n      <!-- vector markers -->\r\n      <vector-marker v-for=\"(marker, index) in markers\"\r\n                     :latlng=\"marker.latlng\"\r\n                     :key=\"marker.key\"\r\n                     :markerColor=\"marker.color\"\r\n      />\r\n\r\n      <!-- marker using a png and ablility to rotate it -->\r\n      <png-marker v-if=\"this.cyclomediaActive\"\r\n                  :icon=\"'../../src/assets/camera.png'\"\r\n                  :latlng=\"cycloLatlng\"\r\n                  :rotationAngle=\"cycloRotationAngle\"\r\n      />\r\n\r\n      <!-- marker using custom code extending icons - https://github.com/iatkin/leaflet-svgicon -->\r\n      <svg-view-cone-marker v-if=\"this.cyclomediaActive\"\r\n                            :latlng=\"cycloLatlng\"\r\n                            :rotationAngle=\"cycloRotationAngle\"\r\n                            :hFov=\"cycloHFov\"\r\n      />\r\n\r\n\r\n      <!-- non-reactive geojson features -->\r\n      <geojson v-for=\"geojsonFeature in geojsonFeatures\"\r\n               v-if=\"shouldShowGeojson(geojsonFeature.key)\"\r\n               :geojson=\"geojsonFeature.geojson\"\r\n               :fillColor=\"geojsonFeature.fillColor\"\r\n               :color=\"geojsonFeature.color\"\r\n               :weight=\"geojsonFeature.weight\"\r\n               :opacity=\"geojsonFeature.opacity\"\r\n               :fillOpacity=\"geojsonFeature.fillOpacity\"\r\n               :key=\"geojsonFeature.key\"\r\n               :data=\"{\r\n                 featureId: geojsonFeature.featureId,\r\n                 tableId: geojsonFeature.tableId\r\n               }\"\r\n       />\r\n\r\n       <!-- reactive geojson features -->\r\n       <geojson v-for=\"geojsonFeature in reactiveGeojsonFeatures\"\r\n                v-if=\"shouldShowGeojson(geojsonFeature.key)\"\r\n                @l-mouseover=\"handleMarkerMouseover\"\r\n                @l-click=\"handleMarkerClick\"\r\n                @l-mouseout=\"handleMarkerMouseout\"\r\n                :geojson=\"geojsonFeature.geojson\"\r\n                :fillColor=\"geojsonFeature.fillColor\"\r\n                :color=\"geojsonFeature.color\"\r\n                :weight=\"geojsonFeature.weight\"\r\n                :opacity=\"geojsonFeature.opacity\"\r\n                :fillOpacity=\"geojsonFeature.fillOpacity\"\r\n                :key=\"geojsonFeature.key\"\r\n                :data=\"{\r\n                  featureId: geojsonFeature.featureId,\r\n                  tableId: geojsonFeature.tableId\r\n                }\"\r\n        />\r\n\r\n       <!-- location marker -->\r\n       <circle-marker v-if=\"this.$store.state.map.location.lat != null\"\r\n                      :latlng=\"this.locationMarker.latlng\"\r\n                      :radius=\"this.locationMarker.radius\"\r\n                      :fillColor=\"this.locationMarker.fillColor\"\r\n                      :color=\"this.locationMarker.color\"\r\n                      :weight=\"this.locationMarker.weight\"\r\n                      :opacity=\"this.locationMarker.opacity\"\r\n                      :fillOpacity=\"this.locationMarker.fillOpacity\"\r\n                      :key=\"Math.random()\"\r\n       />\r\n\r\n       <!-- TODO give these a real key -->\r\n      <circle-marker v-for=\"circleMarker in circleMarkers\"\r\n                     @l-mouseover=\"handleMarkerMouseover\"\r\n                     @l-click=\"handleMarkerClick\"\r\n                     @l-mouseout=\"handleMarkerMouseout\"\r\n                     :latlng=\"circleMarker.latlng\"\r\n                     :radius=\"circleMarker.radius\"\r\n                     :fillColor=\"circleMarker.fillColor\"\r\n                   \t :color=\"circleMarker.color\"\r\n                   \t :weight=\"circleMarker.weight\"\r\n                   \t :opacity=\"circleMarker.opacity\"\r\n                   \t :fillOpacity=\"circleMarker.fillOpacity\"\r\n                     :key=\"Math.random()\"\r\n                     :data=\"{\r\n                       featureId: circleMarker.featureId,\r\n                       tableId: circleMarker.tableId\r\n                     }\"\r\n      />\r\n\r\n       <!-- <vector-marker v-for=\"marker in threeOneOneMarkers\"\r\n                      v-if=\"activeTopicConfig.key === 'threeOneOne'\"\r\n                      :latlng=\"[marker.geometry.coordinates[1], marker.geometry.coordinates[0]]\"\r\n                      :key=\"marker.id\"\r\n                      :markerColor=\"'#b2ffb2'\"\r\n       /> -->\r\n\r\n      <!-- CONTROLS: -->\r\n      <!-- basemap control -->\r\n      <control-corner :vSide=\"'top'\"\r\n                      :hSide=\"'almostright'\"\r\n      >\r\n      </control-corner>\r\n\r\n      <control-corner :vSide=\"'top'\"\r\n                      :hSide=\"'almostleft'\"\r\n      >\r\n      </control-corner>\r\n\r\n      <!-- <basemap-tooltip :position=\"'topright'\"\r\n      /> -->\r\n\r\n      <div v-once>\r\n        <basemap-toggle-control v-if=\"shouldShowImageryToggle\"\r\n                                v-once\r\n                                :position=\"'topright'\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <basemap-select-control :position=\"this.basemapSelectControlPosition\" />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <pictometry-button v-if=\"this.shouldShowPictometryButton\"\r\n                           v-once\r\n                           :position=\"'topright'\"\r\n                           :link=\"'pictometry'\"\r\n                           :imgSrc=\"'../../src/assets/pictometry.png'\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <cyclomedia-button v-if=\"this.shouldShowCyclomediaButton\"\r\n                           v-once\r\n                           :position=\"'topright'\"\r\n                           :link=\"'cyclomedia'\"\r\n                           :imgSrc=\"'../../src/assets/cyclomedia.png'\"\r\n                           @click=\"handleCyclomediaButtonClick\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once\r\n           v-if=\"this.measureControlEnabled\"\r\n      >\r\n        <measure-control :position=\"'bottomleft'\" />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <legend-control v-for=\"legendControl in Object.keys(legendControls)\"\r\n                        :key=\"legendControl\"\r\n                        :position=\"'bottomleft'\"\r\n                        :options=\"legendControls[legendControl].options\"\r\n                        :items=\"legendControls[legendControl].data\"\r\n        />\r\n      </div>\r\n\r\n      <div v-once>\r\n        <location-control v-once\r\n                          v-if=\"this.geolocationEnabled\"\r\n                          :position=\"'bottomright'\"\r\n        />\r\n      </div>\r\n\r\n      <!-- <basemap-tooltip :position=\"'bottomalmostleft'\"\r\n      /> -->\r\n\r\n      <!-- <scale-control :vSide=\"'top'\"\r\n                     :hSide=\"'almostright'\"\r\n      >\r\n      </scale-control> -->\r\n\r\n      <div v-once>\r\n        <AddressInput :position=\"this.addressInputPosition\" />\r\n      </div>\r\n      <AddressCandidateList v-if=\"this.addressAutocompleteEnabled\"\r\n                            :position=\"this.addressInputPosition\"\r\n      />\r\n\r\n\r\n      <cyclomedia-recording-circle v-for=\"recording in cyclomediaRecordings\"\r\n                                   v-if=\"cyclomediaActive\"\r\n                                   :key=\"recording.imageId\"\r\n                                   :imageId=\"recording.imageId\"\r\n                                   :latlng=\"[recording.lat, recording.lng]\"\r\n                                   :size=\"1.2\"\r\n                                   :color=\"'#3388ff'\"\r\n                                   :weight=\"1\"\r\n                                   @l-click=\"handleCyclomediaRecordingClick\"\r\n      />\r\n    </map_>\r\n    <slot class='widget-slot' name=\"cycloWidget\" />\r\n    <slot class='widget-slot' name=\"pictWidget\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import * as L from 'leaflet';\r\n  import philaVueMapping from '@cityofphiladelphia/phila-vue-mapping';\r\n\r\n  // mixins\r\n  import markersMixin from './markers-mixin';\r\n  const cyclomediaMixin = philaVueMapping.CyclomediaMixin;\r\n  const pictometryMixin = philaVueMapping.PictometryMixin;\r\n\r\n  // vue doesn't like it when you import this as Map (reserved-ish word)\r\n  const Map_ = philaVueMapping.Map_;\r\n  const Control = philaVueMapping.Control;\r\n  const AddressInput = philaVueMapping.AddressInput;\r\n  const AddressCandidateList = philaVueMapping.AddressCandidateList;\r\n  const EsriTiledMapLayer = philaVueMapping.EsriTiledMapLayer;\r\n  const EsriTiledOverlay = philaVueMapping.EsriTiledOverlay;\r\n  const EsriDynamicMapLayer = philaVueMapping.EsriDynamicMapLayer;\r\n  const EsriFeatureLayer = philaVueMapping.EsriFeatureLayer;\r\n  const Geojson = philaVueMapping.Geojson;\r\n  const CircleMarker = philaVueMapping.CircleMarker;\r\n  const OpacitySlider = philaVueMapping.OpacitySlider;\r\n  const VectorMarker = philaVueMapping.VectorMarker;\r\n  const PngMarker = philaVueMapping.PngMarker;\r\n  const BasemapToggleControl = philaVueMapping.BasemapToggleControl;\r\n  const BasemapSelectControl = philaVueMapping.BasemapSelectControl;\r\n  const FullScreenMapToggleTab = philaVueMapping.FullScreenMapToggleTab;\r\n  const LocationControl = philaVueMapping.LocationControl;\r\n  const CyclomediaButton = philaVueMapping.CyclomediaButton;\r\n  const PictometryButton = philaVueMapping.PictometryButton;\r\n  const CyclomediaRecordingCircle = philaVueMapping.CyclomediaRecordingCircle;\r\n  const CyclomediaRecordingsClient = philaVueMapping.CyclomediaRecordingsClient;\r\n  const SvgViewConeMarker = philaVueMapping.SvgViewConeMarker;\r\n  const MeasureControl = philaVueMapping.MeasureControl;\r\n  const LegendControl = philaVueMapping.LegendControl;\r\n  const BasemapTooltip = philaVueMapping.BasemapTooltip;\r\n  const ControlCorner = philaVueMapping.ControlCorner;\r\n\r\n  export default {\r\n    mixins: [\r\n      markersMixin,\r\n      cyclomediaMixin,\r\n      pictometryMixin,\r\n    ],\r\n    components: {\r\n      Map_,\r\n      Control,\r\n      AddressInput,\r\n      AddressCandidateList,\r\n      EsriTiledMapLayer,\r\n      EsriTiledOverlay,\r\n      EsriDynamicMapLayer,\r\n      EsriFeatureLayer,\r\n      Geojson,\r\n      CircleMarker,\r\n      OpacitySlider,\r\n      VectorMarker,\r\n      PngMarker,\r\n      BasemapToggleControl,\r\n      BasemapSelectControl,\r\n      FullScreenMapToggleTab,\r\n      LocationControl,\r\n      PictometryButton,\r\n      CyclomediaButton,\r\n      CyclomediaRecordingCircle,\r\n      SvgViewConeMarker,\r\n      MeasureControl,\r\n      LegendControl,\r\n      BasemapTooltip,\r\n      ControlCorner,\r\n    },\r\n    created() {\r\n      console.log('MapPanel created, this.$config.map:', this.$config.map);\r\n      // if there's a default address, navigate to it\r\n      const defaultAddress = this.$config.defaultAddress;\r\n      if (defaultAddress) {\r\n        this.$controller.goToDefaultAddress(defaultAddress);\r\n      }\r\n\r\n      const cyclomediaConfig = this.$config.cyclomedia || {};\r\n      if (cyclomediaConfig.enabled) {\r\n      // create cyclomedia recordings client\r\n        this.$cyclomediaRecordingsClient = new CyclomediaRecordingsClient(\r\n          this.$config.cyclomedia.recordingsUrl,\r\n          this.$config.cyclomedia.username,\r\n          this.$config.cyclomedia.password,\r\n          4326\r\n        );\r\n      }\r\n    },\r\n    mounted() {\r\n      // this.geofind();\r\n      this.$controller.appDidLoad();\r\n    },\r\n    computed: {\r\n      // shouldShowAddressInput() {\r\n      //   if (this.$config.addressInputLocation == 'map') {\r\n      //     return true;\r\n      //   } else {\r\n      //     return false;\r\n      //   }\r\n      // },\r\n      addressAutocompleteEnabled() {\r\n        // TODO tidy up the code\r\n        if (this.$config.addressInput.autocompleteEnabled === true) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      addressInputPosition() {\r\n        if (this.isMobileOrTablet) {\r\n          return 'topleft'\r\n        } else {\r\n          return 'topalmostleft'\r\n        }\r\n      },\r\n      basemapSelectControlPosition() {\r\n        if (this.isMobileOrTablet) {\r\n          return 'topright'\r\n        } else {\r\n          return 'topalmostright'\r\n        }\r\n      },\r\n      shouldShowAddressCandidateList() {\r\n        return this.$store.state.map.shouldShowAddressCandidateList;\r\n      },\r\n      measureControlEnabled() {\r\n        if (this.$config.measureControlEnabled === false) {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      },\r\n      fullScreenMapEnabled() {\r\n        return this.$store.state.fullScreenMapEnabled;\r\n      },\r\n      fullScreenTopicsEnabled() {\r\n        return this.$store.state.fullScreenTopicsEnabled;\r\n      },\r\n      mapPanelContainerClass() {\r\n        // return 'medium-12 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map'\r\n        if (this.fullScreenMapEnabled) {\r\n          return 'medium-24 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map'\r\n        } else if (this.fullScreenMapOnly) {\r\n          return 'medium-1 small-order-1 small-1 medium-order-2 mb-panel mb-panel-map'\r\n        } else if (this.fullScreenTopicsEnabled) {\r\n          return 'medium-1 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map'\r\n        } else {\r\n          return 'medium-12 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map'\r\n        }\r\n      },\r\n      cycloLatlng() {\r\n        if (this.$store.state.cyclomedia.orientation.xyz !== null) {\r\n          const xyz = this.$store.state.cyclomedia.orientation.xyz;\r\n          return [xyz[1], xyz[0]];\r\n        } else {\r\n          const center = this.$config.map.center;\r\n          return center;\r\n        }\r\n      },\r\n      cycloRotationAngle() {\r\n        return this.$store.state.cyclomedia.orientation.yaw * (180/3.14159265359);\r\n      },\r\n      cycloHFov() {\r\n        return this.$store.state.cyclomedia.orientation.hFov;\r\n      },\r\n      isMobileOrTablet() {\r\n        return this.$store.state.isMobileOrTablet;\r\n      },\r\n      shouldShowCyclomediaButton() {\r\n        return this.$config.cyclomedia.enabled && !this.isMobileOrTablet;\r\n      },\r\n      shouldShowPictometryButton() {\r\n        return this.$config.pictometry.enabled && !this.isMobileOrTablet;\r\n      },\r\n      geolocationEnabled() {\r\n        return this.$config.geolocation.enabled;\r\n      },\r\n      activeDorParcel() {\r\n        // return this.$store.state.activeDorParcel;\r\n        return this.$store.state.parcels.dor.activeParcel;\r\n      },\r\n      legendControls() {\r\n        return this.$config.legendControls;\r\n      },\r\n      imageOverlay() {\r\n        return this.$store.state.map.imageOverlay;\r\n      },\r\n      imageOverlayItems() {\r\n        // console.log('calculating imageOverlayItem');\r\n        if (this.activeTopicConfig.imageOverlayGroup) {\r\n          const overlayGroup = this.activeTopicConfig.imageOverlayGroup;\r\n          const state = this.$store.state;\r\n          const overlay = this.$config.imageOverlayGroups[overlayGroup].items(state);\r\n          // console.log('returning imageOverlayItem', overlay);\r\n          return overlay;\r\n        } else {\r\n          return [];\r\n        }\r\n      },\r\n      imageOverlayInfo() {\r\n        console.log('config:', this.$config);\r\n        return this.$config.map.dynamicMapLayers.regmaps;\r\n      },\r\n      activeBasemap() {\r\n        const shouldShowImagery = this.$store.state.map.shouldShowImagery;\r\n        if (shouldShowImagery) {\r\n          return this.$store.state.map.imagery;\r\n        }\r\n        const defaultBasemap = this.$config.map.defaultBasemap;\r\n        const basemap = this.$store.state.map.basemap || defaultBasemap;\r\n        return basemap;\r\n      },\r\n      tiledLayers() {\r\n        const activeBasemap = this.activeBasemap;\r\n        const activeBasemapConfig = this.configForBasemap(activeBasemap)\r\n\r\n        return activeBasemapConfig.tiledLayers || [];\r\n      },\r\n      activeTiledOverlays() {\r\n        if (!this.activeTopicConfig || !this.activeTopicConfig.tiledOverlays) {\r\n          return [];\r\n        } else {\r\n          return this.activeTopicConfig.tiledOverlays;\r\n        }\r\n      },\r\n      activeDynamicMaps() {\r\n        if (!this.activeTopicConfig || !this.activeTopicConfig.dynamicMapLayers) {\r\n          return [];\r\n        } else {\r\n          return this.activeTopicConfig.dynamicMapLayers;\r\n        }\r\n      },\r\n      activeFeatureLayers() {\r\n        if (!this.activeTopicConfig || !this.activeTopicConfig.featureLayers) {\r\n          return [];\r\n        } else {\r\n          return this.activeTopicConfig.featureLayers;\r\n        }\r\n      },\r\n      activeFeature() {\r\n        return this.$store.state.activeFeature;\r\n      },\r\n      basemaps() {\r\n        return Object.values(this.$config.map.basemaps);\r\n      },\r\n      imageryBasemaps() {\r\n        return this.basemaps.filter(basemap => basemap.type === 'imagery');\r\n      },\r\n      hasImageryBasemaps() {\r\n        return this.imageryBasemaps.length > 0;\r\n      },\r\n      shouldShowImageryToggle() {\r\n        return this.hasImageryBasemaps// && this.$config.map.imagery.enabled;\r\n      },\r\n      identifyFeature() {\r\n        let configFeature;\r\n        if (this.geocodeType === 'intersection') {\r\n          configFeature = \"address-marker\";\r\n        } else if (this.activeTopicConfig.identifyFeature) {\r\n          configFeature = this.activeTopicConfig.identifyFeature;\r\n        } else {\r\n          if (this.$config) {\r\n            configFeature = this.$config.map.defaultIdentifyFeature;\r\n          }\r\n        }\r\n        return configFeature;\r\n      },\r\n      activeTopic() {\r\n        return this.$store.state.activeTopic;\r\n      },\r\n      activeTopicConfig() {\r\n        const key = this.activeTopic;\r\n        let config;\r\n\r\n        // if no active topic, return null\r\n        if (key) {\r\n          config = this.$config.topics.filter((topic) => {\r\n            return topic.key === key;\r\n          })[0];\r\n        }\r\n\r\n        return config || {};\r\n      },\r\n      activeParcelLayer() {\r\n        return this.activeTopicConfig.parcels;\r\n      },\r\n      dorParcels() {\r\n        return this.$store.state.parcels.dor.data;\r\n      },\r\n      pwdParcel() {\r\n        return this.$store.state.parcels.pwd;\r\n      },\r\n      geocodeResult() {\r\n        return this.$store.state.geocode.data || {};\r\n      },\r\n      geocodeGeom() {\r\n        return this.geocodeResult.geometry;\r\n      },\r\n      geocodeType() {\r\n        return this.geocodeResult.ais_feature_type;\r\n      },\r\n      streetAddress() {\r\n        return this.geocodeResult.properties.street_address;\r\n      },\r\n      picOrCycloActive() {\r\n        if (this.cyclomediaActive || this.pictometryActive) {\r\n          return true;\r\n        } else {\r\n          return false;\r\n        }\r\n      },\r\n      mapBounds() {\r\n        // TODO calculate map bounds based on leaflet markers above\r\n      },\r\n      boundsBasedOnShape() {\r\n        return this.$store.state.map.boundsBasedOnShape;\r\n      },\r\n      isGeocoding() {\r\n        return this.$store.state.geocode.status === 'waiting';\r\n      }\r\n    },\r\n    watch: {\r\n      picOrCycloActive(value) {\r\n        this.$nextTick(() => {\r\n          this.$store.state.map.map.invalidateSize();\r\n        })\r\n      },\r\n      geojsonFeatures() {\r\n        this.setMapToBounds();\r\n      },\r\n      markers() {\r\n        this.setMapToBounds();\r\n      },\r\n      fullScreenTopicsEnabled() {\r\n        this.$nextTick(() => {\r\n          this.$store.state.map.map.invalidateSize();\r\n        })\r\n      }\r\n    },\r\n    methods: {\r\n      setMapToBounds() {\r\n        // console.log('setMapToBounds is running');\r\n        let featureArray = []\r\n        if (this.activeTopicConfig.zoomToShape) {\r\n          if (this.activeTopicConfig.zoomToShape.includes('geojson')) {\r\n            for (let geojsonFeature of this.geojsonFeatures) {\r\n              featureArray.push(L.geoJSON(geojsonFeature.geojson))\r\n            }\r\n          }\r\n          if (this.activeTopicConfig.zoomToShape.includes('marker')) {\r\n            for (let marker of this.markers) {\r\n              if (marker.markerType === 'overlay') {\r\n                featureArray.push(L.marker(marker.latlng))\r\n              }\r\n            }\r\n          }\r\n          const group = new L.featureGroup(featureArray);\r\n          const bounds = group.getBounds();\r\n          this.$store.commit('setMapBounds', bounds);\r\n        }\r\n      },\r\n      configForBasemap(basemap) {\r\n        return this.$config.map.basemaps[basemap] || {};\r\n      },\r\n      shouldShowGeojson(key) {\r\n        if (this.activeTopicConfig.basemap === 'pwd') {\r\n          return true;\r\n        } else {\r\n          return key === this.activeDorParcel;\r\n        }\r\n      },\r\n      shouldShowImageOverlay(key) {\r\n        return key === this.imageOverlay;\r\n      },\r\n      shouldShowFeatureLayer(key, minZoom) {\r\n        if (this.activeFeatureLayers.includes(key)) {\r\n          if (minZoom) {\r\n            return this.$store.state.map.zoom >= minZoom;\r\n          }\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      handleMapClick(e) {\r\n        // console.log('MapPanel.vue handleMapClick e:', e);\r\n        // latLng = L.latLng(e.lat, e.lng)\r\n        this.$controller.handleMapClick(e);\r\n      },\r\n\r\n      handleMapMove(e) {\r\n        const map = this.$store.state.map.map;\r\n\r\n        const pictometryConfig = this.$config.pictometry || {};\r\n\r\n        const center = map.getCenter();\r\n        const { lat, lng } = center;\r\n        const coords = [lng, lat];\r\n\r\n        if (pictometryConfig.enabled) {\r\n          // update state for pictometry\r\n          this.$store.commit('setPictometryMapCenter', coords);\r\n\r\n          const zoom = map.getZoom();\r\n          this.$store.commit('setPictometryMapZoom', zoom);\r\n        }\r\n\r\n        const cyclomediaConfig = this.$config.cyclomedia || {};\r\n\r\n        if (cyclomediaConfig.enabled) {\r\n          // update cyclo recordings\r\n          this.updateCyclomediaRecordings();\r\n          this.$store.commit('setCyclomediaLatLngFromMap', [lat, lng]);\r\n        }\r\n      },\r\n      fillColorForCircleMarker(markerId, tableId) {\r\n        // get map overlay style and hover style for table\r\n        const tableConfig = this.getConfigForTable(tableId);\r\n        const mapOverlay = tableConfig.options.mapOverlay;\r\n        const { style, hoverStyle } = mapOverlay;\r\n\r\n        // compare id to active feature id\r\n        const activeFeature = this.activeFeature;\r\n        const useHoverStyle = (\r\n          markerId === activeFeature.featureId &&\r\n          tableId === activeFeature.tableId\r\n        );\r\n        const curStyle = useHoverStyle ? hoverStyle : style;\r\n\r\n        return curStyle.fillColor;\r\n      },\r\n    }, // end of methods\r\n  }; //end of export\r\n</script>\r\n\r\n<style scoped>\r\n  .mb-panel-map {\r\n    /*this allows the loading mask to fill the div*/\r\n    position: relative;\r\n  }\r\n\r\n  .mb-map-with-widget {\r\n    height: 50%;\r\n  }\r\n\r\n  .widget-slot {\r\n    display: inline-block;\r\n    float: left;\r\n  }\r\n\r\n  .mb-map-loading-mask {\r\n    /*display: inline;*/\r\n    position: absolute;\r\n    top: 0;\r\n    height: 100%;\r\n    width: 100%;\r\n    background: rgba(0, 0 ,0 , 0.25);\r\n    z-index: 1000;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n  }\r\n\r\n  .mb-map-loading-mask-inner {\r\n    position: absolute;\r\n    top: 40%;\r\n    left: 40%;\r\n  }\r\n\r\n  /*small retina*/\r\n  /*@media\r\n  (-webkit-min-device-pixel-ratio: 2),\r\n  (min-resolution: 192dpi),\r\n  (max-width: 39.9375em) {\r\n    .mb-search-control-input {\r\n      max-width: 250px;\r\n    }\r\n  }*/\r\n\r\n</style>\r\n","<template>\r\n  <div id=\"mb-root\"\r\n       :class=\"rootClass\"\r\n       :style=\"mbRootStyle\"\r\n  >\r\n      <topic-panel :class=\"this.shouldShowTopicPanel\" />\r\n\r\n      <map-panel :class=\"this.shouldShowMapPanel\"\r\n                 v-if=\"this.fullScreenTopicsOnly !== true\"\r\n      >\r\n        <cyclomedia-widget v-if=\"this.shouldLoadCyclomediaWidget\"\r\n                           slot=\"cycloWidget\"\r\n                           v-show=\"cyclomediaActive\"\r\n                           screen-percent=\"2\"\r\n        />\r\n        <pictometry-widget v-if=\"this.shouldLoadPictometryWidget\"\r\n                           slot=\"pictWidget\"\r\n                           v-show=\"pictometryActive\"\r\n                           :apiKey=\"this.ak\"\r\n                           :secretKey=\"this.sk\"\r\n        >\r\n          <png-marker v-if=\"this.pictometryShowAddressMarker\"\r\n                      :latlng=\"[this.geocodeData.geometry.coordinates[1], this.geocodeData.geometry.coordinates[0]]\"\r\n                      :icon=\"'markers.png'\"\r\n                      :height=\"60\"\r\n                      :width=\"40\"\r\n                      :offsetX=\"0\"\r\n                      :offsetY=\"0\"\r\n          />\r\n          <layer v-if=\"this.pictometryActive\" />\r\n          <png-marker v-if=\"this.cyclomediaActive && this.pictometryActive\"\r\n                      :latlng=\"cycloLatlng\"\r\n                      :icon=\"'camera2.png'\"\r\n                      :height=\"20\"\r\n                      :width=\"30\"\r\n                      :offsetX=\"-2\"\r\n                      :offsetY=\"-2\"\r\n          />\r\n          <view-cone v-if=\"this.cyclomediaActive && this.pictometryActive\"\r\n                     :latlng=\"cycloLatlng\"\r\n                     :rotationAngle=\"cycloRotationAngle\"\r\n                     :hFov=\"cycloHFov\"\r\n          />\r\n        </pictometry-widget>\r\n      </map-panel>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import philaVueMapping from '@cityofphiladelphia/phila-vue-mapping';\r\n\r\n  import TopicPanel from './TopicPanel.vue';\r\n  import MapPanel from './MapPanel.vue';\r\n\r\n  const CyclomediaWidget = philaVueMapping.CyclomediaWidget;\r\n  const PictometryWidget = philaVueMapping.PictometryWidget;\r\n  const Layer = philaVueMapping.PictometryLayer;\r\n  const ViewCone = philaVueMapping.PictometryViewCone;\r\n  const PngMarker = philaVueMapping.PictometryPngMarker;\r\n\r\n  export default {\r\n    components: {\r\n      TopicPanel,\r\n      MapPanel,\r\n      CyclomediaWidget,\r\n      PictometryWidget,\r\n      Layer,\r\n      PngMarker,\r\n      ViewCone\r\n    },\r\n    data() {\r\n      const data = {\r\n        // this will only affect the app size if the app is set to \"plugin\" mode\r\n        mbRootStyle: {\r\n          'height': '100px'\r\n        }\r\n      };\r\n      return data;\r\n    },\r\n    created() {\r\n      console.log('MapBoard created, this.$config.map:', this.$config.map);\r\n      if (this.$config.panels) {\r\n        if (!this.$config.panels.includes('map')) {\r\n          this.$store.commit('setTopicsOnly', true);\r\n        } else if (!this.$config.panels.includes('topics')) {\r\n          this.$store.commit('setMapOnly', true);\r\n        }\r\n      }\r\n      window.addEventListener('click', this.closeAddressCandidateList);\r\n      window.addEventListener('resize', this.handleWindowResize);\r\n      this.handleWindowResize();\r\n    },\r\n    computed: {\r\n      rootClass() {\r\n        if (this.$config.plugin) {\r\n          return 'grid-x';\r\n        } else {\r\n          return 'cell medium-auto grid-x';\r\n        }\r\n      },\r\n      isMobileOrTablet() {\r\n        return this.$store.state.isMobileOrTablet;\r\n      },\r\n      shouldLoadCyclomediaWidget() {\r\n        return this.$config.cyclomedia.enabled && !this.isMobileOrTablet;\r\n      },\r\n      shouldLoadPictometryWidget() {\r\n        return this.$config.pictometry.enabled && !this.isMobileOrTablet;\r\n      },\r\n      fullScreenMapOnly() {\r\n        return this.$store.state.fullScreen.mapOnly;\r\n      },\r\n      fullScreenMapEnabled() {\r\n        return this.$store.state.fullScreenMapEnabled;\r\n      },\r\n      fullScreenTopicsOnly() {\r\n        return this.$store.state.fullScreen.topicsOnly;\r\n      },\r\n      fullScreenTopicsEnabled() {\r\n        return this.$store.state.fullScreenTopicsEnabled;\r\n      },\r\n      shouldShowTopicPanel() {\r\n        let value;\r\n        if (!this.fullScreenMapEnabled && !this.fullScreenMapOnly) {\r\n          value = 'topic-panel-true';\r\n        } else {\r\n          value = 'topic-panel-false';\r\n        }\r\n        return value;\r\n      },\r\n      shouldShowMapPanel() {\r\n        let value;\r\n        if (!this.fullScreenTopicsEnabled && !this.fullScreenTopicsOnly) {\r\n          value = 'map-panel-true';\r\n        } else {\r\n          value = 'map-panel-false';\r\n        }\r\n        return value;\r\n      },\r\n      cyclomediaActive() {\r\n        return this.$store.state.cyclomedia.active\r\n      },\r\n      cycloLatlng() {\r\n        if (this.$store.state.cyclomedia.orientation.xyz !== null) {\r\n          const xyz = this.$store.state.cyclomedia.orientation.xyz;\r\n          return [xyz[1], xyz[0]];\r\n        } else {\r\n          const center = this.$config.map.center;\r\n          return center;\r\n        }\r\n      },\r\n      cycloRotationAngle() {\r\n        return this.$store.state.cyclomedia.orientation.yaw * (180/3.14159265359);\r\n      },\r\n      cycloHFov() {\r\n        return this.$store.state.cyclomedia.orientation.hFov;\r\n      },\r\n      pictometryActive() {\r\n        return this.$store.state.pictometry.active\r\n      },\r\n      pictometryZoom() {\r\n        return this.$store.state.pictometry.zoom\r\n      },\r\n      pictometryShowAddressMarker() {\r\n        if (!this.pictometryActive || !this.geocodeData) {\r\n          return false;\r\n        } else if (this.pictometryZoom < 20 && this.cyclomediaActive) {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      },\r\n      geocodeData() {\r\n        return this.$store.state.geocode.data\r\n      },\r\n      ak() {\r\n        const host = window.location.hostname;\r\n        if (host === 'atlas.phila.gov') {\r\n          return this.$config.pictometry.apiKey;\r\n        }\r\n        if (host === 'atlas-dev.phila.gov') {\r\n          return this.$config.pictometryDev.apiKey;\r\n        }\r\n        if (host === 'cityatlas.phila.gov') {\r\n          return this.$config.pictometryCity.apiKey;\r\n        }\r\n        if (host === 'cityatlas-dev.phila.gov') {\r\n          return this.$config.pictometryCityDev.apiKey;\r\n        }\r\n        if (host === '10.8.101.67') {\r\n          return this.$config.pictometryLocal.apiKey;\r\n        }\r\n      },\r\n      sk() {\r\n        const host = window.location.hostname;\r\n        if (host === 'atlas.phila.gov') {\r\n          return this.$config.pictometry.secretKey;\r\n        }\r\n        if (host === 'atlas-dev.phila.gov') {\r\n          return this.$config.pictometryDev.secretKey;\r\n        }\r\n        if (host === 'cityatlas.phila.gov') {\r\n          return this.$config.pictometryCity.secretKey;\r\n        }\r\n        if (host === 'cityatlas-dev.phila.gov') {\r\n          return this.$config.pictometryCityDev.secretKey;\r\n        }\r\n        if (host === '10.8.101.67') {\r\n          return this.$config.pictometryLocal.secretKey;\r\n        }\r\n      }\r\n    },\r\n    watch: {\r\n      pictometryShowAddressMarker(nextValue) {\r\n        console.log('watch pictometryShowAddressMarker', nextValue);\r\n      }\r\n    },\r\n    methods: {\r\n      closeAddressCandidateList() {\r\n        this.$store.state.map.shouldShowAddressCandidateList = false;\r\n      },\r\n      handleWindowResize() {\r\n        // this only actually affects the size if it is set to \"plugin mode\"\r\n        if ($(window).width() >= 750) {\r\n          this.mbRootStyle.height = '600px'\r\n        } else {\r\n          this.mbRootStyle.height = 'auto';\r\n        }\r\n      }\r\n    },\r\n  };\r\n</script>\r\n\r\n<style>\r\n  /*don't highlight any form elements*/\r\n  input:focus,\r\n  select:focus,\r\n  textarea:focus,\r\n  button:focus {\r\n    outline: none;\r\n  }\r\n\r\n  .mb-panel-topics-with-widget {\r\n    height: 50%;\r\n  }\r\n\r\n  /* standards applies padding to buttons, which causes some weirdness with\r\n  buttons on the map panel. override here. */\r\n  button {\r\n    padding: inherit;\r\n  }\r\n\r\n  .topic-panel-false {\r\n    /* display: none; */\r\n  }\r\n\r\n  @media screen and (min-width: 46.875em) {\r\n    .topic-panel-false {\r\n      display: none;\r\n    }\r\n\r\n    .map-panel-false {\r\n      display: none;\r\n    }\r\n  }\r\n\r\n</style>\r\n","// http://stackoverflow.com/a/37164538/676001\r\n\r\n// helper to verify that an item is an object\r\nexport function isObject(item) {\r\n  return (item && typeof item === 'object' && !Array.isArray(item) && item !== null);\r\n};\r\n\r\n// merges n objects, deeply, immutably\r\nexport default function mergeDeep(target, source) {\r\n  let output = Object.assign({}, target);\r\n  if (isObject(target) && isObject(source)) {\r\n    Object.keys(source).forEach(key => {\r\n      if (isObject(source[key])) {\r\n        if (!(key in target))\r\n          Object.assign(output, { [key]: source[key] });\r\n        else\r\n          output[key] = mergeDeep(target[key], source[key]);\r\n      } else {\r\n        Object.assign(output, { [key]: source[key] });\r\n      }\r\n    });\r\n  }\r\n  return output;\r\n};\r\n","function generateUniqueId() {\r\n  return Math.random().toString(36).substring(7);\r\n}\r\n\r\nexport default generateUniqueId;\r\n","import Vue from 'vue';\r\nimport axios from 'axios';\r\nimport createStore from './store';\r\nimport configMixin from './util/config-mixin';\r\nimport Mapboard from './components/Mapboard.vue';\r\nimport mergeDeep from './util/merge-deep';\r\nimport generateUniqueId from './util/unique-id';\r\n\r\nimport philaVueDatafetch from '@cityofphiladelphia/phila-vue-datafetch';\r\nconst controllerMixin = philaVueDatafetch;\r\n\r\n// helper function to auto-assign ids to horizontal tables\r\nfunction assignTableIds(comps) {\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.components || options.tables;\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (innerComps) {\r\n      assignTableIds(innerComps);\r\n      // return;\r\n    }\r\n\r\n    // skip comps that aren't horizontal tables\r\n    if (comp.type !== 'horizontal-table') {\r\n      continue;\r\n    }\r\n\r\n     const id = generateUniqueId();\r\n     comp._id = id;\r\n     // the id also needs to get passed to the horizontal table component, so\r\n     // use the options object.\r\n     comp.options.tableId = id;\r\n  }\r\n}\r\n\r\nfunction assignHorizontalTableGroupIds(comps) {\r\n  for (let comp of comps) {\r\n    const options = comp.options || {};\r\n    const innerComps = options.tables;\r\n\r\n    // if this is a \"group\" component, recurse\r\n    if (!innerComps) {\r\n      continue;\r\n    }\r\n\r\n    // skip comps that aren't horizontal table groups\r\n    if (comp.type !== 'horizontal-table-group') {\r\n      continue;\r\n    }\r\n\r\n     const id = generateUniqueId();\r\n     comp._id = id;\r\n     // the id also needs to get passed to the horizontal table component, so\r\n     // use the options object.\r\n     comp.options.horizontalTableGroupId = id;\r\n  }\r\n}\r\n\r\nfunction initMapboard(clientConfig) {\r\n  const baseConfigUrl = clientConfig.baseConfig;\r\n  // console.log('baseConfigUrl:', baseConfigUrl);\r\n\r\n  // get base config\r\n  return axios.get(baseConfigUrl).then(response => {\r\n    const data = response.data;\r\n    // const data = baseConfigUrl;\r\n\r\n    // parse raw js. yes, it's ok to use eval :)\r\n    // http://stackoverflow.com/a/87260/676001\r\n    const baseConfigFn = eval(data);\r\n    const { gatekeeperKey } = clientConfig;\r\n    const baseConfig = baseConfigFn({ gatekeeperKey });\r\n\r\n    // deep merge base config and client config\r\n    const config = mergeDeep(baseConfig, clientConfig);\r\n    // const config = mergeDeep(baseConfigUrl, clientConfig);\r\n\r\n    // assign table ids\r\n    for (let topic of config.topics) {\r\n      assignTableIds(topic.components);\r\n      assignHorizontalTableGroupIds(topic.components);\r\n    }\r\n\r\n    // make config accessible from each component via this.$config\r\n    Vue.use(configMixin, config);\r\n\r\n    // create store\r\n    const store = createStore(config);\r\n\r\n    // mix in controller\r\n    Vue.use(controllerMixin, { config, store });\r\n    // Vue.use(controllerMixin, { config, store, eventBus });\r\n\r\n    // mount main vue\r\n    const vm = new Vue({\r\n      el: config.el || '#mapboard',\r\n      render: h => h(Mapboard),\r\n      store\r\n    });\r\n\r\n  }).catch(err => {\r\n    console.error('Error loading base config:', err);\r\n  });\r\n}\r\n\r\nexport default initMapboard;\r\n\r\n// also expose the vue component as a named export\r\nexport { Mapboard };\r\n"],"names":["const","let","Vue","latlng","key","color","markerType","this","props","AddressInput","AddressCandidateList","L.featureGroup","PngMarker"],"mappings":"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"}
>>>>>>> origin/master
