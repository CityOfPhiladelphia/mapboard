!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("vuex"),require("@cityofphiladelphia/phila-vue-datafetch"),require("@cityofphiladelphia/phila-vue-mapping"),require("@cityofphiladelphia/phila-vue-comps"),require("leaflet"),require("axios"),require("@fortawesome/fontawesome-svg-core"),require("@fortawesome/vue-fontawesome")):"function"==typeof define&&define.amd?define(["exports","vue","vuex","@cityofphiladelphia/phila-vue-datafetch","@cityofphiladelphia/phila-vue-mapping","@cityofphiladelphia/phila-vue-comps","leaflet","axios","@fortawesome/fontawesome-svg-core","@fortawesome/vue-fontawesome"],t):t(e.mapboard={},e.Vue,e.Vuex,e.philaVueDatafetch,e.philaVueMapping,e.philaVueComps,e.L,e.axios,e.fontawesomeSvgCore,e.vueFontAwesome)}(this,function(exports,Vue,Vuex,philaVueDatafetch,philaVueMapping,philaVueComps,leaflet,axios,fontawesomeSvgCore,vueFontawesome){"use strict";function isMobileDevice(){var e=navigator.userAgent||navigator.vendor||window.opera||"";return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}function isObject(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e}function mergeDeep(e,t){var i=Object.assign({},e);return isObject(e)&&isObject(t)&&Object.keys(t).forEach(function(a){var o,n;isObject(t[a])?a in e?i[a]=mergeDeep(e[a],t[a]):Object.assign(i,((o={})[a]=t[a],o)):Object.assign(i,((n={})[a]=t[a],n))}),i}Vue=Vue&&Vue.hasOwnProperty("default")?Vue.default:Vue,Vuex=Vuex&&Vuex.hasOwnProperty("default")?Vuex.default:Vuex,philaVueDatafetch=philaVueDatafetch&&philaVueDatafetch.hasOwnProperty("default")?philaVueDatafetch.default:philaVueDatafetch,philaVueMapping=philaVueMapping&&philaVueMapping.hasOwnProperty("default")?philaVueMapping.default:philaVueMapping,philaVueComps=philaVueComps&&philaVueComps.hasOwnProperty("default")?philaVueComps.default:philaVueComps,axios=axios&&axios.hasOwnProperty("default")?axios.default:axios;var pvdStore=philaVueDatafetch.pvdStore,pvmStore=philaVueMapping.pvmStore,pvcStore=philaVueComps.pvcStore;function getHorizontalTableIdsFromComps(e){void 0===e&&(e=[]);for(var t=[],i=0,a=e;i<a.length;i+=1){var o=a[i],n=o.options||{},r=n.components||n.tables;if(r){var s=getHorizontalTableIdsFromComps(r);t=t.concat(s)}else if("horizontal-table"===o.type){var l=o._id;t.push(l)}}return t}function createFilteredData(e){for(var t=[],i=0,a=e.topics;i<a.length;i+=1){var o=getHorizontalTableIdsFromComps(a[i].components);t=t.concat(o)}for(var n={},r=0;r<t.length;r++)n[t[r]]=[];return n}function getHorizontalTableGroupIdsFromComps(e){var t;void 0===e&&(e=[]);for(var i=0,a=e;i<a.length;i+=1){var o=a[i],n=o.options||{};(n.components||n.tables)&&("horizontal-table-group"===o.type&&(t=o._id))}return t}function createHorizontalTableGroups(e){for(var t=[],i=0,a=e.topics;i<a.length;i+=1){var o=getHorizontalTableGroupIdsFromComps(a[i].components);o&&t.push(o)}for(var n={},r=0,s=t;r<s.length;r+=1){n[s[r]]={activeTable:null,activeTableId:null}}return n}function createStore(e){var t=pvdStore.createSources(e),i=pvdStore.createParcels(e),a={isMobileOrTablet:isMobileDevice(),fullScreen:{mapOnly:!1,topicsOnly:!1},fullScreenMapEnabled:!1,candidates:[],addressEntered:null,parcels:i,sources:t,horizontalTables:{filteredData:createFilteredData(e)},horizontalTableGroups:createHorizontalTableGroups(e),activeFeature:{featureId:null,tableId:null},appData:{propertyBalance:0},modals:{keys:e.modals,open:""},map:{}};e.map.initialImagery&&(a.map.imagery=e.map.initialImagery);var o={state:a,getters:{visibleTableIds:function(t){var i=t.activeTopic;if(!i)return[];var a=(e.topics.filter(function(e){return e.key===i})||[])[0].components,o=getHorizontalTableGroupIdsFromComps(a);if(o){var n=[];return n.push(t.horizontalTableGroups[o].activeTableId),n}return getHorizontalTableIdsFromComps(a)}},mutations:{setIsMobileOrTablet:function(e,t){e.isMobileOrTablet=t},setMapOnly:function(e,t){e.fullScreen.mapOnly=t},setTopicsOnly:function(e,t){e.fullScreen.topicsOnly=t},setFullScreenMapEnabled:function(e,t){e.fullScreenMapEnabled=t},setLocation:function(e,t){e.map.location.lat=t.lat,e.map.location.lng=t.lng},setWatchPositionOn:function(e,t){e.map.watchPositionOn=t},setHorizontalTableGroupActiveTable:function(e,t){e.horizontalTableGroups[t.tableGroupId].activeTableId=t.activeTableId,e.horizontalTableGroups[t.tableGroupId].activeTable=t.activeTable},setHorizontalTableFilteredData:function(e,t){var i=t.tableId,a=t.data;i&&(e.horizontalTables.filteredData[i]=a)},setMapFilters:function(e,t){e.map.filters=t},setMap:function(e,t){e.map.map=t.map},setMapBounds:function(e,t){e.map.bounds=t},setMapBoundsBasedOnShape:function(e,t){e.map.boundsBasedOnShape=t},setActiveParcel:function(e,t){var i=t||{},a=i.parcelLayer,o=i.activeParcel,n=i.activeAddress,r=i.activeMapreg;e.parcels[a].activeParcel=o,e.parcels[a].activeAddress=n,e.parcels[a].activeMapreg=r},setActiveFeature:function(e,t){var i=t||{},a={featureId:i.featureId,tableId:i.tableId};e.activeFeature=a},setImageOverlay:function(e,t){e.map.imageOverlay=t},setImageOverlayOpacity:function(e,t){e.map.imageOverlayOpacity=t},setCandidates:function(e,t){e.candidates=t},setAddressEntered:function(e,t){e.addressEntered=t},setPropertyBalance:function(e,t){e.appData.propertyBalance=t},setDidToggleModal:function(e,t){e.modals.open=t}}},n=mergeDeep(pvdStore.store,pvmStore);return(n=mergeDeep(n=mergeDeep(n,pvcStore),o)).state.map.center=e.map.center,n.state.map.zoom=e.map.zoom,n.state.pictometry.map.center=e.map.center,n.state.pictometry.map.zoom=e.map.zoom,new Vuex.Store({state:n.state,getters:n.getters,mutations:n.mutations})}function configMixin(e,t){e.mixin({created:function(){this.$config=t}})}Vue.use(Vuex),function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),i=" .page-title { padding-top: 6px; /* padding-bottom: 0px !important; padding-right: 8px !important; padding-left: 8px !important; */ } ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i)),e.appendChild(t)}}();var HeaderComp={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"cell medium-24",attrs:{id:"mb-header"}},[t("header",{staticClass:"site-header app group"},[t("div",{staticClass:"row expanded"},[t("div",{staticClass:"columns"},[this._m(0),this._v(" "),t("div",{staticClass:"app-divide"}),this._v(" "),t("div",{staticClass:"page-title-container"},[t("a",{attrs:{href:"#/"}},[t("h1",{staticClass:"page-title",style:this.mbHeaderStyle},[this._v(" "+this._s(this.headerText)+" ")])])])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("a",{staticClass:"logo",attrs:{href:"//beta.phila.gov"}},[t("img",{attrs:{src:"https://standards.phila.gov/img/logo/city-of-philadelphia-yellow-white.png",alt:"City of Philadelphia"}})])}],data:function(){return{mbHeaderStyle:{"font-size":"30px","line-height":"30px"}}},created:function(){window.addEventListener("resize",this.handleWindowResize),this.handleWindowResize()},computed:{headerText:function(){return this.$config.header?this.$config.header.text:null}},methods:{handleWindowResize:function(){window.innerWidth>=750?this.mbHeaderStyle={"font-size":"30px","line-height":"30px"}:this.mbHeaderStyle={"font-size":"22px","line-height":"22px"}}}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),i=" /*don't highlight any form elements*/ input[data-v-c37cf8b6]:focus, select[data-v-c37cf8b6]:focus, textarea[data-v-c37cf8b6]:focus, button[data-v-c37cf8b6]:focus { outline: none; } /* standards applies padding to buttons, which causes some weirdness with buttons on the map panel. override here. */ button[data-v-c37cf8b6] { padding: inherit; } .mb-panel-topics[data-v-c37cf8b6] { position: relative; } .address-header[data-v-c37cf8b6] { background: #daedfe; color: #0f4d90; /*this keeps the box shadow over the scrollable part of the panel*/ position: relative; z-index: 1; -webkit-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18); -moz-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18); box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18); margin-bottom: -5px !important; display: inline-block; } .address-header-line-1[data-v-c37cf8b6] { margin-bottom: 0; margin-top: 0; padding-top: 0px !important; padding-bottom: 0px !important; padding-right: 8px !important; padding-left: 8px !important; } .address-header-line-2[data-v-c37cf8b6] { padding: 0px; } .address-header-line-3[data-v-c37cf8b6] { padding: 0px; } .address-container[data-v-c37cf8b6] { display: flex; flex-direction: column; justify-content: center; } .address-input-container[data-v-c37cf8b6] { display: flex; flex-direction: column; justify-content: center; } .topics-container[data-v-c37cf8b6] { padding: 26px; position: relative; overflow-x: hidden; } .default-address-text[data-v-c37cf8b6] { font-size: 30px; line-height: 26px; font-family: 'Montserrat', 'Tahoma', sans-serif; padding-top: 0px !important; padding-bottom: 0px !important; padding-right: 8px !important; padding-left: 8px !important; } ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i)),e.appendChild(t)}}();var Topic=philaVueComps.Topic,TopicComponentGroup=philaVueComps.TopicComponentGroup,AnyHeader=philaVueComps.AnyHeader,Greeting=philaVueComps.Greeting,AddressInput=philaVueComps.AddressInput,AddressCandidateList=philaVueComps.AddressCandidateList,FullScreenTopicsToggleTab=philaVueComps.FullScreenTopicsToggleTab,TopicPanel={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"mb-panel-topics cell "+this.topicPanelContainerClass,attrs:{id:"topic-panel-container"}},[this.fullScreenTopicsOnly?e._e():e._m(0),e._v(" "),this.shouldShowAddressHeader?i("div",{staticClass:"address-header cell small-24 medium-24"},[i("div",{class:"address-container columns "+this.addressContainerClass,style:this.addressContainerStyle},[this.address?e._e():i("div",{staticClass:"default-address-text",style:this.defaultAddressTextPlaceholderStyle},[e._v(" "+e._s(this.$config.defaultAddressTextPlaceholder.text)+" ")]),e._v(" "),i("h1",{staticClass:"address-header-line-1"},[this.fullScreenTopicsOnly?e._e():i("font-awesome-icon",{attrs:{icon:"map-marker-alt"}}),e._v(" "+e._s(e.address)+" ")],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:this.geocode,expression:"this.geocode"}],staticClass:"address-header-line-2"},[e._v(" PHILADELPHIA, PA "+e._s(e.zipCode)+" ")]),e._v(" "),this.addressHeaderAdditionalInfo?i("any-header",{attrs:{options:this.addressHeaderAdditionalHeaderOptions,slots:this.addressHeaderAdditionalHeaderSlots}}):e._e()],1),e._v(" "),this.fullScreenTopicsEnabled&&!this.stacked||this.fullScreenTopicsOnly?i("div",{staticClass:"address-input-container columns small-24 medium-12 large-12",style:this.addressInputContainerStyle},[i("address-input",{attrs:{widthFromConfig:this.addressInputWidth,placeholder:this.addressInputPlaceholder}},[this.addressAutocompleteEnabled?i("address-candidate-list",{attrs:{slot:"address-candidates-slot",widthFromConfig:this.addressInputWidth},slot:"address-candidates-slot"}):e._e(),e._v(" /> ")],1)],1):e._e()]):e._e(),e._v(" "),e.shouldShowGreeting?i("div",{staticClass:"topics-container cell medium-cell-block-y",style:e.topicsContainerStyle},[i("greeting",{directives:[{name:"show",rawName:"v-show",value:e.shouldShowGreeting,expression:"shouldShowGreeting"}],attrs:{message:e.greetingText,options:e.greetingOptions}})],1):e._e(),e._v(" "),e.shouldShowGreeting?e._e():i("div",{staticClass:"topic-panel-content"},[i("div",{staticClass:"topics-container cell medium-cell-block-y",style:e.topicsContainerStyle},[i("topic-component-group",{attrs:{"topic-components":this.$config.components}})],1)])],1)},staticRenderFns:[function(){var e=this.$createElement;return(this._self._c||e)("full-screen-topics-toggle-tab")}],_scopeId:"data-v-c37cf8b6",components:{Greeting:Greeting,TopicComponentGroup:TopicComponentGroup,Topic:Topic,AnyHeader:AnyHeader,AddressInput:AddressInput,AddressCandidateList:AddressCandidateList,FullScreenTopicsToggleTab:FullScreenTopicsToggleTab},data:function(){return{defaultAddressTextPlaceholderStyle:{},topicsContainerStyle:{"overflow-y":"auto",height:"100px","min-height":"100px"},addressContainerStyle:{height:"100%","align-items":"flex-start","padding-left":"20px","padding-top":"20px","padding-bottom":"20px"},addressInputContainerStyle:{height:"100%","align-items":"center","padding-top":"10px","padding-bottom":"10px"},stacked:!1}},mounted:function(){window.addEventListener("click",this.closeAddressCandidateList),window.addEventListener("resize",this.handleWindowResize),this.handleWindowResize(25)},watch:{geocodeStatus:function(){this.handleWindowResize()}},computed:{greetingText:function(){return this.$config.greeting.message},greetingOptions:function(){return this.$config.greeting.options},shouldShowAddressHeader:function(){return!(!this.fullScreenTopicsOnly&&!1!==this.shouldShowGreeting)},addressHeaderAdditionalHeaderOptions:function(){if(this.$config.addressHeaderAdditionalInfo){var e=this.$config.addressHeaderAdditionalInfo;if(e.options)return e.options.headerType||(e.options.headerType="h4"),e.options}},addressHeaderAdditionalHeaderSlots:function(){return{text:this.addressHeaderAdditionalInfo}},addressHeaderAdditionalInfo:function(){if(this.$config.addressHeaderAdditionalInfo){var e=this.geocode;if(!e)return null;var t=this.$config.addressHeaderAdditionalInfo,i=[];return t.preText&&i.push(t.preText),i.push(e.properties[t.data]),console.log("returned:",i),i.join(" ")}},inputAlign:function(){if(!this.$config.addressInput)return"flex-start";if(!this.$config.addressInput.position)return"flex-start";switch(this.$config.addressInput.position){case"left":return"flex-start";case"right":return"flex-end";case"center":return"center"}},addressInputWidth:function(){return this.$config.addressInput?this.$config.addressInput.width:415},addressInputPlaceholder:function(){return this.$config.addressInput?this.$config.addressInput.placeholder:null},addressAutocompleteEnabled:function(){return!!this.$config.addressInput&&!0===this.$config.addressInput.autocompleteEnabled},fullScreenMapEnabled:function(){return this.$store.state.fullScreenMapEnabled},fullScreenTopicsEnabled:function(){return this.$store.state.fullScreenTopicsEnabled},fullScreenTopicsOnly:function(){return this.$store.state.fullScreen.topicsOnly},topicPanelContainerClass:function(){return this.fullScreenTopicsEnabled||this.fullScreenTopicsOnly?"medium-24 small-order-2 medium-order-1":this.fullScreenMapEnabled?"medium-1 small-order-2 medium-order-1":"medium-12 small-order-2 medium-order-1"},addressContainerClass:function(){return this.fullScreenTopicsEnabled||this.fullScreenTopicsOnly?"small-24 medium-12 large-12":"small-24"},geocode:function(){return this.$store.state.geocode.data},geocodeStatus:function(){return this.$store.state.geocode.status},dorParcels:function(){return this.$store.state.parcels.dor.data.length>0},shouldShowGreeting:function(){return!(this.geocode||this.dorParcels)},address:function(){var e,t=this.geocode,i=(this.$store.state.parcels.dor.data,this.$store.state.parcels.dor.activeAddress);if(t){var a=t.properties.street_address,o=t.street_address;e=a||o}else i&&(e=i);return e},zipCode:function(){var e=this.geocode;if(!e)return null;var t=e.properties.zip_code,i=e.properties.zip_4,a=[t];return i&&a.push(i),a.join("-")}},methods:{closeAddressCandidateList:function(){this.$store.state.shouldShowAddressCandidateList=!1},handleWindowResize:function(e){var t,i=window.innerHeight,a=parseInt(document.getElementsByClassName("site-header")[0].getBoundingClientRect().height),o=parseInt(document.getElementsByClassName("app-footer")[0].getBoundingClientRect().height);this.shouldShowAddressHeader?document.getElementsByClassName("address-header")[0]?(t=i-a-o-parseInt(document.getElementsByClassName("address-header")[0].getBoundingClientRect().height),"number"==typeof e&&(t-=e)):t=i-a-o-103:t=i-a-o;window.innerWidth>=750?(this.stacked=!1,this.$config.defaultAddressTextPlaceholder&&(this.defaultAddressTextPlaceholderStyle=this.$config.defaultAddressTextPlaceholder.wideStyle),this.addressContainerStyle={height:"100%","align-items":"flex-start","padding-left":"20px","padding-top":"20px","padding-bottom":"20px"},this.addressInputContainerStyle={height:"100%","align-items":this.inputAlign,"padding-top":"30px","padding-bottom":"30px"},this.topicsContainerStyle.height=t.toString()+"px",this.topicsContainerStyle["min-height"]=t.toString()+"px",this.topicsContainerStyle["overflow-y"]="auto"):(this.stacked=!0,this.$config.defaultAddressTextPlaceholder&&(this.defaultAddressTextPlaceholderStyle=this.$config.defaultAddressTextPlaceholder.narrowStyle),this.addressContainerStyle={height:"auto","align-items":"center","padding-left":"0px","padding-top":"10px","padding-bottom":"10px"},this.addressInputContainerStyle={height:"auto","align-items":"center","padding-top":"10px","padding-bottom":"10px"},this.topicsContainerStyle.height="auto",this.topicsContainerStyle["min-height"]=t.toString()+"px",this.topicsContainerStyle["overflow-y"]="hidden")}}},markersMixin={watch:{activeFeature:function(e,t){var i,a,o,n,r,s,l,c=this.$store.state.map.map._layers,d=Object.values(c);t&&t.tableId&&t.featureId&&(o=(i=t).tableId,n=i.featureId,l=d.filter(function(e){var t=(e.options||{}).data;if(t){var i=t.featureId,a=t.tableId;return i===n&&a===o}})[0],this.updateMarkerFillColor(l)),e&&e.tableId&&e.featureId&&(o=(a=e).tableId,r=a.featureId,s=d.filter(function(e){var t=(e.options||{}).data;if(t){var i=t.featureId,a=t.tableId;return i===r&&a===o}})[0],this.updateMarkerFillColor(s),this.bringMarkerToFront(s))}},computed:{locationMarker:function(){return{latlng:[this.$store.state.map.location.lat,this.$store.state.map.location.lng],radius:6,fillColor:"#ff3f3f",color:"#ff0000",weight:1,opacity:1,fillOpacity:1}},markersForAddress:function(){var e=[],t=this.geocodeGeom;if("address-marker"===this.identifyFeature&&t){var i={latlng:[].concat(t.coordinates).reverse(),key:this.geocodeResult.properties.street_address,color:"#2176d2",markerType:"geocode",icon:{prefix:"fas",icon:"map-marker-alt",shadow:!0,size:50}};e.push(i)}return e},markersForTopic:function(){var e=[],t=this.activeTopicConfig.markersForTopic;if(t){var i=this.$store.state,a=t.data(i);if(null!==a){var o={latlng:[a[t.lat],a[t.lng]],key:a[t.key],color:t.color||"green",markerType:"overlay",icon:t.icon};e.push(o)}}return e},circleMarkers:function(){for(var e=this.$store.state.horizontalTables.filteredData,t=[],i=0,a=this.$store.getters.visibleTableIds;i<a.length;i+=1){var o=a[i],n=((this.getConfigForTable(o)||{}).options||{}).mapOverlay;if(n&&"circle"===n.marker){var r=e[o];if(!(r.length<1))for(var s=n.style,l=0,c=r;l<c.length;l+=1){var d=c[l],p=void 0;if(d.geometry){var u=d.geometry.coordinates,h=u[0];p=[u[1],h]}else d.lat&&(p=[d.lat,d.lng]);var f=Object.assign({},s);f.latlng=p,f.featureId=d._featureId,f.tableId=o,t.push(f)}}}return t},geojsonParcels:function(){var e=[],t=this.identifyFeature,i=this.activeParcelLayer;if("pwd-parcel"===t&&"pwd"===i&&this.pwdParcel){var a={};a.geojson=this.pwdParcel,a.color="blue",a.fillColor="blue",a.weight=2,a.opacity=1,a.fillOpacity=.3,a.key=a.geojson.properties.PARCELID,e.push(a)}else if("dor-parcel"===t&&"dor"===i){var o=this.dorParcels.map(function(e){var t={};return t.geojson=e,t.color="blue",t.fillColor="blue",t.weight=2,t.opacity=1,t.fillOpacity=.3,t.key=e.properties.OBJECTID,t});e.push.apply(e,o)}return e},geojsonForTopic:function(){var e=[],t=this.activeTopicConfig.geojsonForTopic;if(t){var i=this.$store.state,a=t.data(i);if(null!==a)for(var o=0,n=a;o<n.length;o+=1){var r=n[o],s=Object.assign({},t.style);s.key=r[t.key],s.geojson=r,e.push(s)}}return e},reactiveGeojsonFeatures:function(){for(var e=[],t=this.$store.state.horizontalTables.filteredData,i=0,a=this.$store.getters.visibleTableIds;i<a.length;i+=1){var o=a[i],n=((this.getConfigForTable(o)||{}).options||{}).mapOverlay;if(n&&"geojson"===n.marker){var r=t[o];if(!(r.length<1)){var s=n.style;r.push(o);for(var l=0,c=r;l<c.length;l+=1){var d=c[l],p=Object.assign({},s);p.geojson=d.geometry,p.key=d.id,p.featureId=d._featureId||null,p.tableId=r[r.length-1],e.push(p)}}}}return e},leafletMarkers:function(){var e=[];return e.push.apply(e,this.markers),e.push.apply(e,this.geojsonParcels),e}},methods:{getTableFromComps:function(e,t){return(e.filter(function(e){return"horizontal-table"===e.type&&e._id==t})||[])[0]},getConfigForTable:function(e){for(var t=0,i=this.$config.topics||[];t<i.length;t+=1){var a=i[t].components||[],o=this.getTableFromComps(a,e);if(o)return o;for(var n=0,r=a;n<r.length;n+=1){var s=r[n].options||{},l=s.components||s.tables||[];if(l.length>0){var c=this.getTableFromComps(l,e);if(c)return c}}}},bringMarkerToFront:function(e){var t=e._path,i=e._renderer._rootGroup;i.removeChild(t),i.appendChild(t)},handleMarkerMouseover:function(e){if(!this.isMobileOrTablet){var t=e.target.options.data,i=t.featureId,a=t.tableId;this.$store.commit("setActiveFeature",{featureId:i,tableId:a})}},handleMarkerClick:function(e){if(this.isMobileOrTablet){var t=e.target.options.data,i=t.featureId,a=t.tableId;this.$store.commit("setActiveFeature",{featureId:i,tableId:a})}},handleMarkerMouseout:function(e){e.target;this.$store.commit("setActiveFeature",null)},updateMarkerFillColor:function(e){var t=e.options.data,i=t.featureId,a=t.tableId,o=this.fillColorForCircleMarker(i,a),n=Object.assign({},e.options);n.fillColor=o,e.setStyle(n)}}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),i=" .mb-panel-map[data-v-11a08c18] { /*this allows the loading mask to fill the div*/ position: relative; } .mb-map-with-widget[data-v-11a08c18] { height: 50%; } .widget-slot[data-v-11a08c18] { display: inline-block; float: left; } .mb-map-loading-mask[data-v-11a08c18] { /*display: inline;*/ position: absolute; top: 0; height: 100%; width: 100%; background: rgba(0, 0 ,0 , 0.25); z-index: 1000; text-align: center; vertical-align: middle; } .mb-map-loading-mask-inner[data-v-11a08c18] { position: absolute; top: 40%; left: 40%; } /*small retina*/ /*@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi), (max-width: 39.9375em) { .mb-search-control-input { max-width: 250px; } }*/ ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i)),e.appendChild(t)}}();var cyclomediaMixin=philaVueMapping.CyclomediaMixin,pictometryMixin=philaVueMapping.PictometryMixin,Map_=philaVueMapping.Map_,Control=philaVueMapping.Control,AddressInput$1=philaVueMapping.AddressInput,AddressCandidateList$1=philaVueMapping.AddressCandidateList,EsriTiledMapLayer=philaVueMapping.EsriTiledMapLayer,EsriTiledOverlay=philaVueMapping.EsriTiledOverlay,EsriDynamicMapLayer=philaVueMapping.EsriDynamicMapLayer,EsriFeatureLayer=philaVueMapping.EsriFeatureLayer,Geojson=philaVueMapping.Geojson,CircleMarker=philaVueMapping.CircleMarker,VectorMarker=philaVueMapping.VectorMarker,PngMarker=philaVueMapping.PngMarker,BasemapToggleControl=philaVueMapping.BasemapToggleControl,BasemapSelectControl=philaVueMapping.BasemapSelectControl,FullScreenMapToggleTab=philaVueMapping.FullScreenMapToggleTab,LocationControl=philaVueMapping.LocationControl,CyclomediaButton=philaVueMapping.CyclomediaButton,PictometryButton=philaVueMapping.PictometryButton,CyclomediaRecordingCircle=philaVueMapping.CyclomediaRecordingCircle,CyclomediaRecordingsClient=philaVueMapping.CyclomediaRecordingsClient,SvgViewConeMarker=philaVueMapping.SvgViewConeMarker,MeasureControl=philaVueMapping.MeasureControl,LegendControl=philaVueMapping.LegendControl,BasemapTooltip=philaVueMapping.BasemapTooltip,ControlCorner=philaVueMapping.ControlCorner,MapPanel={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:this.mapPanelContainerClass,attrs:{id:"map-panel-container"}},[e._m(0),e._v(" "),i("map_",{class:{"mb-map-with-widget":this.$store.state.cyclomedia.active||this.$store.state.pictometry.active},attrs:{id:"map-tag",center:this.$store.state.map.center,zoom:this.$store.state.map.zoom,"zoom-control-position":"bottomright","min-zoom":this.$config.map.minZoom,"max-zoom":this.$config.map.maxZoom},on:{"l-click":e.handleMapClick,"l-moveend":e.handleMapMove}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isGeocoding,expression:"isGeocoding"}],staticClass:"mb-map-loading-mask"},[i("div",{staticClass:"mb-map-loading-mask-inner"},[i("i",{staticClass:"fa fa-spinner fa-4x spin"}),e._v(" "),i("h1",[e._v("Finding address...")])])]),e._v(" "),e._l(this.$config.map.basemaps,function(t,a){return e.activeBasemap===a?i("esri-tiled-map-layer",{key:a,attrs:{url:t.url,"max-zoom":t.maxZoom,attribution:t.attribution}}):e._e()}),e._v(" "),e._l(this.$config.map.tiledLayers,function(t,a){return e.tiledLayers.includes(a)?i("esri-tiled-map-layer",{key:a,attrs:{url:t.url,zIndex:t.zIndex,attribution:t.attribution}}):e._e()}),e._v(" "),e._l(this.$config.map.tiledOverlays,function(t,a){return e.activeTiledOverlays.includes(a)?i("esri-tiled-overlay",{key:a,attrs:{url:t.url,zIndex:t.zIndex,opacity:t.opacity}}):e._e()}),e._v(" "),e._l(this.$config.map.dynamicMapLayers,function(t,a){return e.activeDynamicMaps.includes(a)?i("esri-dynamic-map-layer",{key:a,attrs:{url:t.url,attribution:t.attribution,transparent:!0,opacity:t.opacity}}):e._e()}),e._v(" "),e._l(this.$config.map.featureLayers,function(t,a){return e.shouldShowFeatureLayer(a,t.minZoom)?i("esri-feature-layer",{key:a,attrs:{layerName:a,url:t.url,color:t.color,fillColor:t.color,fillOpacity:t.fillOpacity,weight:t.weight,style_:t.style,minZoom:t.minZoom,maxZoom:t.maxZoom,zIndex:t.zIndex,markerType:t.markerType,radius:t.radius,interactive:t.interactive}}):e._e()}),e._v(" "),e._l(this.imageOverlayItems,function(t,a){return e.shouldShowImageOverlay(t.properties.RECMAP)?i("esri-dynamic-map-layer",{key:a,attrs:{url:"//gis.phila.gov/arcgis/rest/services/Atlas/RegMaps/MapServer",layers:[0],layerDefs:"0:NAME='g"+t.properties.RECMAP.toLowerCase()+".tif'",transparent:!0,opacity:.5}}):e._e()}),e._v(" "),e._l(e.markersForAddress,function(e,t){return i("vector-marker",{key:e.key,attrs:{latlng:e.latlng,markerColor:e.color,icon:e.icon}})}),e._v(" "),e._l(e.markersForTopic,function(e,t){return i("vector-marker",{key:e.key,attrs:{latlng:e.latlng,markerColor:e.color,icon:e.icon}})}),e._v(" "),this.cyclomediaActive?i("png-marker",{attrs:{icon:"images/camera.png",latlng:e.cycloLatlng,rotationAngle:e.cycloRotationAngle}}):e._e(),e._v(" "),this.cyclomediaActive?i("svg-view-cone-marker",{attrs:{latlng:e.cycloLatlng,rotationAngle:e.cycloRotationAngle,hFov:e.cycloHFov}}):e._e(),e._v(" "),e._l(e.geojsonParcels,function(t){return e.shouldShowGeojson(t.key)?i("geojson",{key:t.key,attrs:{geojson:t.geojson,fillColor:t.fillColor,color:t.color,weight:t.weight,opacity:t.opacity,fillOpacity:t.fillOpacity,data:{featureId:t.featureId,tableId:t.tableId}}}):e._e()}),e._v(" "),e._l(e.geojsonForTopic,function(t){return e.shouldShowGeojson(t.key)?i("geojson",{key:t.key,attrs:{geojson:t.geojson,fillColor:t.fillColor,color:t.color,weight:t.weight,opacity:t.opacity,fillOpacity:t.fillOpacity,data:{featureId:t.featureId,tableId:t.tableId}}}):e._e()}),e._v(" "),e._l(e.reactiveGeojsonFeatures,function(t){return e.shouldShowGeojson(t.key)?i("geojson",{key:t.key,attrs:{geojson:t.geojson,fillColor:t.fillColor,color:t.color,weight:t.weight,opacity:t.opacity,fillOpacity:t.fillOpacity,data:{featureId:t.featureId,tableId:t.tableId}},on:{"l-mouseover":e.handleMarkerMouseover,"l-click":e.handleMarkerClick,"l-mouseout":e.handleMarkerMouseout}}):e._e()}),e._v(" "),null!=this.$store.state.map.location.lat?i("circle-marker",{key:Math.random(),attrs:{latlng:this.locationMarker.latlng,radius:this.locationMarker.radius,fillColor:this.locationMarker.fillColor,color:this.locationMarker.color,weight:this.locationMarker.weight,opacity:this.locationMarker.opacity,fillOpacity:this.locationMarker.fillOpacity}}):e._e(),e._v(" "),e._l(e.circleMarkers,function(t){return i("circle-marker",{key:Math.random(),attrs:{latlng:t.latlng,radius:t.radius,fillColor:t.fillColor,color:t.color,weight:t.weight,opacity:t.opacity,fillOpacity:t.fillOpacity,data:{featureId:t.featureId,tableId:t.tableId}},on:{"l-mouseover":e.handleMarkerMouseover,"l-click":e.handleMarkerClick,"l-mouseout":e.handleMarkerMouseout}})}),e._v(" "),i("control-corner",{attrs:{vSide:"top",hSide:"almostright"}}),e._v(" "),i("control-corner",{attrs:{vSide:"top",hSide:"almostleft"}}),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(5),e._v(" "),e._m(7),e._v(" "),this.measureControlEnabled?e._m(8):e._e(),e._v(" "),e._m(9),e._v(" "),e._m(11),e._v(" "),e._m(12),e._v(" "),this.addressAutocompleteEnabled?i("address-candidate-list",{attrs:{position:this.addressInputPosition,widthFromConfig:this.addressInputWidth}}):e._e(),e._v(" "),e._l(e.cyclomediaRecordings,function(t){return e.cyclomediaActive?i("cyclomedia-recording-circle",{key:t.imageId,attrs:{imageId:t.imageId,latlng:[t.lat,t.lng],size:1.2,color:"#3388ff",weight:1},on:{"l-click":e.handleCyclomediaRecordingClick}}):e._e()})],2),e._v(" "),e._t("cycloWidget"),e._v(" "),e._t("pictWidget")],2)},staticRenderFns:[function(){var e=this.$createElement;return(this._self._c||e)("full-screen-map-toggle-tab")},function(){var e=this.$createElement;return(this._self._c||e)("basemap-toggle-control",{attrs:{position:"topright"}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.shouldShowImageryToggle?this._m(1):this._e()],1)},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("basemap-select-control",{attrs:{position:this.basemapSelectControlPosition}})],1)},function(){var e=this.$createElement;return(this._self._c||e)("pictometry-button",{attrs:{position:"topright",link:"pictometry",imgSrc:"images/pictometry.png"}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.shouldShowPictometryButton?this._m(4):this._e()],1)},function(){var e=this.$createElement;return(this._self._c||e)("cyclomedia-button",{attrs:{position:"topright",link:"cyclomedia",imgSrc:"images/cyclomedia.png"},on:{click:this.handleCyclomediaButtonClick}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.shouldShowCyclomediaButton?this._m(6):this._e()],1)},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("measure-control",{attrs:{position:"bottomleft"}})],1)},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._l(Object.keys(e.legendControls),function(t){return i("legend-control",{key:t,attrs:{position:"bottomleft",options:e.legendControls[t].options,items:e.legendControls[t].data}})}))},function(){var e=this.$createElement;return(this._self._c||e)("location-control",{attrs:{position:"bottomright"}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.geolocationEnabled?this._m(10):this._e()],1)},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("address-input",{attrs:{position:this.addressInputPosition,placeholder:this.addressInputPlaceholder,widthFromConfig:this.addressInputWidth}})],1)}],_scopeId:"data-v-11a08c18",mixins:[markersMixin,cyclomediaMixin,pictometryMixin],components:{Map_:Map_,Control:Control,AddressInput:AddressInput$1,AddressCandidateList:AddressCandidateList$1,EsriTiledMapLayer:EsriTiledMapLayer,EsriTiledOverlay:EsriTiledOverlay,EsriDynamicMapLayer:EsriDynamicMapLayer,EsriFeatureLayer:EsriFeatureLayer,Geojson:Geojson,CircleMarker:CircleMarker,VectorMarker:VectorMarker,PngMarker:PngMarker,BasemapToggleControl:BasemapToggleControl,BasemapSelectControl:BasemapSelectControl,FullScreenMapToggleTab:FullScreenMapToggleTab,LocationControl:LocationControl,PictometryButton:PictometryButton,CyclomediaButton:CyclomediaButton,CyclomediaRecordingCircle:CyclomediaRecordingCircle,SvgViewConeMarker:SvgViewConeMarker,MeasureControl:MeasureControl,LegendControl:LegendControl,BasemapTooltip:BasemapTooltip,ControlCorner:ControlCorner},data:function(){return{zoomToShape:{geojsonParcels:[],geojsonForTopic:[],markersForAddress:[],markersForTopic:[]}}},created:function(){var e=this.$config.defaultAddress;e&&this.$controller.goToDefaultAddress(e),(this.$config.cyclomedia||{}).enabled&&(this.$cyclomediaRecordingsClient=new CyclomediaRecordingsClient(this.$config.cyclomedia.recordingsUrl,this.$config.cyclomedia.username,this.$config.cyclomedia.password,4326))},computed:{addressAutocompleteEnabled:function(){return!!this.$config.addressInput&&!0===this.$config.addressInput.autocompleteEnabled},addressInputPosition:function(){return this.isMobileOrTablet?"topleft":"topalmostleft"},addressInputWidth:function(){return this.$config.addressInput?this.$config.addressInput.mapWidth:415},addressInputPlaceholder:function(){return this.$config.addressInput?this.$config.addressInput.placeholder:null},basemapSelectControlPosition:function(){return this.isMobileOrTablet?"topright":"topalmostright"},shouldShowAddressCandidateList:function(){return this.$store.state.shouldShowAddressCandidateList},measureControlEnabled:function(){return!1!==this.$config.measureControlEnabled},fullScreenMapEnabled:function(){return this.$store.state.fullScreenMapEnabled},fullScreenTopicsEnabled:function(){return this.$store.state.fullScreenTopicsEnabled},mapPanelContainerClass:function(){return this.fullScreenMapEnabled?"medium-24 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map":this.fullScreenMapOnly?"medium-1 small-order-1 small-1 medium-order-2 mb-panel mb-panel-map":this.fullScreenTopicsEnabled?"medium-1 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map":"medium-12 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map"},cycloLatlng:function(){if(null!==this.$store.state.cyclomedia.orientation.xyz){var e=this.$store.state.cyclomedia.orientation.xyz;return[e[1],e[0]]}return this.$config.map.center},cycloRotationAngle:function(){return 57.29577951307855*this.$store.state.cyclomedia.orientation.yaw},cycloHFov:function(){return this.$store.state.cyclomedia.orientation.hFov},isMobileOrTablet:function(){return this.$store.state.isMobileOrTablet},shouldShowCyclomediaButton:function(){return this.$config.cyclomedia.enabled&&!this.isMobileOrTablet},shouldShowPictometryButton:function(){return this.$config.pictometry.enabled&&!this.isMobileOrTablet},geolocationEnabled:function(){return!!this.$config.geolocation&&this.$config.geolocation.enabled},activeDorParcel:function(){return this.$store.state.parcels.dor.activeParcel},legendControls:function(){return this.$config.legendControls||{}},imageOverlay:function(){return this.$store.state.map.imageOverlay},imageOverlayItems:function(){if(this.activeTopicConfig.imageOverlayGroup){var e=this.activeTopicConfig.imageOverlayGroup,t=this.$store.state;return this.$config.imageOverlayGroups[e].items(t)}return[]},imageOverlayInfo:function(){return this.$config.map.dynamicMapLayers.regmaps},activeBasemap:function(){if(this.$store.state.map.shouldShowImagery)return this.$store.state.map.imagery;var e=this.$config.map.defaultBasemap;return this.$store.state.map.basemap||e},tiledLayers:function(){var e=this.activeBasemap;return this.configForBasemap(e).tiledLayers||[]},activeTiledOverlays:function(){return this.activeTopicConfig&&this.activeTopicConfig.tiledOverlays?this.activeTopicConfig.tiledOverlays:[]},activeDynamicMaps:function(){return this.activeTopicConfig&&this.activeTopicConfig.dynamicMapLayers?this.activeTopicConfig.dynamicMapLayers:[]},activeFeatureLayers:function(){return this.activeTopicConfig&&this.activeTopicConfig.featureLayers?this.activeTopicConfig.featureLayers:[]},activeFeature:function(){return this.$store.state.activeFeature},basemaps:function(){return Object.values(this.$config.map.basemaps)},imageryBasemaps:function(){return this.basemaps.filter(function(e){return"imagery"===e.type})},hasImageryBasemaps:function(){return this.imageryBasemaps.length>0},shouldShowImageryToggle:function(){return this.$config.map.imagery?this.hasImageryBasemaps&&this.$config.map.imagery.enabled:this.hasImageryBasemaps},identifyFeature:function(){var e;return"intersection"===this.geocodeType?e="address-marker":this.activeTopicConfig.identifyFeature?e=this.activeTopicConfig.identifyFeature:this.$config&&(e=this.$config.map.defaultIdentifyFeature),e},activeTopic:function(){return this.$store.state.activeTopic},activeTopicConfig:function(){var e,t=this.activeTopic;return t&&(e=this.$config.topics.filter(function(e){return e.key===t})[0]),e||{}},activeParcelLayer:function(){return this.activeTopicConfig.parcels},dorParcels:function(){return this.$store.state.parcels.dor.data},pwdParcel:function(){return this.$store.state.parcels.pwd},geocodeResult:function(){return this.$store.state.geocode.data||{}},geocodeGeom:function(){return this.geocodeResult.geometry},geocodeType:function(){return this.geocodeResult.ais_feature_type},streetAddress:function(){return this.geocodeResult.properties.street_address},picOrCycloActive:function(){return!(!this.cyclomediaActive&&!this.pictometryActive)},mapBounds:function(){},boundsBasedOnShape:function(){return this.$store.state.map.boundsBasedOnShape},isGeocoding:function(){return"waiting"===this.$store.state.geocode.status}},watch:{picOrCycloActive:function(e){var t=this;this.$nextTick(function(){t.$store.state.map.map.invalidateSize()})},geojsonForTopic:function(e){var t=this.activeTopicConfig.zoomToShape,i=this.$data.zoomToShape;t&&t.includes("geojsonForTopic")?(i.geojsonForTopic=e,this.checkBoundsChanges()):i.geojsonForTopic=[]},geojsonParcels:function(e){var t=this.activeTopicConfig.zoomToShape,i=this.$data.zoomToShape;t&&t.includes("geojsonParcels")?(i.geojsonParcels=e,this.checkBoundsChanges()):i.geojsonParcels=[]},markersForAddress:function(e){var t=this.activeTopicConfig.zoomToShape,i=this.$data.zoomToShape;t&&t.includes("markersForAddress")?(i.markersForAddress=e,this.checkBoundsChanges()):i.markersForAddress=[]},markersForTopic:function(e){var t=this.activeTopicConfig.zoomToShape,i=this.$data.zoomToShape;t&&t.includes("markersForTopic")?(i.markersForTopic=e,this.checkBoundsChanges()):i.markersForTopic=[]},fullScreenTopicsEnabled:function(){var e=this;this.$nextTick(function(){e.$store.state.map.map.invalidateSize()})}},methods:{checkBoundsChanges:function(){var e=this.activeTopicConfig.zoomToShape;if(e){for(var t=this.$data.zoomToShape,i=[],a=0,o=e;a<o.length;a+=1){var n=o[a];!1!==t[n]&&t[n].length>0?i.push(!0):i.push(!1)}i.includes(!1)||this.setMapToBounds()}},setMapToBounds:function(){var e=[],t=this.activeTopicConfig.zoomToShape;if(t){if(t.includes("geojsonParcels"))for(var i=0,a=this.geojsonParcels;i<a.length;i+=1){var o=a[i];e.push(geoJSON(o.geojson))}if(t.includes("geojsonForTopic"))for(var n=0,r=this.geojsonForTopic;n<r.length;n+=1){var s=r[n];e.push(geoJSON(s.geojson))}if(t.includes("markersForAddress"))for(var l=0,c=this.markersForAddress;l<c.length;l+=1){var d=c[l];e.push(d(d.latlng))}if(t.includes("markersForTopic"))for(var p=0,u=this.markersForTopic;p<u.length;p+=1){var h=u[p];e.push(h(h.latlng))}var f=new leaflet.featureGroup(e).getBounds();this.$store.commit("setMapBounds",f)}},configForBasemap:function(e){return this.$config.map.basemaps[e]||{}},shouldShowGeojson:function(e){return"pwd"===this.activeTopicConfig.basemap||e===this.activeDorParcel},shouldShowImageOverlay:function(e){return e===this.imageOverlay},shouldShowFeatureLayer:function(e){return!!this.activeFeatureLayers.includes(e)},handleMapClick:function(e){this.$controller.handleMapClick(e)},handleMapMove:function(e){var t=this.$store.state.map.map,i=this.$config.pictometry||{},a=t.getCenter(),o=a.lat,n=a.lng,r=[n,o];if(i.enabled){this.$store.commit("setPictometryMapCenter",r);var s=t.getZoom();this.$store.commit("setPictometryMapZoom",s)}(this.$config.cyclomedia||{}).enabled&&(this.updateCyclomediaRecordings(),this.$store.commit("setCyclomediaLatLngFromMap",[o,n]))},fillColorForCircleMarker:function(e,t){var i=this.getConfigForTable(t).options.mapOverlay,a=i.style,o=i.hoverStyle,n=this.activeFeature;return(e===n.featureId&&t===n.tableId?o:a).fillColor}}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),i=" /*don't highlight any form elements*/ input:focus, select:focus, textarea:focus, button:focus { outline: none; } .mb-panel-topics-with-widget { height: 50%; } /* standards applies padding to buttons, which causes some weirdness with buttons on the map panel. override here. */ button { padding: inherit; } .topic-panel-false { /* display: none; */ } @media screen and (min-width: 46.875em) { .topic-panel-false { display: none; } .map-panel-false { display: none; } } ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i)),e.appendChild(t)}}();var CyclomediaWidget=philaVueMapping.CyclomediaWidget,PictometryWidget=philaVueMapping.PictometryWidget,Layer=philaVueMapping.PictometryLayer,ViewCone=philaVueMapping.PictometryViewCone,PngMarker$1=philaVueMapping.PictometryPngMarker,Popover=philaVueComps.Popover,Mapboard={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.rootClass,style:e.mbRootStyle,attrs:{id:"mb-root"}},[e.shouldShowHeader?i("header-comp"):e._e(),e._v(" "),i("topic-panel",{class:this.shouldShowTopicPanel}),e._v(" "),!0!==this.fullScreenTopicsOnly?i("map-panel",{class:this.shouldShowMapPanel},[this.shouldLoadCyclomediaWidget?i("cyclomedia-widget",{directives:[{name:"show",rawName:"v-show",value:e.cyclomediaActive,expression:"cyclomediaActive"}],attrs:{slot:"cycloWidget","screen-percent":"2"},slot:"cycloWidget"}):e._e(),e._v(" "),this.shouldLoadPictometryWidget?i("pictometry-widget",{directives:[{name:"show",rawName:"v-show",value:e.pictometryActive,expression:"pictometryActive"}],attrs:{slot:"pictWidget",apiKey:this.ak,secretKey:this.sk},slot:"pictWidget"},[this.pictometryShowAddressMarker?i("png-marker",{attrs:{latlng:[this.geocodeData.geometry.coordinates[1],this.geocodeData.geometry.coordinates[0]],icon:"images/markers.png",height:60,width:40,offsetX:0,offsetY:0}}):e._e(),e._v(" "),this.pictometryActive?i("layer"):e._e(),e._v(" "),this.cyclomediaActive&&this.pictometryActive?i("png-marker",{attrs:{latlng:e.cycloLatlng,icon:"images/camera2.png",height:20,width:30,offsetX:-2,offsetY:-2}}):e._e(),e._v(" "),this.cyclomediaActive&&this.pictometryActive?i("view-cone",{attrs:{latlng:e.cycloLatlng,rotationAngle:e.cycloRotationAngle,hFov:e.cycloHFov}}):e._e()],1):e._e()],1):e._e(),e._v(" "),e.popoverOpen?i("popover",{attrs:{options:this.popoverOptions,slots:{text:this.popoverText}}}):e._e()],1)},staticRenderFns:[],components:{HeaderComp:HeaderComp,TopicPanel:TopicPanel,MapPanel:MapPanel,CyclomediaWidget:CyclomediaWidget,PictometryWidget:PictometryWidget,Layer:Layer,PngMarker:PngMarker$1,ViewCone:ViewCone,Popover:Popover},data:function(){return{mbRootStyle:{height:"100px"}}},created:function(){console.log("this.$config:",this.$config),this.$config.panels&&(this.$config.panels.includes("map")?this.$config.panels.includes("topics")||this.$store.commit("setMapOnly",!0):this.$store.commit("setTopicsOnly",!0)),window.addEventListener("click",this.closeAddressCandidateList),window.addEventListener("resize",this.handleWindowResize),this.handleWindowResize()},mounted:function(){this.$controller.appDidLoad(),this.$config.initialPopover&&""==window.location.hash&&(this.$store.commit("setPopoverOpen",!0),this.$store.commit("setPopoverOptions",this.$config.initialPopover.options),this.$config.initialPopover.slots&&this.$store.commit("setPopoverText",this.$config.initialPopover.slots.text))},computed:{shouldShowHeader:function(){return!!this.$config.header&&this.$config.header.enabled},rootClass:function(){return this.$config.plugin?"grid-x":"cell medium-auto grid-x"},isMobileOrTablet:function(){return this.$store.state.isMobileOrTablet},shouldLoadCyclomediaWidget:function(){return this.$config.cyclomedia.enabled&&!this.isMobileOrTablet},shouldLoadPictometryWidget:function(){return this.$config.pictometry.enabled&&!this.isMobileOrTablet},fullScreenMapOnly:function(){return this.$store.state.fullScreen.mapOnly},fullScreenMapEnabled:function(){return this.$store.state.fullScreenMapEnabled},fullScreenTopicsOnly:function(){return this.$store.state.fullScreen.topicsOnly},fullScreenTopicsEnabled:function(){return this.$store.state.fullScreenTopicsEnabled},shouldShowTopicPanel:function(){return this.fullScreenMapEnabled||this.fullScreenMapOnly?"topic-panel-false":"topic-panel-true"},shouldShowMapPanel:function(){return this.fullScreenTopicsEnabled||this.fullScreenTopicsOnly?"map-panel-false":"map-panel-true"},cyclomediaActive:function(){return this.$store.state.cyclomedia.active},cycloLatlng:function(){if(null!==this.$store.state.cyclomedia.orientation.xyz){var e=this.$store.state.cyclomedia.orientation.xyz;return[e[1],e[0]]}return this.$config.map.center},cycloRotationAngle:function(){return 57.29577951307855*this.$store.state.cyclomedia.orientation.yaw},cycloHFov:function(){return this.$store.state.cyclomedia.orientation.hFov},pictometryActive:function(){return this.$store.state.pictometry.active},pictometryZoom:function(){return this.$store.state.pictometry.zoom},pictometryShowAddressMarker:function(){return!(!this.pictometryActive||!this.geocodeData)&&!(this.pictometryZoom<20&&this.cyclomediaActive)},geocodeData:function(){return this.$store.state.geocode.data},ak:function(){var e=window.location.hostname;return"atlas.phila.gov"===e?this.$config.pictometry.apiKey:"atlas-dev.phila.gov"===e?this.$config.pictometryDev.apiKey:"cityatlas.phila.gov"===e?this.$config.pictometryCity.apiKey:"cityatlas-dev.phila.gov"===e?this.$config.pictometryCityDev.apiKey:"10.8.101.67"===e?this.$config.pictometryLocal.apiKey:void 0},sk:function(){var e=window.location.hostname;return"atlas.phila.gov"===e?this.$config.pictometry.secretKey:"atlas-dev.phila.gov"===e?this.$config.pictometryDev.secretKey:"cityatlas.phila.gov"===e?this.$config.pictometryCity.secretKey:"cityatlas-dev.phila.gov"===e?this.$config.pictometryCityDev.secretKey:"10.8.101.67"===e?this.$config.pictometryLocal.secretKey:void 0},popoverOpen:function(){return this.$store.state.popover.open},popoverText:function(){return this.$store.state.popover.text},popoverOptions:function(){return this.$store.state.popover.options}},watch:{pictometryShowAddressMarker:function(e){console.log("watch pictometryShowAddressMarker",e)}},methods:{closeAddressCandidateList:function(){this.$store.commit("setShouldShowAddressCandidateList",!1)},handleWindowResize:function(){window.innerWidth>=750?this.mbRootStyle.height="600px":this.mbRootStyle.height="auto"}}};function generateUniqueId(){return Math.random().toString(36).substring(7)}function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var faSpinner=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=[],a="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z";t.definition={prefix:"fas",iconName:"spinner",icon:[512,512,i,"f110",a]},t.faSpinner=t.definition,t.prefix="fas",t.iconName="spinner",t.width=512,t.height=512,t.ligatures=i,t.unicode="f110",t.svgPathData=a});unwrapExports(faSpinner);var faSpinner_1=faSpinner.definition,faSpinner_2=faSpinner.faSpinner,faSpinner_3=faSpinner.prefix,faSpinner_4=faSpinner.iconName,faSpinner_5=faSpinner.width,faSpinner_6=faSpinner.height,faSpinner_7=faSpinner.ligatures,faSpinner_8=faSpinner.unicode,faSpinner_9=faSpinner.svgPathData,faBook=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=[],a="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z";t.definition={prefix:"fas",iconName:"book",icon:[448,512,i,"f02d",a]},t.faBook=t.definition,t.prefix="fas",t.iconName="book",t.width=448,t.height=512,t.ligatures=i,t.unicode="f02d",t.svgPathData=a});unwrapExports(faBook);var faBook_1=faBook.definition,faBook_2=faBook.faBook,faBook_3=faBook.prefix,faBook_4=faBook.iconName,faBook_5=faBook.width,faBook_6=faBook.height,faBook_7=faBook.ligatures,faBook_8=faBook.unicode,faBook_9=faBook.svgPathData,faWrench=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=[],a="M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z";t.definition={prefix:"fas",iconName:"wrench",icon:[512,512,i,"f0ad",a]},t.faWrench=t.definition,t.prefix="fas",t.iconName="wrench",t.width=512,t.height=512,t.ligatures=i,t.unicode="f0ad",t.svgPathData=a});unwrapExports(faWrench);var faWrench_1=faWrench.definition,faWrench_2=faWrench.faWrench,faWrench_3=faWrench.prefix,faWrench_4=faWrench.iconName,faWrench_5=faWrench.width,faWrench_6=faWrench.height,faWrench_7=faWrench.ligatures,faWrench_8=faWrench.unicode,faWrench_9=faWrench.svgPathData,faUniversity=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=[],a="M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z";t.definition={prefix:"fas",iconName:"university",icon:[512,512,i,"f19c",a]},t.faUniversity=t.definition,t.prefix="fas",t.iconName="university",t.width=512,t.height=512,t.ligatures=i,t.unicode="f19c",t.svgPathData=a});unwrapExports(faUniversity);var faUniversity_1=faUniversity.definition,faUniversity_2=faUniversity.faUniversity,faUniversity_3=faUniversity.prefix,faUniversity_4=faUniversity.iconName,faUniversity_5=faUniversity.width,faUniversity_6=faUniversity.height,faUniversity_7=faUniversity.ligatures,faUniversity_8=faUniversity.unicode,faUniversity_9=faUniversity.svgPathData,faGavel=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=[],a="M504.971 199.362l-22.627-22.627c-9.373-9.373-24.569-9.373-33.941 0l-5.657 5.657L329.608 69.255l5.657-5.657c9.373-9.373 9.373-24.569 0-33.941L312.638 7.029c-9.373-9.373-24.569-9.373-33.941 0L154.246 131.48c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l5.657-5.657 39.598 39.598-81.04 81.04-5.657-5.657c-12.497-12.497-32.758-12.497-45.255 0L9.373 412.118c-12.497 12.497-12.497 32.758 0 45.255l45.255 45.255c12.497 12.497 32.758 12.497 45.255 0l114.745-114.745c12.497-12.497 12.497-32.758 0-45.255l-5.657-5.657 81.04-81.04 39.598 39.598-5.657 5.657c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l124.451-124.451c9.372-9.372 9.372-24.568 0-33.941z";t.definition={prefix:"fas",iconName:"gavel",icon:[512,512,i,"f0e3",a]},t.faGavel=t.definition,t.prefix="fas",t.iconName="gavel",t.width=512,t.height=512,t.ligatures=i,t.unicode="f0e3",t.svgPathData=a});unwrapExports(faGavel);var faGavel_1=faGavel.definition,faGavel_2=faGavel.faGavel,faGavel_3=faGavel.prefix,faGavel_4=faGavel.iconName,faGavel_5=faGavel.width,faGavel_6=faGavel.height,faGavel_7=faGavel.ligatures,faGavel_8=faGavel.unicode,faGavel_9=faGavel.svgPathData;fontawesomeSvgCore.library.add(faSpinner_2,faBook_2,faWrench_2,faUniversity_2,faGavel_2);var controllerMixin=philaVueDatafetch.controllerMixin;function assignTableIds(e){for(var t=0,i=e;t<i.length;t+=1){var a=i[t],o=a.options||{},n=o.components||o.tables;if(n&&assignTableIds(n),"horizontal-table"===a.type){var r=generateUniqueId();a._id=r,a.options.tableId=r}}}function assignHorizontalTableGroupIds(e){for(var t=0,i=e;t<i.length;t+=1){var a=i[t];if((a.options||{}).tables&&"horizontal-table-group"===a.type){var o=generateUniqueId();a._id=o,a.options.horizontalTableGroupId=o}}}function initMapboard(clientConfig){var baseConfigUrl=clientConfig.baseConfig;return axios.get(baseConfigUrl).then(function(response){for(var data=response.data,baseConfigFn=eval(data),gatekeeperKey=clientConfig.gatekeeperKey,baseConfig=baseConfigFn({gatekeeperKey:gatekeeperKey}),config=mergeDeep(baseConfig,clientConfig),i=0,list=config.topics;i<list.length;i+=1){var topic=list[i];assignTableIds(topic.components),assignHorizontalTableGroupIds(topic.components)}Vue.use(configMixin,config);var store=createStore(config);Vue.use(controllerMixin,{config:config,store:store}),Vue.component("font-awesome-icon",vueFontawesome.FontAwesomeIcon);for(var customComps=clientConfig.customComps||[],i$1=0,list$1=Object.keys(customComps);i$1<list$1.length;i$1+=1){var key=list$1[i$1];Vue.component(key,customComps[key])}var vm=new Vue({el:config.el||"#mapboard",render:function(e){return e(Mapboard)},store:store})}).catch(function(e){console.error("Error loading base config:",e)})}exports.default=initMapboard,exports.Mapboard=Mapboard,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=mapboard.js.map
