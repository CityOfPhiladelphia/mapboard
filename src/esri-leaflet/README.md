This should probably become its own library at some point.
